<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 7: Bayesian Hierarchical Modelling • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 7: Bayesian Hierarchical Modelling">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.41</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2count.html">Practical 2: Count data</a>
    </li>
    <li>
      <a href="../articles/p2normal.html">Practical 2: Normal data</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Bayesian linear regression</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Simualtion-based Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Software and GLMs</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Bayesian Hierarchical Modelling</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 7: Bayesian Hierarchical
Modelling</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/HEAD/vignettes/p7.Rmd" class="external-link"><code>vignettes/p7.Rmd</code></a></small>
      <div class="hidden name"><code>p7.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="bayesian-hierarchical-modelling">Bayesian Hierarchical Modelling<a class="anchor" aria-label="anchor" href="#bayesian-hierarchical-modelling"></a>
</h2>
<p>In this last practical we will consider the analysis of Bayesian
hierarchical models. As explained in the previous lecture, hierarchical
models provide a convenient tool to define models so that the different
sources of variation in the data are clearly identified. Bayesian
inference for highly structured hierarchical models can be difficult and
may require the use of Markov chain Monte Carlo methods. However,
packages such as <code>BayesX</code> and <code>INLA</code>, to mention
just two, provide a very convenient way to fit and make inference about
complex Bayesian hierarchical models.</p>
<p>Regarding software, we will use <code>MCMCpack</code> to fit the
models in the fairly straightforward examples in this Practical - more
complex models would require another package.</p>
</div>
<div class="section level2">
<h2 id="linear-mixed-models">Linear Mixed Models<a class="anchor" aria-label="anchor" href="#linear-mixed-models"></a>
</h2>
<p>Linear mixed models were defined in the lecture as follows:</p>
<p><span class="math display">\[
Y_{ij} = X_{ij}\beta +\phi_i+\epsilon_{ij}
\]</span></p>
<p>Here, Y_{ij} represents observation <span class="math inline">\(j\)</span> in group <span class="math inline">\(i\)</span>, X_{ij} are a vector of covariates with
coefficients <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\phi_i\)</span> i.i.d. random effects and <span class="math inline">\(\epsilon_{ij}\)</span> a Gaussian error term. The
distribution of the random effects <span class="math inline">\(\phi_i\)</span> is Gaussian with zero mean and
precision <span class="math inline">\(\tau_{\phi}\)</span>.</p>
</div>
<div class="section level2">
<h2 id="multilevel-modelling">Multilevel Modelling<a class="anchor" aria-label="anchor" href="#multilevel-modelling"></a>
</h2>
<p>Multilevel models are a particular type of mixed-effects models in
which observations are nested within groups, so that group effects are
modelled using random effects. A typical example is that of students
nested within classes.</p>
<p>For the next example, the <code>nlschools</code> data set (in package
<code>MASS</code>) will be used. This data set records data about
students’ performance (in particular, about a language score test) and
other variables. The variables in this data set are:</p>
<ul>
<li><p><code>lang</code>, language score test.</p></li>
<li><p><code>IQ</code>, verbal IQ.</p></li>
<li><p><code>class</code>, class ID.</p></li>
<li><p><code>GS</code>, class size as number of eighth-grade pupils
recorded in the class.</p></li>
<li><p><code>SES</code>, social-economic status of pupil’s
family.</p></li>
<li><p><code>COMB</code>, whether the pupils are taught in the
multi-grade class with 7th-grade students.</p></li>
</ul>
<p>The data set can be loaded and summarised as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">"MASS"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nlschools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nlschools</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       lang             IQ            class            GS             SES       </span></span>
<span><span class="co">##  Min.   : 9.00   Min.   : 4.00   15580  :  33   Min.   :10.00   Min.   :10.00  </span></span>
<span><span class="co">##  1st Qu.:35.00   1st Qu.:10.50   5480   :  31   1st Qu.:23.00   1st Qu.:20.00  </span></span>
<span><span class="co">##  Median :42.00   Median :12.00   15980  :  31   Median :27.00   Median :27.00  </span></span>
<span><span class="co">##  Mean   :40.93   Mean   :11.83   16180  :  31   Mean   :26.51   Mean   :27.81  </span></span>
<span><span class="co">##  3rd Qu.:48.00   3rd Qu.:13.00   18380  :  31   3rd Qu.:31.00   3rd Qu.:35.00  </span></span>
<span><span class="co">##  Max.   :58.00   Max.   :18.00   5580   :  30   Max.   :39.00   Max.   :50.00  </span></span>
<span><span class="co">##                                  (Other):2100                                  </span></span>
<span><span class="co">##  COMB    </span></span>
<span><span class="co">##  0:1658  </span></span>
<span><span class="co">##  1: 629  </span></span>
<span><span class="co">##          </span></span>
<span><span class="co">##          </span></span>
<span><span class="co">##          </span></span>
<span><span class="co">##          </span></span>
<span><span class="co">## </span></span></code></pre>
<p>The model to fit will take <code>lang</code> as the response variable
and include <code>IQ</code>, <code>GS</code>, <code>SES</code> and
<code>COMB</code> as covariates (i.e., fixed effects). This model can
easily be fitted with <code>MCMCregress</code> as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=MCMCpack" class="external-link">MCMCpack</a></span><span class="op">)</span></span>
<span><span class="va">burnin</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">thin</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">results1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MCMCpack/man/MCMCregress.html" class="external-link">MCMCregress</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lang</span> <span class="op">~</span> <span class="va">IQ</span> <span class="op">+</span> <span class="va">GS</span> <span class="op">+</span>  <span class="va">SES</span> <span class="op">+</span> <span class="va">COMB</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">nlschools</span>,</span>
<span>                  b0 <span class="op">=</span> <span class="fl">0</span>, B0 <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>                  c0 <span class="op">=</span> <span class="fl">2</span>, d0 <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Because the prior is Ga(c0/2,d0/2),</span></span>
<span>                  beta.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                  burnin<span class="op">=</span><span class="va">burnin</span>, mcmc<span class="op">=</span><span class="va">mcmc</span>, thin<span class="op">=</span><span class="va">thin</span>,</span>
<span>                  verbose<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 1 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   16.16971</span></span>
<span><span class="co">##    2.22972</span></span>
<span><span class="co">##   -0.13210</span></span>
<span><span class="co">##    0.10011</span></span>
<span><span class="co">##   -3.28104</span></span>
<span><span class="co">## sigma2 =  886.47780</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 1001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   11.07227</span></span>
<span><span class="co">##    2.36622</span></span>
<span><span class="co">##   -0.08722</span></span>
<span><span class="co">##    0.15817</span></span>
<span><span class="co">##   -1.47064</span></span>
<span><span class="co">## sigma2 =   47.13429</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 2001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.52524</span></span>
<span><span class="co">##    2.25786</span></span>
<span><span class="co">##   -0.00739</span></span>
<span><span class="co">##    0.15112</span></span>
<span><span class="co">##   -1.16673</span></span>
<span><span class="co">## sigma2 =   48.31374</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 3001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.31840</span></span>
<span><span class="co">##    2.28847</span></span>
<span><span class="co">##   -0.00911</span></span>
<span><span class="co">##    0.15604</span></span>
<span><span class="co">##   -2.05871</span></span>
<span><span class="co">## sigma2 =   48.39536</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 4001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.22941</span></span>
<span><span class="co">##    2.37521</span></span>
<span><span class="co">##   -0.02546</span></span>
<span><span class="co">##    0.13788</span></span>
<span><span class="co">##   -1.69311</span></span>
<span><span class="co">## sigma2 =   47.43155</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 5001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.68460</span></span>
<span><span class="co">##    2.27856</span></span>
<span><span class="co">##   -0.01618</span></span>
<span><span class="co">##    0.14583</span></span>
<span><span class="co">##   -1.75789</span></span>
<span><span class="co">## sigma2 =   51.65813</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 6001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.34614</span></span>
<span><span class="co">##    2.23303</span></span>
<span><span class="co">##    0.00124</span></span>
<span><span class="co">##    0.16299</span></span>
<span><span class="co">##   -1.53460</span></span>
<span><span class="co">## sigma2 =   48.84984</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 7001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##    9.71714</span></span>
<span><span class="co">##    2.45581</span></span>
<span><span class="co">##   -0.04217</span></span>
<span><span class="co">##    0.13578</span></span>
<span><span class="co">##   -1.95747</span></span>
<span><span class="co">## sigma2 =   51.45507</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 8001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##    9.61393</span></span>
<span><span class="co">##    2.37373</span></span>
<span><span class="co">##   -0.02604</span></span>
<span><span class="co">##    0.15020</span></span>
<span><span class="co">##   -0.79038</span></span>
<span><span class="co">## sigma2 =   46.34755</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 9001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   11.59194</span></span>
<span><span class="co">##    2.32174</span></span>
<span><span class="co">##   -0.02483</span></span>
<span><span class="co">##    0.11374</span></span>
<span><span class="co">##   -2.12268</span></span>
<span><span class="co">## sigma2 =   50.96837</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 10001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.00148</span></span>
<span><span class="co">##    2.34247</span></span>
<span><span class="co">##   -0.04999</span></span>
<span><span class="co">##    0.17451</span></span>
<span><span class="co">##   -1.58246</span></span>
<span><span class="co">## sigma2 =   46.42116</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 11001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   11.80878</span></span>
<span><span class="co">##    2.31569</span></span>
<span><span class="co">##   -0.04237</span></span>
<span><span class="co">##    0.12918</span></span>
<span><span class="co">##   -2.38835</span></span>
<span><span class="co">## sigma2 =   50.12833</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 12001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##    9.37705</span></span>
<span><span class="co">##    2.38012</span></span>
<span><span class="co">##   -0.02303</span></span>
<span><span class="co">##    0.14872</span></span>
<span><span class="co">##   -1.30285</span></span>
<span><span class="co">## sigma2 =   50.69632</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 13001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.28174</span></span>
<span><span class="co">##    2.44147</span></span>
<span><span class="co">##   -0.07010</span></span>
<span><span class="co">##    0.14345</span></span>
<span><span class="co">##   -1.45603</span></span>
<span><span class="co">## sigma2 =   50.19558</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MCMCregress iteration 14001 of 15000 </span></span>
<span><span class="co">## beta = </span></span>
<span><span class="co">##   10.66197</span></span>
<span><span class="co">##    2.36462</span></span>
<span><span class="co">##   -0.04510</span></span>
<span><span class="co">##    0.13671</span></span>
<span><span class="co">##   -1.88651</span></span>
<span><span class="co">## sigma2 =   48.58278</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Iterations = 5001:14991</span></span>
<span><span class="co">## Thinning interval = 10 </span></span>
<span><span class="co">## Number of chains = 1 </span></span>
<span><span class="co">## Sample size per chain = 1000 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 1. Empirical mean and standard deviation for each variable,</span></span>
<span><span class="co">##    plus standard error of the mean:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 Mean      SD  Naive SE Time-series SE</span></span>
<span><span class="co">## (Intercept)  9.72389 1.07076 0.0338603      0.0338603</span></span>
<span><span class="co">## IQ           2.39216 0.07683 0.0024297      0.0025715</span></span>
<span><span class="co">## GS          -0.02716 0.02503 0.0007914      0.0007303</span></span>
<span><span class="co">## SES          0.14732 0.01391 0.0004397      0.0004397</span></span>
<span><span class="co">## COMB1       -1.69442 0.32601 0.0103093      0.0103093</span></span>
<span><span class="co">## sigma2      48.02678 1.42674 0.0451174      0.0451174</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 2. Quantiles for each variable:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 2.5%     25%      50%      75%    97.5%</span></span>
<span><span class="co">## (Intercept)  7.64824  8.9756  9.68814 10.45722 11.91588</span></span>
<span><span class="co">## IQ           2.23839  2.3414  2.39194  2.44619  2.54676</span></span>
<span><span class="co">## GS          -0.07516 -0.0442 -0.02706 -0.01012  0.02201</span></span>
<span><span class="co">## SES          0.12028  0.1384  0.14693  0.15740  0.17392</span></span>
<span><span class="co">## COMB1       -2.37359 -1.9151 -1.68549 -1.46950 -1.07264</span></span>
<span><span class="co">## sigma2      45.27307 47.0689 48.02864 48.95891 51.02795</span></span></code></pre>
<p>Note that the previous model only includes fixed effects. The data
set includes <code>class</code> as the class ID to which each student
belongs. Class effects can have an impact on the performance of the
students, with students in the same class performing similarly in the
language test.</p>
<p>Very conveniently, the function <code>MCMChregress</code> in
<code>MCMCpack" can include random effects in the model. The argument</code>group<code>takes the name of the grouping variable (in quotes). The fixed effects are written as a  standard model formula using the argument</code>fixed<code>, while the argument</code>random`
(as you might expect!) contains the random effects model formula, this
time using a one-sided formula (as the response variable was already
declared in the fixed model formula). This is best illustrated via
example, as below.</p>
<p>Before fitting the model, the between-class variability can be
explored by means of boxplots:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">lang</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">nlschools</span>, las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-3-1.png" width="1440"></p>
<p>The we wish to use has a random effect indexed over grouping variable
<code>class</code> and random effects which are independent and
identically distributed using a normal distribution with zero mean and
precision <span class="math inline">\(\tau_\phi\)</span>. The function
<code><a href="https://rdrr.io/pkg/MCMCpack/man/MCMChregress.html" class="external-link">MCMChregress()</a></code> places a Wishart prior on <span class="math inline">\(\tau_\phi\)</span>, but studying this is beyond
the scope of this course. For our purposes, we would like a vague prior
for this quantity (similar to the Uniform prior placed on <span class="math inline">\(\sigma_\phi\)</span> in the lectures), and this
equates to placing an Inverse Wishart prior on <span class="math inline">\(\sigma^2_\phi\)</span>. We use a IW(1,1) prior
here, to give the most uninformative prior (via arguments <span class="math inline">\(r\)</span> and <span class="math inline">\(R\)</span> to <code><a href="https://rdrr.io/pkg/MCMCpack/man/MCMChregress.html" class="external-link">MCMChregress()</a></code>).</p>
<p>The normal priors for the fixed effect regression parameters have
means set by <code>mubeta</code> and variances by <code>Vbeta</code>; we
use fixed values of 0 for each mean and 0.000001 for each variance.</p>
<p>Note that in <code><a href="https://rdrr.io/pkg/MCMCpack/man/MCMChregress.html" class="external-link">MCMChregress()</a></code>, the argument
<code>verbose</code> only takes the values <code>0</code> and
<code>1</code>, representing a switch where a progress bar is shown if
the value <code>1</code> is chosen.</p>
<p>The code to fit the model with a single random effect allowing for a
different mean level per group is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MCMCpack/man/MCMChregress.html" class="external-link">MCMChregress</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">lang</span> <span class="op">~</span> <span class="va">IQ</span> <span class="op">+</span> <span class="va">GS</span> <span class="op">+</span>  <span class="va">SES</span> <span class="op">+</span> <span class="va">COMB</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"class"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">nlschools</span>,</span>
<span>  <span class="co">#burnin=1000, mcmc=10000, thin=1, verbose=1,</span></span>
<span>  burnin<span class="op">=</span><span class="fl">100</span>, mcmc<span class="op">=</span><span class="fl">1000</span>, thin<span class="op">=</span><span class="fl">1</span>, verbose<span class="op">=</span><span class="fl">1</span>,</span>
<span>  <span class="co">#beta.start=0, sigma2.start=1, # Starting values for </span></span>
<span>  mubeta<span class="op">=</span><span class="fl">0</span>, Vbeta<span class="op">=</span><span class="fl">1.0E6</span>, <span class="co"># Mean and variance of prior distributions for each random effect</span></span>
<span>  r<span class="op">=</span><span class="fl">1</span>, R<span class="op">=</span><span class="fl">1</span> <span class="co"># To give an uninformative prior on sigma_phi</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Running the Gibbs sampler. It may be long, keep cool :)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## **********:10.0%</span></span>
<span><span class="co">## **********:20.0%</span></span>
<span><span class="co">## **********:30.0%</span></span>
<span><span class="co">## **********:40.0%</span></span>
<span><span class="co">## **********:50.0%</span></span>
<span><span class="co">## **********:60.0%</span></span>
<span><span class="co">## **********:70.0%</span></span>
<span><span class="co">## **********:80.0%</span></span>
<span><span class="co">## **********:90.0%</span></span>
<span><span class="co">## **********:100.0%</span></span></code></pre>
<p>If we look at</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Length Class  Mode   </span></span>
<span><span class="co">## mcmc   141000 mcmc   numeric</span></span>
<span><span class="co">## Y.pred   2287 -none- numeric</span></span></code></pre>
<p>all we see is a brief description of the stucture of the MCMC output
contained within <code>results2</code>. This means that to look at the
results, we need to do a little more work.</p>
<p>There are two objects in <code>results2</code>; <code>mcmc</code>
contains the MCMC simulations, and <code>Y.pred</code> contains
predictions for the response variable, <code>lang</code> in this
example.</p>
<p>Doing</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Iterations = 101:1100</span></span>
<span><span class="co">## Thinning interval = 1 </span></span>
<span><span class="co">## Number of chains = 1 </span></span>
<span><span class="co">## Sample size per chain = 1000 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 1. Empirical mean and standard deviation for each variable,</span></span>
<span><span class="co">##    plus standard error of the mean:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                                   Mean        SD  Naive SE Time-series SE</span></span>
<span><span class="co">## beta.(Intercept)             1.110e+01 3.396e+01  1.073835      8.352e-01</span></span>
<span><span class="co">## beta.IQ                      2.202e+00 4.923e-01  0.015568      1.557e-02</span></span>
<span><span class="co">## beta.GS                     -1.020e-02 1.224e+00  0.038717      3.284e-02</span></span>
<span><span class="co">## beta.SES                     1.698e-01 9.814e-02  0.003104      3.104e-03</span></span>
<span><span class="co">## beta.COMB1                  -2.269e+00 1.643e+01  0.519640      6.681e-01</span></span>
<span><span class="co">## b.(Intercept).10180          2.822e+00 1.409e+01  0.445505      4.269e-01</span></span>
<span><span class="co">## b.(Intercept).10380         -4.625e+00 1.326e+01  0.419285      2.570e-01</span></span>
<span><span class="co">## b.(Intercept).10680         -9.340e-01 1.349e+01  0.426448      3.381e-01</span></span>
<span><span class="co">## b.(Intercept).10780         -5.082e+00 1.423e+01  0.450036      2.714e-01</span></span>
<span><span class="co">## b.(Intercept).1082          -3.713e+00 1.295e+01  0.409489      2.949e-01</span></span>
<span><span class="co">## b.(Intercept).10880         -1.631e+00 1.877e+01  0.593591      6.011e-01</span></span>
<span><span class="co">## b.(Intercept).10980         -3.788e+00 1.739e+01  0.549898      5.861e-01</span></span>
<span><span class="co">## b.(Intercept).11080         -2.927e-03 1.584e+01  0.500754      4.129e-01</span></span>
<span><span class="co">## b.(Intercept).11180         -3.191e-01 1.458e+01  0.461021      3.946e-01</span></span>
<span><span class="co">## b.(Intercept).11282          1.329e+00 1.296e+01  0.409908      2.386e-01</span></span>
<span><span class="co">## b.(Intercept).11580         -2.617e+00 1.603e+01  0.506799      5.368e-01</span></span>
<span><span class="co">## b.(Intercept).11680         -1.615e+00 1.306e+01  0.412990      2.510e-01</span></span>
<span><span class="co">## b.(Intercept).11880         -2.743e+00 1.341e+01  0.424094      2.535e-01</span></span>
<span><span class="co">## b.(Intercept).11980         -2.591e-02 1.523e+01  0.481533      2.401e-01</span></span>
<span><span class="co">## b.(Intercept).12180         -2.816e+00 1.368e+01  0.432664      3.212e-01</span></span>
<span><span class="co">## b.(Intercept).12380          4.617e-01 1.497e+01  0.473503      4.018e-01</span></span>
<span><span class="co">## b.(Intercept).12480          2.091e+00 1.426e+01  0.451065      3.981e-01</span></span>
<span><span class="co">## b.(Intercept).12580         -5.072e-01 1.880e+01  0.594369      6.446e-01</span></span>
<span><span class="co">## b.(Intercept).1280          -3.172e+00 1.416e+01  0.447812      2.339e-01</span></span>
<span><span class="co">## b.(Intercept).13080          6.304e+00 1.327e+01  0.419605      3.228e-01</span></span>
<span><span class="co">## b.(Intercept).13281          3.127e+00 1.457e+01  0.460852      3.947e-01</span></span>
<span><span class="co">## b.(Intercept).13680          5.096e+00 1.382e+01  0.437174      2.571e-01</span></span>
<span><span class="co">## b.(Intercept).13780          4.463e+00 1.473e+01  0.465719      2.340e-01</span></span>
<span><span class="co">## b.(Intercept).14180         -1.384e-01 1.534e+01  0.485000      3.854e-01</span></span>
<span><span class="co">## b.(Intercept).14280          3.882e+00 1.420e+01  0.449037      4.198e-01</span></span>
<span><span class="co">## b.(Intercept).14780          6.023e+00 1.453e+01  0.459436      3.739e-01</span></span>
<span><span class="co">## b.(Intercept).14880          6.673e-01 1.666e+01  0.526931      5.528e-01</span></span>
<span><span class="co">## b.(Intercept).14980         -9.056e-01 1.431e+01  0.452454      3.903e-01</span></span>
<span><span class="co">## b.(Intercept).15080         -1.096e+00 1.547e+01  0.489093      5.016e-01</span></span>
<span><span class="co">## b.(Intercept).15180         -6.022e-01 1.408e+01  0.445138      3.834e-01</span></span>
<span><span class="co">## b.(Intercept).15280          2.750e+00 1.696e+01  0.536408      4.475e-01</span></span>
<span><span class="co">## b.(Intercept).15580          1.589e+00 1.811e+01  0.572666      5.998e-01</span></span>
<span><span class="co">## b.(Intercept).15680          1.499e+00 1.992e+01  0.629870      3.236e-01</span></span>
<span><span class="co">## b.(Intercept).1580          -6.749e+00 1.659e+01  0.524725      2.611e-01</span></span>
<span><span class="co">## b.(Intercept).15980          1.240e+00 1.731e+01  0.547518      5.788e-01</span></span>
<span><span class="co">## b.(Intercept).16080          9.343e-01 1.427e+01  0.451409      4.366e-01</span></span>
<span><span class="co">## b.(Intercept).16180          2.811e+00 1.959e+01  0.619458      6.623e-01</span></span>
<span><span class="co">## b.(Intercept).16480          3.440e+00 1.414e+01  0.447141      3.850e-01</span></span>
<span><span class="co">## b.(Intercept).16780          7.800e-01 1.464e+01  0.462945      4.741e-01</span></span>
<span><span class="co">## b.(Intercept).1680           2.069e+00 1.317e+01  0.416535      2.653e-01</span></span>
<span><span class="co">## b.(Intercept).17080          2.095e+00 1.432e+01  0.452913      4.550e-01</span></span>
<span><span class="co">## b.(Intercept).17580          2.132e+00 1.301e+01  0.411497      2.528e-01</span></span>
<span><span class="co">## b.(Intercept).17680          4.767e+00 1.417e+01  0.447997      3.857e-01</span></span>
<span><span class="co">## b.(Intercept).17780          2.272e+00 1.324e+01  0.418640      3.089e-01</span></span>
<span><span class="co">## b.(Intercept).17980         -4.947e+00 2.313e+01  0.731377      7.503e-01</span></span>
<span><span class="co">## b.(Intercept).180            5.547e-01 1.503e+01  0.475279      4.864e-01</span></span>
<span><span class="co">## b.(Intercept).18280          1.679e+00 2.169e+01  0.685890      5.477e-01</span></span>
<span><span class="co">## b.(Intercept).18380         -6.964e-01 1.652e+01  0.522274      5.483e-01</span></span>
<span><span class="co">## b.(Intercept).18480         -1.595e+00 1.503e+01  0.475224      4.962e-01</span></span>
<span><span class="co">## b.(Intercept).1880          -8.772e+00 1.461e+01  0.461980      4.705e-01</span></span>
<span><span class="co">## b.(Intercept).18880          6.833e-03 1.294e+01  0.409124      2.884e-01</span></span>
<span><span class="co">## b.(Intercept).18980          1.265e+00 1.504e+01  0.475471      4.937e-01</span></span>
<span><span class="co">## b.(Intercept).19280         -2.737e+00 1.957e+01  0.618773      6.518e-01</span></span>
<span><span class="co">## b.(Intercept).19380          7.074e+00 1.413e+01  0.446934      2.292e-01</span></span>
<span><span class="co">## b.(Intercept).19580          1.580e+00 1.418e+01  0.448268      2.229e-01</span></span>
<span><span class="co">## b.(Intercept).19680          1.018e-01 1.437e+01  0.454514      4.789e-01</span></span>
<span><span class="co">## b.(Intercept).19780          2.143e+00 1.676e+01  0.530039      2.628e-01</span></span>
<span><span class="co">## b.(Intercept).19880         -3.633e-01 1.389e+01  0.439344      3.481e-01</span></span>
<span><span class="co">## b.(Intercept).19980         -4.024e+00 2.055e+01  0.649809      6.679e-01</span></span>
<span><span class="co">## b.(Intercept).20480         -1.921e+00 1.416e+01  0.447793      4.258e-01</span></span>
<span><span class="co">## b.(Intercept).20680          2.507e+00 2.166e+01  0.684833      5.445e-01</span></span>
<span><span class="co">## b.(Intercept).20980          1.794e+00 1.441e+01  0.455558      4.606e-01</span></span>
<span><span class="co">## b.(Intercept).21080         -3.199e+00 1.691e+01  0.534836      4.503e-01</span></span>
<span><span class="co">## b.(Intercept).21280          1.319e+00 1.418e+01  0.448512      4.243e-01</span></span>
<span><span class="co">## b.(Intercept).21480         -5.006e+00 1.440e+01  0.455237      4.695e-01</span></span>
<span><span class="co">## b.(Intercept).21580          1.232e+00 1.777e+01  0.561925      4.863e-01</span></span>
<span><span class="co">## b.(Intercept).21680          2.991e+00 1.624e+01  0.513440      4.565e-01</span></span>
<span><span class="co">## b.(Intercept).21780          1.365e+00 1.528e+01  0.483057      3.705e-01</span></span>
<span><span class="co">## b.(Intercept).2180          -1.554e+00 1.570e+01  0.496461      4.052e-01</span></span>
<span><span class="co">## b.(Intercept).21880          2.298e+00 1.439e+01  0.455138      4.686e-01</span></span>
<span><span class="co">## b.(Intercept).21980          6.687e+00 1.462e+01  0.462242      2.263e-01</span></span>
<span><span class="co">## b.(Intercept).22280         -1.498e+00 1.415e+01  0.447394      4.118e-01</span></span>
<span><span class="co">## b.(Intercept).22480         -1.234e+00 2.002e+01  0.633056      5.297e-01</span></span>
<span><span class="co">## b.(Intercept).22680         -7.101e-01 1.321e+01  0.417708      3.209e-01</span></span>
<span><span class="co">## b.(Intercept).22780          9.124e-01 1.553e+01  0.491049      5.076e-01</span></span>
<span><span class="co">## b.(Intercept).22880          6.171e+00 1.409e+01  0.445513      4.024e-01</span></span>
<span><span class="co">## b.(Intercept).23180          4.063e+00 1.485e+01  0.469639      3.822e-01</span></span>
<span><span class="co">## b.(Intercept).23380         -1.782e+00 1.395e+01  0.440988      3.660e-01</span></span>
<span><span class="co">## b.(Intercept).23480          1.565e+00 1.422e+01  0.449718      3.886e-01</span></span>
<span><span class="co">## b.(Intercept).23580          3.528e+00 1.870e+01  0.591488      5.973e-01</span></span>
<span><span class="co">## b.(Intercept).23780          2.294e+00 1.567e+01  0.495676      4.500e-01</span></span>
<span><span class="co">## b.(Intercept).24080          1.109e+00 1.294e+01  0.409121      2.763e-01</span></span>
<span><span class="co">## b.(Intercept).24180          1.497e+00 1.428e+01  0.451558      3.904e-01</span></span>
<span><span class="co">## b.(Intercept).24280          5.277e+00 1.820e+01  0.575534      2.685e-01</span></span>
<span><span class="co">## b.(Intercept).24380          5.451e+00 1.872e+01  0.591952      5.847e-01</span></span>
<span><span class="co">## b.(Intercept).24480         -9.103e-01 2.011e+01  0.636037      5.436e-01</span></span>
<span><span class="co">## b.(Intercept).24680          1.865e+00 1.467e+01  0.463748      2.401e-01</span></span>
<span><span class="co">## b.(Intercept).2480           3.692e+00 1.881e+01  0.594865      6.142e-01</span></span>
<span><span class="co">## b.(Intercept).24980         -1.289e+00 1.422e+01  0.449649      4.074e-01</span></span>
<span><span class="co">## b.(Intercept).25080          3.056e-01 1.307e+01  0.413383      2.910e-01</span></span>
<span><span class="co">## b.(Intercept).25280         -1.742e+00 1.419e+01  0.448662      4.085e-01</span></span>
<span><span class="co">## b.(Intercept).25680         -4.859e+00 1.462e+01  0.462361      2.386e-01</span></span>
<span><span class="co">## b.(Intercept).25880         -5.908e+00 1.358e+01  0.429505      2.497e-01</span></span>
<span><span class="co">## b.(Intercept).2680          -2.747e+00 1.494e+01  0.472409      3.940e-01</span></span>
<span><span class="co">## b.(Intercept).2780          -4.889e+00 1.470e+01  0.464943      2.438e-01</span></span>
<span><span class="co">## b.(Intercept).280           -6.232e+00 1.567e+01  0.495596      4.618e-01</span></span>
<span><span class="co">## b.(Intercept).2980           1.025e+00 1.396e+01  0.441607      3.530e-01</span></span>
<span><span class="co">## b.(Intercept).3380           5.074e-03 1.956e+01  0.618489      6.535e-01</span></span>
<span><span class="co">## b.(Intercept).3580           2.208e+00 1.785e+01  0.564614      5.838e-01</span></span>
<span><span class="co">## b.(Intercept).3680          -5.791e+00 1.499e+01  0.474064      5.011e-01</span></span>
<span><span class="co">## b.(Intercept).3880           8.000e-01 1.602e+01  0.506574      5.252e-01</span></span>
<span><span class="co">## b.(Intercept).4081          -2.836e+00 1.469e+01  0.464504      4.849e-01</span></span>
<span><span class="co">## b.(Intercept).4082           2.541e+00 2.249e+01  0.711289      7.492e-01</span></span>
<span><span class="co">## b.(Intercept).4180          -2.980e+00 1.638e+01  0.518011      4.049e-01</span></span>
<span><span class="co">## b.(Intercept).4280          -4.369e+00 1.442e+01  0.455960      3.853e-01</span></span>
<span><span class="co">## b.(Intercept).4480          -1.609e-01 1.311e+01  0.414474      3.125e-01</span></span>
<span><span class="co">## b.(Intercept).4780          -5.779e+00 1.877e+01  0.593458      6.114e-01</span></span>
<span><span class="co">## b.(Intercept).4880          -2.195e+00 1.574e+01  0.497825      3.933e-01</span></span>
<span><span class="co">## b.(Intercept).4980          -2.884e+00 1.310e+01  0.414191      2.469e-01</span></span>
<span><span class="co">## b.(Intercept).5280          -4.691e+00 1.441e+01  0.455734      4.267e-01</span></span>
<span><span class="co">## b.(Intercept).5480          -4.502e-01 1.670e+01  0.527972      5.574e-01</span></span>
<span><span class="co">## b.(Intercept).5580          -1.999e+00 1.664e+01  0.526319      5.502e-01</span></span>
<span><span class="co">## b.(Intercept).5780          -2.235e+00 1.606e+01  0.507994      5.180e-01</span></span>
<span><span class="co">## b.(Intercept).6081          -2.068e+00 1.298e+01  0.410475      2.801e-01</span></span>
<span><span class="co">## b.(Intercept).6082          -9.360e-01 1.314e+01  0.415432      2.965e-01</span></span>
<span><span class="co">## b.(Intercept).6180          -1.146e+00 1.441e+01  0.455547      4.627e-01</span></span>
<span><span class="co">## b.(Intercept).6280          -3.680e-01 1.432e+01  0.452722      4.249e-01</span></span>
<span><span class="co">## b.(Intercept).6580           5.841e+00 1.475e+01  0.466448      2.403e-01</span></span>
<span><span class="co">## b.(Intercept).6680          -6.867e-01 1.365e+01  0.431596      2.571e-01</span></span>
<span><span class="co">## b.(Intercept).6780          -6.833e+00 1.467e+01  0.463840      4.820e-01</span></span>
<span><span class="co">## b.(Intercept).6880          -8.785e-01 1.443e+01  0.456317      3.910e-01</span></span>
<span><span class="co">## b.(Intercept).7680          -2.209e+00 1.695e+01  0.535997      4.306e-01</span></span>
<span><span class="co">## b.(Intercept).7880          -1.039e+00 1.433e+01  0.453172      4.053e-01</span></span>
<span><span class="co">## b.(Intercept).7980          -3.795e-01 1.690e+01  0.534541      4.426e-01</span></span>
<span><span class="co">## b.(Intercept).8080           1.100e+00 1.472e+01  0.465521      4.732e-01</span></span>
<span><span class="co">## b.(Intercept).8680          -1.827e+00 1.655e+01  0.523291      5.567e-01</span></span>
<span><span class="co">## b.(Intercept).8780          -1.879e+00 1.467e+01  0.463922      4.464e-01</span></span>
<span><span class="co">## b.(Intercept).8880           8.963e-01 1.315e+01  0.415918      2.632e-01</span></span>
<span><span class="co">## b.(Intercept).9080           2.246e+00 1.453e+01  0.459633      3.905e-01</span></span>
<span><span class="co">## b.(Intercept).9480           2.875e-02 1.417e+01  0.448092      4.148e-01</span></span>
<span><span class="co">## b.(Intercept).9580          -2.636e+00 1.419e+01  0.448765      3.852e-01</span></span>
<span><span class="co">## b.(Intercept).9780           7.217e-01 1.812e+01  0.572874      6.088e-01</span></span>
<span><span class="co">## b.(Intercept).9880          -1.583e+00 1.464e+01  0.462888      3.867e-01</span></span>
<span><span class="co">## VCV.(Intercept).(Intercept)  2.635e+02 2.861e+03 90.464824      1.618e+02</span></span>
<span><span class="co">## sigma2                       4.162e+01 1.972e+00  0.062362      6.601e-02</span></span>
<span><span class="co">## Deviance                     1.502e+04 8.015e+01  2.534519      2.672e+00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 2. Quantiles for each variable:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                                   2.5%        25%        50%        75%</span></span>
<span><span class="co">## beta.(Intercept)            -3.684e+01 -1.193e+00  1.081e+01  2.302e+01</span></span>
<span><span class="co">## beta.IQ                      1.289e+00  1.869e+00  2.206e+00  2.539e+00</span></span>
<span><span class="co">## beta.GS                     -2.041e+00 -4.443e-01 -2.741e-02  4.147e-01</span></span>
<span><span class="co">## beta.SES                    -2.861e-02  1.049e-01  1.725e-01  2.385e-01</span></span>
<span><span class="co">## beta.COMB1                  -2.611e+01 -7.296e+00 -1.970e+00  2.813e+00</span></span>
<span><span class="co">## b.(Intercept).10180         -1.009e+01 -2.310e-01  3.093e+00  6.268e+00</span></span>
<span><span class="co">## b.(Intercept).10380         -2.507e+01 -8.379e+00 -4.227e+00 -6.738e-02</span></span>
<span><span class="co">## b.(Intercept).10680         -1.974e+01 -4.848e+00 -8.632e-01  3.215e+00</span></span>
<span><span class="co">## b.(Intercept).10780         -2.808e+01 -9.702e+00 -4.927e+00 -2.542e-01</span></span>
<span><span class="co">## b.(Intercept).1082          -2.253e+01 -7.304e+00 -3.371e+00  3.373e-01</span></span>
<span><span class="co">## b.(Intercept).10880         -2.836e+01 -6.984e+00 -1.737e+00  3.851e+00</span></span>
<span><span class="co">## b.(Intercept).10980         -2.510e+01 -7.980e+00 -3.525e+00  1.082e+00</span></span>
<span><span class="co">## b.(Intercept).11080         -2.176e+01 -3.650e+00  3.519e-01  4.392e+00</span></span>
<span><span class="co">## b.(Intercept).11180         -1.566e+01 -3.403e+00 -1.485e-01  3.354e+00</span></span>
<span><span class="co">## b.(Intercept).11282         -1.875e+01 -2.757e+00  1.290e+00  5.444e+00</span></span>
<span><span class="co">## b.(Intercept).11580         -2.036e+01 -6.284e+00 -2.286e+00  1.832e+00</span></span>
<span><span class="co">## b.(Intercept).11680         -2.252e+01 -5.704e+00 -1.609e+00  2.673e+00</span></span>
<span><span class="co">## b.(Intercept).11880         -2.482e+01 -6.539e+00 -2.610e+00  1.306e+00</span></span>
<span><span class="co">## b.(Intercept).11980         -2.458e+01 -4.729e+00  2.078e-03  4.679e+00</span></span>
<span><span class="co">## b.(Intercept).12180         -2.148e+01 -7.140e+00 -2.783e+00  1.577e+00</span></span>
<span><span class="co">## b.(Intercept).12380         -2.065e+01 -4.046e+00  3.180e-01  4.640e+00</span></span>
<span><span class="co">## b.(Intercept).12480         -1.194e+01 -9.384e-01  2.306e+00  5.416e+00</span></span>
<span><span class="co">## b.(Intercept).12580         -2.269e+01 -5.377e+00 -1.319e-01  4.818e+00</span></span>
<span><span class="co">## b.(Intercept).1280          -2.637e+01 -7.462e+00 -3.078e+00  1.388e+00</span></span>
<span><span class="co">## b.(Intercept).13080         -1.313e+01  2.235e+00  6.206e+00  1.031e+01</span></span>
<span><span class="co">## b.(Intercept).13281         -1.251e+01  5.495e-02  3.376e+00  6.960e+00</span></span>
<span><span class="co">## b.(Intercept).13680         -1.626e+01  9.883e-01  4.949e+00  9.410e+00</span></span>
<span><span class="co">## b.(Intercept).13780         -1.908e+01 -2.156e-03  4.437e+00  8.832e+00</span></span>
<span><span class="co">## b.(Intercept).14180         -1.855e+01 -3.668e+00  1.814e-01  3.947e+00</span></span>
<span><span class="co">## b.(Intercept).14280         -1.010e+01  9.563e-01  4.184e+00  7.369e+00</span></span>
<span><span class="co">## b.(Intercept).14780         -9.832e+00  2.937e+00  6.052e+00  9.600e+00</span></span>
<span><span class="co">## b.(Intercept).14880         -1.899e+01 -3.250e+00  1.003e+00  5.319e+00</span></span>
<span><span class="co">## b.(Intercept).14980         -1.495e+01 -4.124e+00 -5.666e-01  2.708e+00</span></span>
<span><span class="co">## b.(Intercept).15080         -1.889e+01 -4.712e+00 -8.763e-01  3.192e+00</span></span>
<span><span class="co">## b.(Intercept).15180         -1.428e+01 -3.434e+00 -3.019e-01  2.692e+00</span></span>
<span><span class="co">## b.(Intercept).15280         -1.958e+01 -1.379e+00  3.135e+00  7.870e+00</span></span>
<span><span class="co">## b.(Intercept).15580         -2.094e+01 -3.105e+00  2.063e+00  6.951e+00</span></span>
<span><span class="co">## b.(Intercept).15680         -2.756e+01 -4.939e+00  1.189e+00  7.891e+00</span></span>
<span><span class="co">## b.(Intercept).1580          -3.357e+01 -1.175e+01 -6.111e+00 -1.308e+00</span></span>
<span><span class="co">## b.(Intercept).15980         -1.918e+01 -3.062e+00  1.766e+00  5.864e+00</span></span>
<span><span class="co">## b.(Intercept).16080         -1.235e+01 -1.898e+00  1.260e+00  4.314e+00</span></span>
<span><span class="co">## b.(Intercept).16180         -2.186e+01 -2.271e+00  3.189e+00  8.365e+00</span></span>
<span><span class="co">## b.(Intercept).16480         -1.003e+01  3.418e-01  3.711e+00  6.767e+00</span></span>
<span><span class="co">## b.(Intercept).16780         -1.442e+01 -2.278e+00  9.907e-01  4.351e+00</span></span>
<span><span class="co">## b.(Intercept).1680          -1.794e+01 -1.811e+00  2.313e+00  6.155e+00</span></span>
<span><span class="co">## b.(Intercept).17080         -1.192e+01 -9.309e-01  2.310e+00  5.491e+00</span></span>
<span><span class="co">## b.(Intercept).17580         -1.683e+01 -1.637e+00  2.015e+00  6.076e+00</span></span>
<span><span class="co">## b.(Intercept).17680         -9.022e+00  1.851e+00  4.909e+00  8.239e+00</span></span>
<span><span class="co">## b.(Intercept).17780         -1.715e+01 -1.931e+00  2.190e+00  6.136e+00</span></span>
<span><span class="co">## b.(Intercept).17980         -3.783e+01 -1.172e+01 -4.539e+00  1.336e+00</span></span>
<span><span class="co">## b.(Intercept).180           -1.633e+01 -2.998e+00  8.198e-01  4.484e+00</span></span>
<span><span class="co">## b.(Intercept).18280         -2.967e+01 -4.140e+00  1.713e+00  8.222e+00</span></span>
<span><span class="co">## b.(Intercept).18380         -2.102e+01 -4.394e+00 -4.012e-01  3.955e+00</span></span>
<span><span class="co">## b.(Intercept).18480         -1.761e+01 -4.940e+00 -1.504e+00  2.356e+00</span></span>
<span><span class="co">## b.(Intercept).1880          -2.398e+01 -1.190e+01 -8.377e+00 -5.028e+00</span></span>
<span><span class="co">## b.(Intercept).18880         -1.879e+01 -3.924e+00  8.340e-02  4.092e+00</span></span>
<span><span class="co">## b.(Intercept).18980         -1.519e+01 -1.961e+00  1.492e+00  5.046e+00</span></span>
<span><span class="co">## b.(Intercept).19280         -3.073e+01 -8.666e+00 -2.666e+00  3.069e+00</span></span>
<span><span class="co">## b.(Intercept).19380         -1.410e+01  2.390e+00  6.851e+00  1.139e+01</span></span>
<span><span class="co">## b.(Intercept).19580         -2.227e+01 -2.691e+00  1.814e+00  6.120e+00</span></span>
<span><span class="co">## b.(Intercept).19680         -1.392e+01 -2.873e+00  4.230e-01  3.550e+00</span></span>
<span><span class="co">## b.(Intercept).19780         -2.396e+01 -3.438e+00  2.239e+00  7.668e+00</span></span>
<span><span class="co">## b.(Intercept).19880         -1.846e+01 -4.343e+00 -2.711e-01  3.721e+00</span></span>
<span><span class="co">## b.(Intercept).19980         -3.105e+01 -9.409e+00 -3.593e+00  1.922e+00</span></span>
<span><span class="co">## b.(Intercept).20480         -1.628e+01 -4.923e+00 -1.687e+00  1.540e+00</span></span>
<span><span class="co">## b.(Intercept).20680         -3.148e+01 -3.353e+00  2.835e+00  9.251e+00</span></span>
<span><span class="co">## b.(Intercept).20980         -1.218e+01 -1.230e+00  2.093e+00  5.567e+00</span></span>
<span><span class="co">## b.(Intercept).21080         -2.564e+01 -7.430e+00 -2.828e+00  1.754e+00</span></span>
<span><span class="co">## b.(Intercept).21280         -1.297e+01 -1.750e+00  1.513e+00  4.723e+00</span></span>
<span><span class="co">## b.(Intercept).21480         -1.896e+01 -7.981e+00 -4.573e+00 -1.470e+00</span></span>
<span><span class="co">## b.(Intercept).21580         -2.418e+01 -3.179e+00  1.596e+00  6.251e+00</span></span>
<span><span class="co">## b.(Intercept).21680         -1.962e+01 -1.799e+00  2.760e+00  7.470e+00</span></span>
<span><span class="co">## b.(Intercept).21780         -1.824e+01 -2.156e+00  1.481e+00  5.435e+00</span></span>
<span><span class="co">## b.(Intercept).2180          -2.272e+01 -5.279e+00 -1.162e+00  3.035e+00</span></span>
<span><span class="co">## b.(Intercept).21880         -1.116e+01 -6.809e-01  2.500e+00  5.903e+00</span></span>
<span><span class="co">## b.(Intercept).21980         -1.702e+01  2.103e+00  6.714e+00  1.144e+01</span></span>
<span><span class="co">## b.(Intercept).22280         -1.538e+01 -4.393e+00 -1.321e+00  1.936e+00</span></span>
<span><span class="co">## b.(Intercept).22480         -2.951e+01 -6.572e+00 -7.373e-01  4.955e+00</span></span>
<span><span class="co">## b.(Intercept).22680         -1.978e+01 -4.722e+00 -6.738e-01  3.254e+00</span></span>
<span><span class="co">## b.(Intercept).22780         -1.665e+01 -2.534e+00  8.968e-01  5.060e+00</span></span>
<span><span class="co">## b.(Intercept).22880         -6.957e+00  3.303e+00  6.418e+00  9.735e+00</span></span>
<span><span class="co">## b.(Intercept).23180         -1.306e+01  7.381e-01  4.031e+00  8.093e+00</span></span>
<span><span class="co">## b.(Intercept).23380         -2.157e+01 -5.769e+00 -1.744e+00  2.370e+00</span></span>
<span><span class="co">## b.(Intercept).23480         -1.164e+01 -1.363e+00  1.902e+00  4.989e+00</span></span>
<span><span class="co">## b.(Intercept).23580         -2.246e+01 -2.368e+00  3.507e+00  8.946e+00</span></span>
<span><span class="co">## b.(Intercept).23780         -1.944e+01 -2.511e+00  2.121e+00  6.936e+00</span></span>
<span><span class="co">## b.(Intercept).24080         -1.708e+01 -2.475e+00  9.738e-01  5.131e+00</span></span>
<span><span class="co">## b.(Intercept).24180         -1.232e+01 -1.535e+00  1.771e+00  5.229e+00</span></span>
<span><span class="co">## b.(Intercept).24280         -2.179e+01 -5.393e-01  5.348e+00  1.090e+01</span></span>
<span><span class="co">## b.(Intercept).24380         -2.084e+01 -3.740e-01  5.211e+00  1.074e+01</span></span>
<span><span class="co">## b.(Intercept).24480         -3.143e+01 -6.263e+00 -2.007e-01  5.395e+00</span></span>
<span><span class="co">## b.(Intercept).24680         -2.125e+01 -2.943e+00  1.705e+00  6.639e+00</span></span>
<span><span class="co">## b.(Intercept).2480          -1.932e+01 -1.130e+00  4.181e+00  9.082e+00</span></span>
<span><span class="co">## b.(Intercept).24980         -1.467e+01 -4.157e+00 -1.017e+00  2.107e+00</span></span>
<span><span class="co">## b.(Intercept).25080         -1.847e+01 -3.702e+00  3.199e-01  4.391e+00</span></span>
<span><span class="co">## b.(Intercept).25280         -1.533e+01 -4.596e+00 -1.379e+00  1.721e+00</span></span>
<span><span class="co">## b.(Intercept).25680         -2.813e+01 -9.278e+00 -4.676e+00 -5.657e-02</span></span>
<span><span class="co">## b.(Intercept).25880         -2.702e+01 -9.762e+00 -5.473e+00 -1.509e+00</span></span>
<span><span class="co">## b.(Intercept).2680          -2.054e+01 -5.879e+00 -2.422e+00  1.225e+00</span></span>
<span><span class="co">## b.(Intercept).2780          -2.877e+01 -9.510e+00 -4.858e+00 -2.977e-02</span></span>
<span><span class="co">## b.(Intercept).280           -2.935e+01 -1.090e+01 -6.005e+00 -1.487e+00</span></span>
<span><span class="co">## b.(Intercept).2980          -1.746e+01 -3.438e+00  9.835e-01  5.583e+00</span></span>
<span><span class="co">## b.(Intercept).3380          -2.690e+01 -5.379e+00 -5.261e-02  5.165e+00</span></span>
<span><span class="co">## b.(Intercept).3580          -2.282e+01 -3.169e+00  2.129e+00  7.327e+00</span></span>
<span><span class="co">## b.(Intercept).3680          -2.157e+01 -8.889e+00 -5.456e+00 -1.903e+00</span></span>
<span><span class="co">## b.(Intercept).3880          -1.716e+01 -3.033e+00  1.088e+00  5.237e+00</span></span>
<span><span class="co">## b.(Intercept).4081          -1.803e+01 -5.854e+00 -2.652e+00  1.004e+00</span></span>
<span><span class="co">## b.(Intercept).4082          -3.200e+01 -4.667e+00  2.802e+00  8.664e+00</span></span>
<span><span class="co">## b.(Intercept).4180          -2.527e+01 -6.863e+00 -2.427e+00  1.675e+00</span></span>
<span><span class="co">## b.(Intercept).4280          -2.418e+01 -8.651e+00 -4.316e+00  3.937e-02</span></span>
<span><span class="co">## b.(Intercept).4480          -2.024e+01 -4.401e+00  5.478e-02  3.982e+00</span></span>
<span><span class="co">## b.(Intercept).4780          -3.222e+01 -1.149e+01 -5.382e+00 -1.955e-01</span></span>
<span><span class="co">## b.(Intercept).4880          -2.377e+01 -5.701e+00 -1.792e+00  2.346e+00</span></span>
<span><span class="co">## b.(Intercept).4980          -2.321e+01 -7.016e+00 -2.585e+00  1.397e+00</span></span>
<span><span class="co">## b.(Intercept).5280          -1.888e+01 -7.619e+00 -4.387e+00 -9.815e-01</span></span>
<span><span class="co">## b.(Intercept).5480          -1.979e+01 -4.611e+00 -9.158e-02  4.362e+00</span></span>
<span><span class="co">## b.(Intercept).5580          -2.162e+01 -5.939e+00 -1.527e+00  2.489e+00</span></span>
<span><span class="co">## b.(Intercept).5780          -1.931e+01 -5.825e+00 -2.051e+00  2.229e+00</span></span>
<span><span class="co">## b.(Intercept).6081          -2.185e+01 -5.832e+00 -1.866e+00  1.824e+00</span></span>
<span><span class="co">## b.(Intercept).6082          -2.131e+01 -4.779e+00 -8.159e-01  3.390e+00</span></span>
<span><span class="co">## b.(Intercept).6180          -1.553e+01 -3.920e+00 -9.364e-01  2.389e+00</span></span>
<span><span class="co">## b.(Intercept).6280          -1.477e+01 -3.295e+00 -1.961e-01  3.275e+00</span></span>
<span><span class="co">## b.(Intercept).6580          -1.639e+01  1.006e+00  5.869e+00  1.049e+01</span></span>
<span><span class="co">## b.(Intercept).6680          -2.197e+01 -4.814e+00 -7.766e-01  3.611e+00</span></span>
<span><span class="co">## b.(Intercept).6780          -2.212e+01 -9.768e+00 -6.402e+00 -3.043e+00</span></span>
<span><span class="co">## b.(Intercept).6880          -1.560e+01 -3.979e+00 -5.274e-01  2.913e+00</span></span>
<span><span class="co">## b.(Intercept).7680          -2.548e+01 -6.160e+00 -1.814e+00  2.578e+00</span></span>
<span><span class="co">## b.(Intercept).7880          -1.475e+01 -3.958e+00 -6.509e-01  2.525e+00</span></span>
<span><span class="co">## b.(Intercept).7980          -2.404e+01 -4.375e+00  1.800e-02  4.641e+00</span></span>
<span><span class="co">## b.(Intercept).8080          -1.398e+01 -2.176e+00  1.331e+00  4.805e+00</span></span>
<span><span class="co">## b.(Intercept).8680          -2.060e+01 -5.718e+00 -1.622e+00  2.613e+00</span></span>
<span><span class="co">## b.(Intercept).8780          -1.683e+01 -5.093e+00 -1.517e+00  1.895e+00</span></span>
<span><span class="co">## b.(Intercept).8880          -1.853e+01 -3.368e+00  1.155e+00  5.065e+00</span></span>
<span><span class="co">## b.(Intercept).9080          -1.272e+01 -9.080e-01  2.483e+00  5.943e+00</span></span>
<span><span class="co">## b.(Intercept).9480          -1.328e+01 -2.955e+00  2.494e-01  3.537e+00</span></span>
<span><span class="co">## b.(Intercept).9580          -1.662e+01 -5.601e+00 -2.110e+00  8.041e-01</span></span>
<span><span class="co">## b.(Intercept).9780          -2.154e+01 -4.005e+00  1.018e+00  5.659e+00</span></span>
<span><span class="co">## b.(Intercept).9880          -1.762e+01 -4.978e+00 -1.365e+00  2.311e+00</span></span>
<span><span class="co">## VCV.(Intercept).(Intercept)  1.168e+01  2.242e+01  4.043e+01  9.106e+01</span></span>
<span><span class="co">## sigma2                       3.849e+01  4.026e+01  4.141e+01  4.269e+01</span></span>
<span><span class="co">## Deviance                     1.492e+04  1.496e+04  1.500e+04  1.505e+04</span></span>
<span><span class="co">##                                 97.5%</span></span>
<span><span class="co">## beta.(Intercept)            6.247e+01</span></span>
<span><span class="co">## beta.IQ                     3.220e+00</span></span>
<span><span class="co">## beta.GS                     1.963e+00</span></span>
<span><span class="co">## beta.SES                    3.544e-01</span></span>
<span><span class="co">## beta.COMB1                  2.090e+01</span></span>
<span><span class="co">## b.(Intercept).10180         1.778e+01</span></span>
<span><span class="co">## b.(Intercept).10380         1.469e+01</span></span>
<span><span class="co">## b.(Intercept).10680         1.831e+01</span></span>
<span><span class="co">## b.(Intercept).10780         1.622e+01</span></span>
<span><span class="co">## b.(Intercept).1082          1.343e+01</span></span>
<span><span class="co">## b.(Intercept).10880         2.669e+01</span></span>
<span><span class="co">## b.(Intercept).10980         1.844e+01</span></span>
<span><span class="co">## b.(Intercept).11080         1.654e+01</span></span>
<span><span class="co">## b.(Intercept).11180         1.449e+01</span></span>
<span><span class="co">## b.(Intercept).11282         2.073e+01</span></span>
<span><span class="co">## b.(Intercept).11580         1.676e+01</span></span>
<span><span class="co">## b.(Intercept).11680         1.827e+01</span></span>
<span><span class="co">## b.(Intercept).11880         1.675e+01</span></span>
<span><span class="co">## b.(Intercept).11980         2.492e+01</span></span>
<span><span class="co">## b.(Intercept).12180         1.876e+01</span></span>
<span><span class="co">## b.(Intercept).12380         2.124e+01</span></span>
<span><span class="co">## b.(Intercept).12480         1.751e+01</span></span>
<span><span class="co">## b.(Intercept).12580         2.534e+01</span></span>
<span><span class="co">## b.(Intercept).1280          1.731e+01</span></span>
<span><span class="co">## b.(Intercept).13080         2.745e+01</span></span>
<span><span class="co">## b.(Intercept).13281         1.773e+01</span></span>
<span><span class="co">## b.(Intercept).13680         2.633e+01</span></span>
<span><span class="co">## b.(Intercept).13780         2.887e+01</span></span>
<span><span class="co">## b.(Intercept).14180         1.611e+01</span></span>
<span><span class="co">## b.(Intercept).14280         1.854e+01</span></span>
<span><span class="co">## b.(Intercept).14780         2.076e+01</span></span>
<span><span class="co">## b.(Intercept).14880         2.231e+01</span></span>
<span><span class="co">## b.(Intercept).14980         1.395e+01</span></span>
<span><span class="co">## b.(Intercept).15080         1.526e+01</span></span>
<span><span class="co">## b.(Intercept).15180         1.337e+01</span></span>
<span><span class="co">## b.(Intercept).15280         2.188e+01</span></span>
<span><span class="co">## b.(Intercept).15580         2.487e+01</span></span>
<span><span class="co">## b.(Intercept).15680         3.751e+01</span></span>
<span><span class="co">## b.(Intercept).1580          1.891e+01</span></span>
<span><span class="co">## b.(Intercept).15980         2.291e+01</span></span>
<span><span class="co">## b.(Intercept).16080         1.573e+01</span></span>
<span><span class="co">## b.(Intercept).16180         3.059e+01</span></span>
<span><span class="co">## b.(Intercept).16480         1.766e+01</span></span>
<span><span class="co">## b.(Intercept).16780         1.671e+01</span></span>
<span><span class="co">## b.(Intercept).1680          2.301e+01</span></span>
<span><span class="co">## b.(Intercept).17080         1.839e+01</span></span>
<span><span class="co">## b.(Intercept).17580         2.200e+01</span></span>
<span><span class="co">## b.(Intercept).17680         2.005e+01</span></span>
<span><span class="co">## b.(Intercept).17780         2.319e+01</span></span>
<span><span class="co">## b.(Intercept).17980         2.999e+01</span></span>
<span><span class="co">## b.(Intercept).180           1.844e+01</span></span>
<span><span class="co">## b.(Intercept).18280         2.952e+01</span></span>
<span><span class="co">## b.(Intercept).18380         2.001e+01</span></span>
<span><span class="co">## b.(Intercept).18480         1.580e+01</span></span>
<span><span class="co">## b.(Intercept).1880          6.254e+00</span></span>
<span><span class="co">## b.(Intercept).18880         2.021e+01</span></span>
<span><span class="co">## b.(Intercept).18980         1.890e+01</span></span>
<span><span class="co">## b.(Intercept).19280         2.587e+01</span></span>
<span><span class="co">## b.(Intercept).19380         2.907e+01</span></span>
<span><span class="co">## b.(Intercept).19580         2.456e+01</span></span>
<span><span class="co">## b.(Intercept).19680         1.586e+01</span></span>
<span><span class="co">## b.(Intercept).19780         2.841e+01</span></span>
<span><span class="co">## b.(Intercept).19880         2.089e+01</span></span>
<span><span class="co">## b.(Intercept).19980         2.593e+01</span></span>
<span><span class="co">## b.(Intercept).20480         1.353e+01</span></span>
<span><span class="co">## b.(Intercept).20680         3.205e+01</span></span>
<span><span class="co">## b.(Intercept).20980         1.733e+01</span></span>
<span><span class="co">## b.(Intercept).21080         1.613e+01</span></span>
<span><span class="co">## b.(Intercept).21280         1.676e+01</span></span>
<span><span class="co">## b.(Intercept).21480         1.084e+01</span></span>
<span><span class="co">## b.(Intercept).21580         2.157e+01</span></span>
<span><span class="co">## b.(Intercept).21680         2.768e+01</span></span>
<span><span class="co">## b.(Intercept).21780         1.717e+01</span></span>
<span><span class="co">## b.(Intercept).2180          1.492e+01</span></span>
<span><span class="co">## b.(Intercept).21880         1.846e+01</span></span>
<span><span class="co">## b.(Intercept).21980         3.085e+01</span></span>
<span><span class="co">## b.(Intercept).22280         1.288e+01</span></span>
<span><span class="co">## b.(Intercept).22480         2.345e+01</span></span>
<span><span class="co">## b.(Intercept).22680         1.945e+01</span></span>
<span><span class="co">## b.(Intercept).22780         1.955e+01</span></span>
<span><span class="co">## b.(Intercept).22880         2.075e+01</span></span>
<span><span class="co">## b.(Intercept).23180         1.958e+01</span></span>
<span><span class="co">## b.(Intercept).23380         1.996e+01</span></span>
<span><span class="co">## b.(Intercept).23480         1.672e+01</span></span>
<span><span class="co">## b.(Intercept).23580         3.147e+01</span></span>
<span><span class="co">## b.(Intercept).23780         2.582e+01</span></span>
<span><span class="co">## b.(Intercept).24080         1.992e+01</span></span>
<span><span class="co">## b.(Intercept).24180         1.575e+01</span></span>
<span><span class="co">## b.(Intercept).24280         3.667e+01</span></span>
<span><span class="co">## b.(Intercept).24380         3.241e+01</span></span>
<span><span class="co">## b.(Intercept).24480         2.494e+01</span></span>
<span><span class="co">## b.(Intercept).24680         2.511e+01</span></span>
<span><span class="co">## b.(Intercept).2480          2.945e+01</span></span>
<span><span class="co">## b.(Intercept).24980         1.327e+01</span></span>
<span><span class="co">## b.(Intercept).25080         1.960e+01</span></span>
<span><span class="co">## b.(Intercept).25280         1.262e+01</span></span>
<span><span class="co">## b.(Intercept).25680         1.825e+01</span></span>
<span><span class="co">## b.(Intercept).25880         1.456e+01</span></span>
<span><span class="co">## b.(Intercept).2680          1.292e+01</span></span>
<span><span class="co">## b.(Intercept).2780          1.848e+01</span></span>
<span><span class="co">## b.(Intercept).280           1.622e+01</span></span>
<span><span class="co">## b.(Intercept).2980          2.076e+01</span></span>
<span><span class="co">## b.(Intercept).3380          2.927e+01</span></span>
<span><span class="co">## b.(Intercept).3580          2.993e+01</span></span>
<span><span class="co">## b.(Intercept).3680          1.145e+01</span></span>
<span><span class="co">## b.(Intercept).3880          1.922e+01</span></span>
<span><span class="co">## b.(Intercept).4081          1.336e+01</span></span>
<span><span class="co">## b.(Intercept).4082          3.714e+01</span></span>
<span><span class="co">## b.(Intercept).4180          1.470e+01</span></span>
<span><span class="co">## b.(Intercept).4280          1.607e+01</span></span>
<span><span class="co">## b.(Intercept).4480          1.956e+01</span></span>
<span><span class="co">## b.(Intercept).4780          2.109e+01</span></span>
<span><span class="co">## b.(Intercept).4880          1.409e+01</span></span>
<span><span class="co">## b.(Intercept).4980          1.629e+01</span></span>
<span><span class="co">## b.(Intercept).5280          1.088e+01</span></span>
<span><span class="co">## b.(Intercept).5480          1.919e+01</span></span>
<span><span class="co">## b.(Intercept).5580          1.783e+01</span></span>
<span><span class="co">## b.(Intercept).5780          1.670e+01</span></span>
<span><span class="co">## b.(Intercept).6081          1.826e+01</span></span>
<span><span class="co">## b.(Intercept).6082          1.961e+01</span></span>
<span><span class="co">## b.(Intercept).6180          1.491e+01</span></span>
<span><span class="co">## b.(Intercept).6280          1.579e+01</span></span>
<span><span class="co">## b.(Intercept).6580          2.989e+01</span></span>
<span><span class="co">## b.(Intercept).6680          2.029e+01</span></span>
<span><span class="co">## b.(Intercept).6780          8.848e+00</span></span>
<span><span class="co">## b.(Intercept).6880          1.435e+01</span></span>
<span><span class="co">## b.(Intercept).7680          1.756e+01</span></span>
<span><span class="co">## b.(Intercept).7880          1.302e+01</span></span>
<span><span class="co">## b.(Intercept).7980          1.884e+01</span></span>
<span><span class="co">## b.(Intercept).8080          1.721e+01</span></span>
<span><span class="co">## b.(Intercept).8680          1.846e+01</span></span>
<span><span class="co">## b.(Intercept).8780          1.421e+01</span></span>
<span><span class="co">## b.(Intercept).8880          2.133e+01</span></span>
<span><span class="co">## b.(Intercept).9080          1.658e+01</span></span>
<span><span class="co">## b.(Intercept).9480          1.389e+01</span></span>
<span><span class="co">## b.(Intercept).9580          1.184e+01</span></span>
<span><span class="co">## b.(Intercept).9780          2.474e+01</span></span>
<span><span class="co">## b.(Intercept).9880          1.389e+01</span></span>
<span><span class="co">## VCV.(Intercept).(Intercept) 8.657e+02</span></span>
<span><span class="co">## sigma2                      4.635e+01</span></span>
<span><span class="co">## Deviance                    1.523e+04</span></span></code></pre>
<p>gives summary statistics for <em>everything</em> in the model -
including all of the random effects. Most often we want to study the
fixed effects; we can select <em>only</em> those terms using the
somewhat clunky but powerful code below,. making use of
<code>grepl</code>, a function for matching regular expressions:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Iterations = 101:1100</span></span>
<span><span class="co">## Thinning interval = 1 </span></span>
<span><span class="co">## Number of chains = 1 </span></span>
<span><span class="co">## Sample size per chain = 1000 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 1. Empirical mean and standard deviation for each variable,</span></span>
<span><span class="co">##    plus standard error of the mean:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                     Mean       SD Naive SE Time-series SE</span></span>
<span><span class="co">## beta.(Intercept) 11.0968 33.95764 1.073835       0.835216</span></span>
<span><span class="co">## beta.IQ           2.2020  0.49230 0.015568       0.015568</span></span>
<span><span class="co">## beta.GS          -0.0102  1.22434 0.038717       0.032844</span></span>
<span><span class="co">## beta.SES          0.1698  0.09814 0.003104       0.003104</span></span>
<span><span class="co">## beta.COMB1       -2.2688 16.43247 0.519640       0.668066</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 2. Quantiles for each variable:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       2.5%     25%      50%     75%   97.5%</span></span>
<span><span class="co">## beta.(Intercept) -36.84191 -1.1933 10.81373 23.0201 62.4749</span></span>
<span><span class="co">## beta.IQ            1.28912  1.8688  2.20552  2.5387  3.2202</span></span>
<span><span class="co">## beta.GS           -2.04128 -0.4443 -0.02741  0.4147  1.9634</span></span>
<span><span class="co">## beta.SES          -0.02861  0.1049  0.17252  0.2385  0.3544</span></span>
<span><span class="co">## beta.COMB1       -26.10932 -7.2956 -1.96992  2.8135 20.9009</span></span></code></pre>
<p>We are also interested in the variance terms for the random effects
and for the residuals - the relative sizes of these in informative on
whether there is more variability within the groups or between the
groups.</p>
<p>For the residual variance, we use</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"sigma2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Iterations = 101:1100</span></span>
<span><span class="co">## Thinning interval = 1 </span></span>
<span><span class="co">## Number of chains = 1 </span></span>
<span><span class="co">## Sample size per chain = 1000 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 1. Empirical mean and standard deviation for each variable,</span></span>
<span><span class="co">##    plus standard error of the mean:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##           Mean             SD       Naive SE Time-series SE </span></span>
<span><span class="co">##       41.62171        1.97207        0.06236        0.06601 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 2. Quantiles for each variable:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  2.5%   25%   50%   75% 97.5% </span></span>
<span><span class="co">## 38.49 40.26 41.41 42.69 46.35</span></span></code></pre>
<p>and for the random effects variance, we use</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"VCOV"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt; table of extent 0 x 0 &gt;</span></span></code></pre>
<p>The random effect variance term looks more complicated because for
more complex models (with more than a single random effect term) it will
be a matrix.</p>
<p>In this example, we can see that the random effect variance is much
larger than the residual variance, suggesting that there is more
variability between the groups than within the groups.</p>
<p>Finally, we can study some trace plots and some density plots.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.(Intercept)"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"beta.Intercept"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.IQ"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"beta.IQ"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.GS"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"beta.GS"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.SES"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"beta.SES"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.COMB1"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"beta.COMB1"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"VCV.(Intercept).(Intercept)"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"RE Variance"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"sigma2"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"Residual Variance"</span>, xlab <span class="op">=</span> <span class="st">"Iteration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.(Intercept)"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for beta.Intercept"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.IQ"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for beta.IQ"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.GS"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for beta.GS"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.SES"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for beta.SES"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"beta.COMB1"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for beta.COMB1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"VCV.(Intercept).(Intercept)"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for RE Variance"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">results2</span><span class="op">$</span><span class="va">mcmc</span><span class="op">[</span>,<span class="st">"sigma2"</span><span class="op">]</span>, bw <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>         main <span class="op">=</span> <span class="st">"Posterior density for Residual Variance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="generalised-linear-mixed-models">Generalised Linear Mixed Models<a class="anchor" aria-label="anchor" href="#generalised-linear-mixed-models"></a>
</h2>
<p>Mixed effects models can also be considered within the context of
generalised linear models. In this case, the linear predictor of
observation <span class="math inline">\(i\)</span>, <span class="math inline">\(\eta_i\)</span>, can be defined as</p>
<p><span class="math display">\[
\eta_i = X_{ij}\beta +\phi_i
\]</span></p>
<p>Compared to the previous setting of linear mixed effects models, note
that now the distribution of the response could be other than Gaussian
and that observations are not necessarily nested within groups.</p>
</div>
<div class="section level2">
<h2 id="poisson-regression">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h2>
<p>In this practical we will use the North Carolina Sudden Infant Death
Syndrome (SIDS) data set. It is available in the <code>spData</code>
package and it can be loaded using:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jakubnowosad.com/spData/" class="external-link">spData</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     CNTY.ID         BIR74           SID74          NWBIR74      </span></span>
<span><span class="co">##  Min.   :1825   Min.   :  248   Min.   : 0.00   Min.   :   1.0  </span></span>
<span><span class="co">##  1st Qu.:1902   1st Qu.: 1077   1st Qu.: 2.00   1st Qu.: 190.0  </span></span>
<span><span class="co">##  Median :1982   Median : 2180   Median : 4.00   Median : 697.5  </span></span>
<span><span class="co">##  Mean   :1986   Mean   : 3300   Mean   : 6.67   Mean   :1051.0  </span></span>
<span><span class="co">##  3rd Qu.:2067   3rd Qu.: 3936   3rd Qu.: 8.25   3rd Qu.:1168.5  </span></span>
<span><span class="co">##  Max.   :2241   Max.   :21588   Max.   :44.00   Max.   :8027.0  </span></span>
<span><span class="co">##      BIR79           SID79          NWBIR79             east      </span></span>
<span><span class="co">##  Min.   :  319   Min.   : 0.00   Min.   :    3.0   Min.   : 19.0  </span></span>
<span><span class="co">##  1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5   1st Qu.:178.8  </span></span>
<span><span class="co">##  Median : 2636   Median : 5.00   Median :  874.5   Median :285.0  </span></span>
<span><span class="co">##  Mean   : 4224   Mean   : 8.36   Mean   : 1352.8   Mean   :271.3  </span></span>
<span><span class="co">##  3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8   3rd Qu.:361.2  </span></span>
<span><span class="co">##  Max.   :30757   Max.   :57.00   Max.   :11631.0   Max.   :482.0  </span></span>
<span><span class="co">##      north             x                 y             lon        </span></span>
<span><span class="co">##  Min.   :  6.0   Min.   :-328.04   Min.   :3757   Min.   :-84.08  </span></span>
<span><span class="co">##  1st Qu.: 97.0   1st Qu.: -60.55   1st Qu.:3920   1st Qu.:-81.20  </span></span>
<span><span class="co">##  Median :125.5   Median : 114.38   Median :3963   Median :-79.26  </span></span>
<span><span class="co">##  Mean   :122.1   Mean   :  91.46   Mean   :3953   Mean   :-79.51  </span></span>
<span><span class="co">##  3rd Qu.:151.5   3rd Qu.: 240.03   3rd Qu.:4000   3rd Qu.:-77.87  </span></span>
<span><span class="co">##  Max.   :182.0   Max.   : 439.65   Max.   :4060   Max.   :-75.67  </span></span>
<span><span class="co">##       lat             L.id           M.id     </span></span>
<span><span class="co">##  Min.   :33.92   Min.   :1.00   Min.   :1.00  </span></span>
<span><span class="co">##  1st Qu.:35.26   1st Qu.:1.00   1st Qu.:2.00  </span></span>
<span><span class="co">##  Median :35.68   Median :2.00   Median :3.00  </span></span>
<span><span class="co">##  Mean   :35.62   Mean   :2.12   Mean   :2.67  </span></span>
<span><span class="co">##  3rd Qu.:36.05   3rd Qu.:3.00   3rd Qu.:3.25  </span></span>
<span><span class="co">##  Max.   :36.52   Max.   :4.00   Max.   :4.00</span></span></code></pre>
<p>A full description of the data set is provided in the associated
manual page (check with <code><a href="https://jakubnowosad.com/spData/reference/nc.sids.html" class="external-link">?nc.sids</a></code>) but in this practical we
will only consider these variables:</p>
<ul>
<li><p><code>BIR74</code>, number of births (1974-78).</p></li>
<li><p><code>SID74</code>, number of SID deaths (1974-78).</p></li>
<li><p><code>NWBIR74</code>, number of non-white births
(1974-78).</p></li>
</ul>
<p>These variables are measured at the county level in North Carolina,
of which there are 100.</p>
<p>Because <code>SID74</code> records the number of SID deaths, the
model is Poisson:</p>
<p><span class="math display">\[
O_i \mid \mu_i \sim Po(\mu_i),\ i=1,\ldots, 100
\]</span> Here, <span class="math inline">\(O_i\)</span> represents the
number of cases in county <span class="math inline">\(i\)</span> and
<span class="math inline">\(\mu_i\)</span> the mean. In addition, mean
<span class="math inline">\(\mu_i\)</span> will be written as <span class="math inline">\(\mu_i = E_i \theta_i\)</span>, where <span class="math inline">\(E_i\)</span> is the <em>expected</em> number of
cases and <span class="math inline">\(\theta_i\)</span> the relative
risk in county <span class="math inline">\(i\)</span>.</p>
<p>The relative risk <span class="math inline">\(\theta_i\)</span> is
often modelled, on the log-scale, to be equal to a linear predictor:</p>
<p><span class="math display">\[
\log(\theta_i) = \beta_0 + \ldots
\]</span></p>
<p>The expected number of cases is computed by multiplying the number of
births in county <span class="math inline">\(i\)</span> to the overall
mortality rate</p>
<p><span class="math display">\[
r = \frac{\sum_{i=1}^{100}O_i}{\sum_{i=1}^{100}B_i}
\]</span> where <span class="math inline">\(B_i\)</span> represents the
total number of births in country <span class="math inline">\(i\)</span>. Hence, the expected number of cases in
county <span class="math inline">\(i\)</span> is <span class="math inline">\(E_i = r B_i\)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall mortality rate</span></span>
<span><span class="va">r74</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">SID74</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span><span class="op">)</span></span>
<span><span class="co"># Expected cases</span></span>
<span><span class="va">nc.sids</span><span class="op">$</span><span class="va">EXP74</span> <span class="op">&lt;-</span> <span class="va">r74</span> <span class="op">*</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span></span></code></pre></div>
<p>A common measure of relative risk is the <em>standardised mortality
ratio</em> (<span class="math inline">\(O_i / E_i\)</span>):</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc.sids</span><span class="op">$</span><span class="va">SMR74</span> <span class="op">&lt;-</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">SID74</span> <span class="op">/</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">EXP74</span></span></code></pre></div>
<p>A summary of the SMR can be obtained:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">SMR</span>, xlab <span class="op">=</span> <span class="st">"SMR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>Values above 1 indicate that the county has more observed deaths than
expected and that there might be an increased risk in the area.</p>
<p>As a covariate, we will compute the proportion of non-white
births:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NWPROP74</span> <span class="op">&lt;-</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">NWBIR74</span><span class="op">/</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">BIR74</span></span></code></pre></div>
<p>There is a clear relationship between the SMR and the proportion of
non-white births in a county:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NWPROP74</span>, <span class="va">nc.sids</span><span class="op">$</span><span class="va">SMR74</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">$</span><span class="va">NWPROP74</span>, <span class="va">nc.sids</span><span class="op">$</span><span class="va">SMR74</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5793901</span></span></code></pre>
<p>A simple Poisson regression can be fit by using the following
code:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">INLA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: sp</span></span></code></pre>
<pre><code><span><span class="co">## This is INLA_24.05.10 built 2024-05-10 20:05:06 UTC.</span></span>
<span><span class="co">##  - See www.r-inla.org/contact-us for how to get help.</span></span>
<span><span class="co">##  - List available models/likelihoods/etc with inla.list.models()</span></span>
<span><span class="co">##  - Use inla.doc(&lt;NAME&gt;) to access documentation</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/INLA.html" class="external-link">inla</a></span><span class="op">(</span></span>
<span>  <span class="va">SID74</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">NWPROP74</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  E <span class="op">=</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">EXP74</span>,</span>
<span>  data <span class="op">=</span> <span class="va">nc.sids</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1nc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Time used:</span></span>
<span><span class="co">##     Pre = 0.781, Running = 0.556, Post = 0.011, Total = 1.35 </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld</span></span>
<span><span class="co">## (Intercept) -0.647 0.090     -0.824   -0.647     -0.471 -0.647   0</span></span>
<span><span class="co">## NWPROP74     1.867 0.217      1.441    1.867      2.293  1.867   0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Marginal log-Likelihood:  -226.13 </span></span>
<span><span class="co">##  is computed </span></span>
<span><span class="co">## Posterior summaries for the linear predictor and the fitted values are computed</span></span>
<span><span class="co">## (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</span></span></code></pre>
<p>Random effects can also be included to account for intrinsic
differences between the counties:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Index for random effects</span></span>
<span><span class="va">nc.sids</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model WITH covariate</span></span>
<span><span class="va">m2nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/INLA.html" class="external-link">inla</a></span><span class="op">(</span></span>
<span>  <span class="va">SID74</span> <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> <span class="va">NWPROP74</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="va">ID</span>, model <span class="op">=</span> <span class="st">"iid"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  E <span class="op">=</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">EXP74</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2nc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Time used:</span></span>
<span><span class="co">##     Pre = 0.816, Running = 0.253, Post = 0.00849, Total = 1.08 </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld</span></span>
<span><span class="co">## (Intercept) -0.650 0.104     -0.857   -0.649     -0.446 -0.649   0</span></span>
<span><span class="co">## NWPROP74     1.883 0.254      1.385    1.882      2.386  1.882   0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##   Name     Model</span></span>
<span><span class="co">##     ID IID model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model hyperparameters:</span></span>
<span><span class="co">##                   mean     sd 0.025quant 0.5quant 0.975quant  mode</span></span>
<span><span class="co">## Precision for ID 84.84 132.43       9.45    28.77     261.58 15.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Marginal log-Likelihood:  -227.84 </span></span>
<span><span class="co">##  is computed </span></span>
<span><span class="co">## Posterior summaries for the linear predictor and the fitted values are computed</span></span>
<span><span class="co">## (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</span></span></code></pre>
<p>The role of the covariate can be explored by fitting a model without
it:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model WITHOUT covariate</span></span>
<span><span class="va">m3nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/INLA.html" class="external-link">inla</a></span><span class="op">(</span></span>
<span>  <span class="va">SID74</span> <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="va">ID</span>, model <span class="op">=</span> <span class="st">"iid"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  E <span class="op">=</span> <span class="va">nc.sids</span><span class="op">$</span><span class="va">EXP74</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">nc.sids</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3nc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Time used:</span></span>
<span><span class="co">##     Pre = 0.865, Running = 0.186, Post = 0.00709, Total = 1.06 </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld</span></span>
<span><span class="co">## (Intercept) -0.029 0.063     -0.156   -0.028      0.091 -0.028   0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##   Name     Model</span></span>
<span><span class="co">##     ID IID model</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model hyperparameters:</span></span>
<span><span class="co">##                  mean   sd 0.025quant 0.5quant 0.975quant mode</span></span>
<span><span class="co">## Precision for ID 7.26 2.56       3.79     6.77      13.54 6.00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Marginal log-Likelihood:  -245.53 </span></span>
<span><span class="co">##  is computed </span></span>
<span><span class="co">## Posterior summaries for the linear predictor and the fitted values are computed</span></span>
<span><span class="co">## (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</span></span></code></pre>
<p>Now, notice the decrease in the estimate of the precision of the
random effects (i.e., the variance increases). This means that values of
the random effects are now larger than in the previous case as the
random effects pick some of the effect explained by the covariate.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">m2nc</span><span class="op">$</span><span class="va">summary.random</span><span class="op">$</span><span class="va">ID</span><span class="op">$</span><span class="va">mean</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"With NWPROP74"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">m3nc</span><span class="op">$</span><span class="va">summary.random</span><span class="op">$</span><span class="va">ID</span><span class="op">$</span><span class="va">mean</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Without NWPROP74"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p7_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="further-extensions">Further Extensions<a class="anchor" aria-label="anchor" href="#further-extensions"></a>
</h2>
<p>Spatial random effects can be defined not to be independent and
identically distributed. Instead, spatial or temporal correlation can be
considered when defining them. For example, in the North Carolina SIDS
data set, it is common to consider that two counties that are neighbours
(i.e., share a boundary) will have similar relative risks. This can be
taken into account in the model but assuming that the random effects are
spatially autocorrelated. This is out of the scope of this introductory
course but feel free to ask about this!!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS5, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
