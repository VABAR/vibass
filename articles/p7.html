<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 7: Generalized linear models • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 7: Generalized linear models">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2.html">Practical 2: Inference with simulated samples</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Count data</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Normal data</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p5_solutions.html">Solutions 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Linear models</a>
    </li>
    <li>
      <a href="../articles/p6_solutions.html">Solutions 6: Linear models</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/p7_solutions.html">Solutions 7: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/p8.html">Practical 8: Bayesian hierachical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p7_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 7: Generalized linear models</h1>
                        <h4 class="author">VIBASS4</h4>
            
            <h4 class="date">July 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/master/vignettes/p7.Rmd"><code>vignettes/p7.Rmd</code></a></small>
      <div class="hidden name"><code>p7.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In the previous practical, Bayesian inference for linear models using Importance Sampling (IS) and the Metropolis-Hastings (M-H) algorithms has been introduced. In this practical you will be working with generalized linear models (GLMs) on the binomial and Poisson examples described earlier. In particular, you will be implementing the IS and M-H algorithms for Bayesian inference on GLMs. In case you need to refresh yourself on the details about IS and M-H, please check the lecture notes or Practical 5.</p>
</div>
<div id="example-binomial-beta-model" class="section level1">
<h1 class="hasAnchor">
<a href="#example-binomial-beta-model" class="anchor"></a>Example: Binomial-Beta Model</h1>
<p>This data set is described in detail in previous practicals; it concerns the recorded the number of red M&amp;M’s in a tube with <span class="math inline">\(N_i\)</span> M&amp;M’s for different tubes.</p>
<p>The model can be stated as follows:</p>
<p><span class="math display">\[
\begin{array}{rcl}
y_i &amp; \sim &amp; Bi(N_i, \theta)\\
\theta &amp; \sim &amp; Be(1, 1)
\end{array}
\]</span></p>
<p>You can use the following data set for this exercise:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>MMs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">24</span><span class="op">)</span>, red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>These data reproduce different counts of red M&amp;M’s in three different tubes, with <code>MMs</code>recording the total number of M&amp;M’s in the tube and <code>red</code> the number of red ones.</p>
<p>Please check Practical 5 in case you need to remember the details of the implementation of the IS and M-H algorithms for this particular model. Also, you can take the <code>R</code> code from Practical 5 and modify it to complete the exercise above.</p>
<div id="exercises" class="section level2">
<h2 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h2>
<div id="generalized-linear-models" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-linear-models" class="anchor"></a>Generalized linear models</h3>
<p>The current model can be expressed as a generalized linear model as follows:</p>
<p><span class="math display">\[
\begin{array}{rcl}
y_i &amp; \sim &amp; Bi(\theta, n_i)\\
\textrm{logit}(\theta) &amp; = &amp; \alpha\\
\alpha &amp; \sim &amp; N(0, \tau_{\alpha} = 0.001)
\end{array}
\]</span></p>
<p>Note that now the model parameter <span class="math inline">\(\theta\)</span> is linked to a linear predictor (<span class="math inline">\(\alpha\)</span> in this case) via the logit link function. Hence, the model parameter is now <span class="math inline">\(\alpha\)</span>.</p>
<p>This GLM can be easily fitted using IS and M-H by treating <span class="math inline">\(\alpha\)</span> as the unique model parameter.</p>
</div>
<div id="importance-sampling" class="section level3">
<h3 class="hasAnchor">
<a href="#importance-sampling" class="anchor"></a>Importance sampling</h3>
<p>In order to fit this model using the IS algorithm, values of <span class="math inline">\(\alpha\)</span> need to be sampled. Given that <span class="math inline">\(\alpha\)</span> is not bounded, we can use a Normal distribution with zero mean and precision 0.1. Alternatively, the mean of the sampling distribution can be set to a more reasonable value, close to the logit of the average proportions of red M&amp;Ms in the sample (for example, -1.5).</p>
<ul>
<li><p>Implement the IS algorithm using the two sampling distributions proposed above, i.e., a Normal with zero mean and precision 0.1 and a Normal with mean -1.5 and precision 0.1.</p></li>
<li><p>Compute the posterior mean and variance for both sets of results. Are they similar?</p></li>
<li><p>Compute and compare the effective sample sizes obtained with both sampling distributions. What do you find? Why do you think that this happens?</p></li>
</ul>
</div>
<div id="metropolis-hastings" class="section level3">
<h3 class="hasAnchor">
<a href="#metropolis-hastings" class="anchor"></a>Metropolis-Hastings</h3>
<p>Similarly, the previous GLM can be fit using the M-H algorithm. Now, values of <span class="math inline">\(\alpha\)</span> are proposed, for which a Normal distribution centered at the current value and precision 0.1 can be used. However, the precision value can be tuned if proposed values are rejected too often or not rejected at all.</p>
<ul>
<li><p>Implement the M-H algorithm for this example.</p></li>
<li><p>Compute the posterior mean and variance of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\theta\)</span>.</p></li>
<li><p>Compare these results to those obtained with the IS algorithm.</p></li>
</ul>
</div>
</div>
</div>
<div id="example-poisson-gamma-model" class="section level1">
<h1 class="hasAnchor">
<a href="#example-poisson-gamma-model" class="anchor"></a>Example: Poisson-Gamma Model</h1>
<p>The second example will be based on the <em>Game of Thrones</em> data set, which has also been described in previous practicals. Remember that this is made of the observed number of u’s on a page of a book of Game of Thrones. The model can be stated as:</p>
<p><span class="math display">\[
\begin{array}{rcl}
y_i &amp; \sim &amp; Po(\theta)\\
\theta &amp; \sim &amp; Ga(0.01, 0.01)
\end{array}
\]</span></p>
<p>We will denote the observed values by <code>y</code> in the <code>R</code> code. The data can be loaded with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Us <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">29</span>, <span class="fl">27</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">27</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">25</span>,
  <span class="fl">24</span>, <span class="fl">22</span>, <span class="fl">25</span>, <span class="fl">23</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">21</span>, <span class="fl">29</span>, <span class="fl">28</span>, <span class="fl">23</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Us</span></code></pre></div>
<p>Again, please check Practical 5 if you need to recall the details of the implementation of the IS and M-H algorithms for this particular example. You can also use the <code>R</code> code from Practical 5 to develop the following exercises.</p>
<div id="exercises-1" class="section level2">
<h2 class="hasAnchor">
<a href="#exercises-1" class="anchor"></a>Exercises</h2>
<div id="generalized-linear-models-1" class="section level3">
<h3 class="hasAnchor">
<a href="#generalized-linear-models-1" class="anchor"></a>Generalized linear models</h3>
<p>The current model can be expressed as a generalized linear model as follows:</p>
<p><span class="math display">\[
\begin{array}{rcl}
y_i &amp; \sim &amp; Po(\theta)\\
\log(\theta) &amp; = &amp; \alpha\\
\alpha &amp; \sim &amp; N(0, \tau_{\alpha} = 0.001)
\end{array}
\]</span></p>
<p>Note that now the model parameter <span class="math inline">\(\theta\)</span> is linked to a linear predictor (<span class="math inline">\(\alpha\)</span> in this case) via the logarithm link function. Hence, the model parameter is now <span class="math inline">\(\alpha\)</span>.</p>
<p>This GLM can be easily fitted using IS and M-H by treating <span class="math inline">\(\alpha\)</span> as the unique model parameter.</p>
</div>
<div id="importance-sampling-1" class="section level3">
<h3 class="hasAnchor">
<a href="#importance-sampling-1" class="anchor"></a>Importance sampling</h3>
<p>In order to fit this model using the IS algorithm, values of <span class="math inline">\(\alpha\)</span> need to be sampled. Given that <span class="math inline">\(\alpha\)</span> is not bounded, we can use a Normal distribution with zero mean and precision 0.1. Alternatively, the mean of the sampling distribution can be set to a more reasonable value, close to the logarithm of the average number of u’s in the sample (for example, 3.25).</p>
<ul>
<li><p>Implement the IS using the two sampling distributions proposed above, i.e., a Normal with zero mean and precision 0.1 and a Normal with mean 3.25 and precision 0.1.</p></li>
<li><p>Compute the posterior mean and variance for both sets of results.</p></li>
<li><p>Compute and compare the effective sample sizes obtained with both sampling distributions. What do you find? Why do you think that this happens?</p></li>
</ul>
</div>
<div id="metropolis-hastings-1" class="section level3">
<h3 class="hasAnchor">
<a href="#metropolis-hastings-1" class="anchor"></a>Metropolis-Hastings</h3>
<p>Again, the previous GLM can be fitted using the M-H algorithm. Now, values of <span class="math inline">\(\alpha\)</span> are proposed, for which a Normal distribution centered at the current value and precision 0.1 can be used. However, the precision value can be tuned if proposed values are rejected too often or not rejected at all.</p>
<ul>
<li><p>Implement the M-H algorithm for this model.</p></li>
<li><p>Compute the posterior mean and variance of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\theta\)</span>.</p></li>
<li><p>Compare the results obtained now with those obtained with the I-S algorithm.</p></li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VIBASS4, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
