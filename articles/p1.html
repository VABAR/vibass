<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 1: Binary data • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 1: Binary data">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.52</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2count.html">Practical 2: Count data</a>
    </li>
    <li>
      <a href="../articles/p2normal.html">Practical 2: Normal data</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Bayesian polynomial regression</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Simulation-based Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Software and GLMs</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Bayesian Hierarchical Modelling</a>
    </li>
    <li>
      <a href="../articles/p8.html">Practical 8: Optional Extra and Advanced Material</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 1: Binary data</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/main/vignettes/p1.Rmd" class="external-link"><code>vignettes/p1.Rmd</code></a></small>
      <div class="hidden name"><code>p1.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introducing-mms">Introducing
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s<a class="anchor" aria-label="anchor" href="#introducing-mms"></a>
</h2>
<p>According to Wikipedia:</p>
<blockquote>
<p>M&amp;M’s are multi-colored button-shaped chocolates, each of which
has the letter “m” printed in lower case in white on one side,
consisting of a candy shell surrounding a filling which varies depending
upon the variety of M&amp;M’s. The original candy has a semi-sweet
chocolate filling which, upon introduction of other variations, was
branded as the “plain, normal” variety.</p>
<p>The candy originated in the United States in 1941. They are produced
in different colors, some of which have changed over the years. The
candy-coated chocolate concept was inspired by a method used to allow
soldiers in the Spanish Civil War (1936–1939) to carry chocolate in warm
climates without it melting. A traditional milk chocolate M&amp;M weighs
about 0.91 grams and has about 4.7 calories of food energy’’.</p>
</blockquote>
<div class="figure" style="text-align: center">
<img src="mm_photo.jpg" alt="A pile of peanut M&amp;M's candies. Photo by Victor Roda."><p class="caption">
A pile of peanut M&amp;M’s candies. Photo by Victor Roda.
</p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-inference-for-the-proportion-of-red-mms">Bayesian inference for the proportion of red
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s<a class="anchor" aria-label="anchor" href="#bayesian-inference-for-the-proportion-of-red-mms"></a>
</h2>
<div class="section level3">
<h3 id="the-experiment-counting-red-mms">The experiment: Counting red
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s<a class="anchor" aria-label="anchor" href="#the-experiment-counting-red-mms"></a>
</h3>
<p>Let’s start this practical session by making inference about the
proportion of red
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s
in a very huge box. If you are following this practice in person, the
instructor will give you a bag of
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s
to make the practice more fun even if we have to be a bit flexible about
the theoretical conditions of the experiment. If you are working on line
it will be a bit more boring but we will comply better with the
theoretical conditions of the experiment.</p>
<div class="figure">
<img src="p1_files/figure-html/sampling-process-1.png" alt="Representation of the sampling experiment." width="864"><p class="caption">
Representation of the sampling experiment.
</p>
</div>
<p>For those of us who physically have the bag of
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s,
the most appropriate experiment would be to take candies out of the bag
one at a time and replace them, recording whether their colour is red or
not, until the number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
of candies defined in advance is reached. We consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>=20.</p>
<p>In case you are on line or you don’t want to carry out the experiment
physically, you can use the following result of the experiment:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, r <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-sampling-model-is-binomial">The sampling model is Binomial<a class="anchor" aria-label="anchor" href="#the-sampling-model-is-binomial"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
be the random variable that describes the number of red
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s
(successes) out of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=20</annotation></semantics></math>
sampled. Given the proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
of red candies in the bag,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is a binomial random variable with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=20</annotation></semantics></math>
and probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
associated with drawing a red candy.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∣</mo><mi>θ</mi><mo>∼</mo><mtext mathvariant="normal">Bi</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y \mid \theta \sim \mbox{Bi}(n, \theta)</annotation></semantics></math></p>
<p>whose conditional probability function, expectation and variance
are:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>r</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>n</mi><mi>r</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msup><mi>θ</mi><mi>r</mi></msup><mspace width="0.167em"></mspace><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>n</mi><mo>−</mo><mi>r</mi></mrow></msup><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>r</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">P(Y=r \mid \theta)=\binom{n}{r}\,\theta^r\, (1-\theta)^{n-r}, \,\,r=0,1,\ldots, n</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>n</mi><mspace width="0.167em"></mspace><mi>θ</mi></mrow><annotation encoding="application/x-tex">E(Y\mid \theta)=n\,\theta</annotation></semantics></math>,</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>n</mi><mspace width="0.167em"></mspace><mi>θ</mi><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Var(Y\mid \theta)=n\, \theta\, (1-\theta)</annotation></semantics></math></li>
</ul>
<div class="figure">
<img src="p1_files/figure-html/binomial-pdfs-1.png" alt="Binomial probability function for two values of $\theta$ and $n=20$ observations." width="480"><p class="caption">
Binomial probability function for two values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=20</annotation></semantics></math>
observations.
</p>
</div>
</div>
<div class="section level3">
<h3 id="a-prior-distribution-for-theta">A prior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#a-prior-distribution-for-theta"></a>
</h3>
<p>Recall that the beta distribution is conjugate with respect to the
binomial probability model. If we elicit a prior beta distribution
Be<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_0, \beta_0)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
its density is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><msup><mi>θ</mi><mrow><msub><mi>α</mi><mn>0</mn></msub><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.167em"></mspace><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mn>0</mn><mo>&lt;</mo><mi>θ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\pi(\theta \mid \alpha_0, \beta_0)=\frac{\Gamma(\alpha_0+\beta_0)}{\Gamma(\alpha_0)\,\Gamma(\beta_0)}\, \theta^{\alpha_0-1}\,(1-\theta)^{\beta_0-1}, \quad 0&lt;\theta&lt;1</annotation></semantics></math>
with expectation and variance</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}(\theta \mid \alpha_0, \beta_0)=\alpha_0 / (\alpha_0+\beta_0)</annotation></semantics></math>,</li>
<li>Var<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mspace width="0.167em"></mspace><msub><mi>β</mi><mn>0</mn></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">(\theta \mid \alpha_0, \beta_0)= \alpha_0\,\beta_0 / [(\alpha_0+\beta_0)^2\,(\alpha_0+\beta_0+1)]</annotation></semantics></math>
</li>
</ul>
<p>We will start by working with the non-informative prior distribution
Be<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>=</mo><mn>0.5</mn><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_0=0.5, \beta_0=0.5)</annotation></semantics></math>
whose prior expectation and standard deviation is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}(\theta)=0.5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.3535</mn></mrow><annotation encoding="application/x-tex">\mathbb{SD}(\theta)=0.3535</annotation></semantics></math>,
respectively. Its graphic is obtained via</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"dodgerblue"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'prior'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p1_files/figure-html/unnamed-chunk-3-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-likelihood-function-of-theta">The likelihood function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-likelihood-function-of-theta"></a>
</h3>
<p>The likelihood function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
whose expression requires the observed data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒟</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>n</mi><mo>,</mo><mi>r</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal D = \{n, r\}</annotation></semantics></math>.
It is defined as follows</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>r</mi><mo>∣</mo><mi>θ</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>n</mi><mi>r</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msup><mi>θ</mi><mi>r</mi></msup><mspace width="0.167em"></mspace><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>n</mi><mo>−</mo><mi>r</mi></mrow></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">L(\theta \mid \mathcal D) = P(Y=r \mid \theta, n) = \binom{n}{r}\, \theta^r\,(1- \theta)^{n-r},</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the <em>observed</em> number of successes in the sample (here, the
number of red candies) of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>.
In our first experiment, the likelihood function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
for the data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝒟</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><mn>4</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> red candies in </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>20</mn><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> sampled</mtext></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal D_1 = \{r_1 = 4 \text{ red candies in } n_1 = 20 \text{ sampled}\}</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><msub><mi>𝒟</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mn>20</mn><mn>4</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msup><mi>θ</mi><mn>4</mn></msup><mspace width="0.167em"></mspace><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>16</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">L(\theta \mid \mathcal D_1) = \binom{20}{4}\, \theta^4\,(1- \theta)^{16},</annotation></semantics></math></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">mm_sample</span><span class="op">$</span><span class="va">r</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">mm_sample</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="va">r</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">r</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkorange"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'likelihood'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p1_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-posterior-distribution-of-theta">The posterior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-posterior-distribution-of-theta"></a>
</h3>
<p>The posterior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is also a beta distribution with parameters</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Be</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>r</mi><mo>,</mo><mi>β</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\pi(\theta \mid \mathcal{D})= \mbox{Be}(\alpha=\alpha_0+r, \beta= \beta_0+n-r).</annotation></semantics></math></p>
<p>In our case, the posterior distribution of the proportion of red
candies is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><msub><mi>𝒟</mi><mn mathvariant="script">1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Be</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><mn>4.5</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>16.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\theta \mid \mathcal{D_1})= \mbox{Be}(\alpha=4.5, \beta= 16.5) </annotation></semantics></math>
whose graphic is</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mm_sample</span><span class="op">$</span><span class="va">r</span> <span class="op">+</span> <span class="fl">0.5</span>, <span class="va">mm_sample</span><span class="op">$</span><span class="va">n</span> <span class="op">-</span> <span class="va">mm_sample</span><span class="op">$</span><span class="va">r</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'posterior'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p1_files/figure-html/unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;">
The posterior mean and posterior standard deviation of the proportion of
red candies is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>4.5</mn><mrow><mn>4.5</mn><mo>+</mo><mn>16.5</mn></mrow></mfrac><mo>=</mo><mn>0.2143</mn><mo>,</mo><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mfrac><mrow><mn>4.5</mn><mo>⋅</mo><mn>16.5</mn></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>4.5</mn><mo>+</mo><mn>16.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>4.5</mn><mo>+</mo><mn>16.5</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt><mo>=</mo><mn>0.0875</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}(\theta \mid \mathcal D)=\frac{4.5}{4.5+16.5}=0.2143, \quad\quad \mathbb{SD}(\theta \mid \mathcal D)=\sqrt{\frac{4.5 \cdot 16.5}{(4.5+16.5)^2 \cdot (4.5+16.5+1)}}=0.0875.</annotation></semantics></math>
A
95<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>%</mi><annotation encoding="application/x-tex">\%</annotation></semantics></math>
credible interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">qbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07152005 0.40822576</span></span></code></pre></div>
<p>and the posterior probability that the proportion of red candies is
between 0.1 and 0.3 is</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7571733</span></span></code></pre></div>
<p>You can see these posterior summaries in the Figure below</p>
<div class="figure">
<img src="p1_files/figure-html/posterior-summaries-1.png" alt="Posterior summaries for $\theta$." width="480"><p class="caption">
Posterior summaries for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
</p>
</div>
</div>
<div class="section level3">
<h3 id="the-posterior-predictive-distribution-for-the-results-of-a-new-experiment">The posterior predictive distribution for the results of a new
experiment<a class="anchor" aria-label="anchor" href="#the-posterior-predictive-distribution-for-the-results-of-a-new-experiment"></a>
</h3>
<p>Recall that the posterior predictive distribution of the number of
successes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mi>′</mi></msup><annotation encoding="application/x-tex">Y^{\prime}</annotation></semantics></math>
in a new sample of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mi>′</mi></msup><annotation encoding="application/x-tex">n^{\prime}</annotation></semantics></math>
is a beta-binomial distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Bb</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mspace width="0.167em"></mspace><mi>β</mi><mo>,</mo><mspace width="0.167em"></mspace><msup><mi>n</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Bb}(\alpha,\, \beta,\, n^{\prime})</annotation></semantics></math>
with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
from the posterior distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\theta \mid \mathcal D)</annotation></semantics></math>
and the size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mi>′</mi></msup><annotation encoding="application/x-tex">n^{\prime}</annotation></semantics></math>
of the new experiment. Its probability function is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mi>′</mi></msup><mo>=</mo><msup><mi>r</mi><mi>′</mi></msup><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><msup><mi>n</mi><mi>′</mi></msup><msup><mi>r</mi><mi>′</mi></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><msup><mi>r</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>+</mo><msup><mi>n</mi><mi>′</mi></msup><mo>−</mo><msup><mi>r</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><msup><mi>n</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><msup><mi>r</mi><mi>′</mi></msup><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msup><mi>n</mi><mi>′</mi></msup></mrow><annotation encoding="application/x-tex">P(Y^{\prime} = r^{\prime} \mid \mathcal{D}) = \binom{n^\prime}{r^\prime}\, \frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha) \,\Gamma(\beta)} \,\frac{\Gamma(\alpha+r^{\prime})\,\Gamma(\beta+n^{\prime}-r^{\prime})}{\Gamma(\alpha+\beta+n^{\prime})}, \,\, r^{\prime}=0,1,\ldots, n^{\prime}</annotation></semantics></math></p>
<p>with expectation and variance,</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mi>′</mi></msup><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>n</mi><mi>′</mi></msup><mspace width="0.167em"></mspace><mfrac><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}(Y^{\prime}\mid \mathcal{D})=n^{\prime}\,\frac{\alpha}{(\alpha+\beta)},</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mi>′</mi></msup><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>n</mi><mi>′</mi></msup><mspace width="0.167em"></mspace><mfrac><mrow><mi>α</mi><mspace width="0.167em"></mspace><mi>β</mi><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><msup><mi>n</mi><mi>′</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{V}(Y^{\prime}\mid \mathcal{D})=n^{\prime}\,\frac{\alpha\,\beta\,(\alpha+\beta+n^{\prime})}{(\alpha+\beta)^{2}\,(\alpha+\beta+1)}.</annotation></semantics></math></li>
</ul>
<p>Suppose now that we are going to randomly draw
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mi>′</mi></msup><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n^{\prime}=10</annotation></semantics></math>
new
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s
from the bag. Before performing the experiment, the posterior predictive
distributions quantifies the relative plausibility of each possible
outcome. It is a beta-binomial distribution with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>4.5</mn></mrow><annotation encoding="application/x-tex">\alpha=4.5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>16.5</mn></mrow><annotation encoding="application/x-tex">\beta=16.5</annotation></semantics></math>
from the posterior distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\theta \mid \mathcal D)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mi>′</mi></msup><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n^{\prime}=10</annotation></semantics></math>,
which is the size of the new experiment.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/BetaBinom.html" class="external-link">dbbinom</a></span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="fl">10</span>, <span class="va">mm_sample</span><span class="op">$</span><span class="va">r</span> <span class="op">+</span> <span class="fl">0.5</span>, <span class="va">mm_sample</span><span class="op">$</span><span class="va">n</span> <span class="op">-</span> <span class="va">mm_sample</span><span class="op">$</span><span class="va">r</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"purple"</span>, lwd <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">'h'</span>, n <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Number of red candies"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'probability'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p1_files/figure-html/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>We observe that the most likely numbers of red candies in the new
sample are 1 and 2. The posterior mean and posterior standard deviation
of the number of red candies is this new sample is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mi>′</mi></msup><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2.14</mn><mo>,</mo><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mi>′</mi></msup><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1.54</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}(Y^{\prime} \mid \mathcal D)= 2.14, \quad\quad \mathbb{SD}(Y^{\prime} \mid \mathcal D)= 1.54.</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="time-for-individual-work">Time for individual work<a class="anchor" aria-label="anchor" href="#time-for-individual-work"></a>
</h2>
<p>We propose below an individual exercise that pursues that we can
consolidate the basic concepts that we have learned in the previous
theoretical session and that we have been practising in this session.
You can code the exercise yourself in R using the examples above, or use
<code>vibass_app(1)</code> to launch the interactive application
provided in the <code>vibass</code> R-package.</p>
<p><strong>EXERCISE</strong></p>
<p>You have two friends, Arnau and Mary, who know a little bit about
Bayesian inference and a lot about
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s.
Their opinions about the proportion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
of red candies are expressed in terms of the following prior
distributions:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Arnau’s prior distribution: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msup><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Be</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>8</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Mary’s prior distribution: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msup><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Be</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>,</mo><mn>95</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mbox{Arnau's prior distribution: } &amp; \pi^{(A)}(\theta) = \mbox{Be}(4,8) \\
\mbox{Mary's prior distribution: } &amp; \pi^{(M)}(\theta) = \mbox{Be}(5,95)
\end{align*}</annotation></semantics></math></p>
<ol style="list-style-type: decimal">
<li><p>How different are your two friends’ opinions on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>?
A good idea to answer this question would be to plot both densities and
calculate the mean and standard deviation of the subsequent prior
distributions.</p></li>
<li><p>From the results of the previous experiment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">r= 4</annotation></semantics></math>
red candies out of a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n=20</annotation></semantics></math>
sampled), compare the posterior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
that Mary and Arnau would obtain.</p></li>
<li><p>Compare both posterior distributions with the one we have
obtained in Subsection 2.5 of the practical through their density
curves, posterior means, standard deviations and 95% credibility
intervals.</p></li>
<li><p>Compute the posterior predictive distribution for the new
experiment described in Subsection 2.6 (to randomly draw
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mi>′</mi></msup><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n^{\prime}=10</annotation></semantics></math>
new
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>&amp;</mi><annotation encoding="application/x-tex">\&amp;</annotation></semantics></math>M’s
from the bag) and compare both posterior predictive distributions with
the one we have obtained in Subsection 2.6 of the practical through
their density curves, posterior means and standard deviations.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS7, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
