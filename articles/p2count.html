<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 2: Count data • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 2: Count data">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.47</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2count.html">Practical 2: Count data</a>
    </li>
    <li>
      <a href="../articles/p2normal.html">Practical 2: Normal data</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Bayesian polynomial regression</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Simulation-based Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Software and GLMs</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Bayesian Hierarchical Modelling</a>
    </li>
    <li>
      <a href="../articles/p8.html">Practical 8: Optional Extra and Advanced Material</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 2: Count data</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/main/vignettes/p2count.Rmd" class="external-link"><code>vignettes/p2count.Rmd</code></a></small>
      <div class="hidden name"><code>p2count.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>According to Wikipedia:</p>
<blockquote>
<p><em>A Game of Thrones</em> is the first novel in <em>A Song of Ice
and Fire</em>, a series of fantasy novels by the American author George
R. R. Martin. In the novel, recounting events from various points of
view, Martin introduces the plot-lines of the noble houses of Westeros,
the Wall, and the Targaryens. The novel has inspired several spin-off
works, including several games. It is also the namesake and basis for
the first season of the television series <em>Game of Thrones</em>.</p>
</blockquote>
<p>If you want to get a bit of atmosphere, you can see a trailer of the
series <a href="https://www.youtube.com/watch?v=KPLWWIOCOOQ" class="external-link">here</a>
and if you want the music of this series to accompany you throughout the
practice you can go <a href="https://www.youtube.com/watch?v=Hf9u3jPvkkI" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="bayesian-inference-for-the-expected-number-of-us-in-a-page-of-a-game-of-thrones">Bayesian inference for the expected number of <em>u</em>’s in a page
of <em>A Game of Thrones</em><a class="anchor" aria-label="anchor" href="#bayesian-inference-for-the-expected-number-of-us-in-a-page-of-a-game-of-thrones"></a>
</h2>
<div class="section level3">
<h3 id="the-experiment-number-of-us-in-a-page-of-a-game-of-thrones">The experiment: Number of <em>u</em>’s in a page of <em>A Game of
Thrones</em><a class="anchor" aria-label="anchor" href="#the-experiment-number-of-us-in-a-page-of-a-game-of-thrones"></a>
</h3>
<p>In this practice we need to have imagination, possibly not as much as
George R. R. Martin but a little. We have an English edition of the
first novel, <em>A Game of Thrones</em>, and we are interested in
learning about the mean number of letters <em>u</em> we can find on a
page of this book. We select pages of the book at random and count the
number of <em>u</em>’s on each page. The random sampling is <em>with
replacement</em> in the sense that the same page could be selected more
than once. If we each had the book we could physically conduct the
experiment. But as this is not the case, we can use the following
data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">udata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Us <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">29</span>, <span class="fl">27</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">27</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">25</span>, <span class="fl">24</span>, <span class="fl">22</span>, </span>
<span><span class="fl">25</span>, <span class="fl">23</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">21</span>, <span class="fl">29</span>, <span class="fl">28</span>, <span class="fl">23</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>that we have obtained as a consequence of carrying out an experiment
consisting of randomly selecting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">n=25</annotation></semantics></math>
pages of the book and counting the number of <em>u</em>’s in each one of
them.</p>
<p>We can summarize the results obtained by means of a table of
frequencies and its graphical representation</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">table.udata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">udata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Us</span></span>
<span><span class="co">#&gt; 21 22 23 24 25 26 27 28 29 </span></span>
<span><span class="co">#&gt;  1  2  4  1  4  1  4  4  4</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">table.udata</span>, col<span class="op">=</span><span class="st">"gray89"</span>, xlab<span class="op">=</span><span class="st">"Number of letters u in a page"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-sampling-model-is-approximately-poisson">The sampling model is approximately Poisson<a class="anchor" aria-label="anchor" href="#the-sampling-model-is-approximately-poisson"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
the random variable that describes the number of <em>u</em>’s in a page
of the novel <em>A Game of Thrones</em>. We consider in this practice
that, given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
the distribution of the number of <em>u</em>’s is Poisson with rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∣</mo><mi>λ</mi><mo>∼</mo><mtext mathvariant="normal">Po</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">Y \mid \lambda \sim \text{Po}(\lambda),</annotation></semantics></math></p>
<p>whose conditional probability function, expectation and variance
are:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>y</mi><mo>∣</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>λ</mi><mi>y</mi></msup><mspace width="0.167em"></mspace><msup><mi>e</mi><mrow><mo>−</mo><mi>λ</mi></mrow></msup></mrow><mrow><mi>y</mi><mi>!</mi></mrow></mfrac><mo>,</mo><mspace width="0.278em"></mspace><mi>y</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>…</mi></mrow><annotation encoding="application/x-tex">P(Y=y \mid \lambda)= \frac{\lambda^y\, e^{-\lambda}}{y!}, \;y=0,1,\ldots</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}(Y\mid \lambda) = \lambda</annotation></semantics></math>,</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>λ</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{V}(Y\mid \lambda) = \lambda.</annotation></semantics></math></li>
</ul>
<p>We know that this distribution is not exactly Poisson because the
number of <em>u</em>’s that can possibly be printed in a page is
necessarily limited, while the potential values of a Poisson variable
are not bounded. Nevertheless, the Poisson distribution can be a useful
model in practice.</p>
</div>
<div class="section level3">
<h3 id="a-prior-distribution-for-lambda">A prior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#a-prior-distribution-for-lambda"></a>
</h3>
<p>Recall that the gamma distribution is conjugate with respect to the
Poisson probability model. If we elicit a prior gamma distribution
Ga<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\alpha_0, \beta_0)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
its density is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>β</mi><mn>0</mn><msub><mi>α</mi><mn>0</mn></msub></msubsup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><msup><mi>λ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mspace width="0.167em"></mspace><msup><mi>e</mi><mrow><mo>−</mo><mi>λ</mi><mspace width="0.167em"></mspace><msub><mi>β</mi><mn>0</mn></msub></mrow></msup><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\pi(\lambda \mid \alpha_0, \beta_0)=\frac{ \beta_0^{\alpha_0}}{\Gamma(\alpha_0) }\, \lambda^{(\alpha_0-1)}\, e^{-\lambda\,\beta_0}, \,\, \lambda&gt;0</annotation></semantics></math>
with expectation and variance</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mi>/</mi><msub><mi>β</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{E}(\lambda \mid \alpha_0, \beta_0)=\alpha_0 / \beta_0</annotation></semantics></math>,</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><msub><mi>α</mi><mn>0</mn></msub><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mi>/</mi><msubsup><mi>β</mi><mn>0</mn><mn>2</mn></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbb{V}(\lambda \mid \alpha_0, \beta_0)= \alpha_0 / \beta_0^2.</annotation></semantics></math></li>
</ul>
<p>We are going to work with two different prior distributions to learn
a bit more about this Bayesian inferential process. We will work with a
<em>non-informative</em> prior distribution (Prior 1) and with the prior
distribution (Prior 2) provided by a friend of ours, Joan, who has read
all books by George R. R. Martin.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Prior 1: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><msup><mi>λ</mi><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Joan, Prior 2: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>=</mo><mn>105.8</mn><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mn>4.6</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Prior 1: }&amp; \pi_1(\lambda) \propto\lambda^{-1/2}\\
\text{Joan, Prior 2: }&amp; \pi_2(\lambda)=\text{Ga}(\alpha_0=105.8, \beta_0=4.6).
\end{align*}</annotation></semantics></math></p>
<p>The non-informative prior distribution is intended to be a neutral
distribution that leaves the data in the spotlight. Let’s try to
understand which views are expressed in Joan’s prior distribution. To do
so, we calculate the mean and standard deviation and graphically
represent his prior.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span>, </span>
<span>  col<span class="op">=</span><span class="st">"dodgerblue"</span>, lwd<span class="op">=</span><span class="fl">4</span>,</span>
<span>  xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected number of u's in a page "</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'Prior 2 (Joan)'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>According to Joan, the prior expectation and standard deviation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>105.8</mn><mi>/</mi><mn>4.6</mn><mo>=</mo><mn>23</mn><mo>,</mo><mspace width="1.0em"></mspace><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mn>105.8</mn><mi>/</mi><msup><mn>4.6</mn><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mn>2.236</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}(\lambda)=105.8/4.6= 23, \quad \mathbb{SD}(\lambda)= \sqrt{105.8/4.6^2}=2.236</annotation></semantics></math>
and the prior probability that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is less than 20, 23, 25, 30 and 35 is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span>nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">23</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;    20    23    25    30    35 </span></span>
<span><span class="co">#&gt; 0.085 0.513 0.816 0.998 1.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-likelihood-function-of-lambda">The likelihood function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-likelihood-function-of-lambda"></a>
</h3>
<p>The likelihood of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
whose expression requires the observed data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒟</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>n</mi><mo>,</mo><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathcal D=\{n, \sum y_i\}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum y_i</annotation></semantics></math>
is the total number of <em>u</em>’s observed in the <em>n</em> sampled
pages. It is defined as follows</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>∣</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∣</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>λ</mi><mrow><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msup><mspace width="0.167em"></mspace><msup><mi>e</mi><mrow><mo>−</mo><mi>n</mi><mi>λ</mi></mrow></msup></mrow><mrow><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mspace width="0.167em"></mspace><msub><mi>y</mi><mi>i</mi></msub><mi>!</mi></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
L(\lambda \mid \mathcal D)=&amp; P(Y_1=y_1, Y_2=y_2, \ldots, Y_n=y_n \mid \lambda)\\
=&amp; \prod_{i=1}^{n}\, P(Y_i=y_i \mid \lambda) = \frac{\lambda^{\sum y_i}\, e^{-n \lambda}}{\prod_{i=1}^{n}\, y_i!}
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
represents the random Poisson variable that describes the number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
of <em>u</em>’s in the page
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
Note that the denominator is a scaling factor independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
that we can ignore, since we are only interested in the
<em>relative</em> likelihood of each possible value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
The rest of the expression, only depends on the total sum of observed
values, and the number of pages examined.</p>
<p>In our case, we have sampled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">n=25</annotation></semantics></math>
pages and have registered
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>643</mn></mrow><annotation encoding="application/x-tex">\sum y_i= 643</annotation></semantics></math><em>u</em>’s, and consequently, the likelihood function is (up to the
scaling factor)</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo></mtd><mtd columnalign="left" style="text-align: left"><msup><mi>λ</mi><mn>643</mn></msup><mspace width="0.167em"></mspace><msup><mi>e</mi><mrow><mo>−</mo><mn>25</mn><mspace width="0.167em"></mspace><mi>λ</mi></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
L(\lambda \mid \mathcal D)\propto &amp; \lambda^{643}\, e^{-25\, \lambda}
\end{align*}</annotation></semantics></math></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">udata</span><span class="op">$</span><span class="va">Us</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">udata</span><span class="op">)</span></span>
<span><span class="va">scale_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="va">udata</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">sum_y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="va">n</span> <span class="op">*</span> <span class="va">x</span> <span class="op">-</span> <span class="va">scale_y</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkorange"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected number of u's in a page "</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'likelihood'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-posterior-distribution-of-lambda">The posterior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-posterior-distribution-of-lambda"></a>
</h3>
<p>The posterior distributions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for priors 1 and 2 are also gamma distributions with parameters</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Posterior 1: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><mn>643</mn><mo>+</mo><mn>0.5</mn><mo>=</mo><mn>643.5</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>25</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Posterior 2: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><mn>643</mn><mo>+</mo><mn>105.8</mn><mo>=</mo><mn>748.8</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>25</mn><mo>+</mo><mn>4.6</mn><mo>=</mo><mn>29.6</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Posterior 1: }&amp; \pi_1(\lambda \mid \mathcal D) =\text{Ga}(\alpha = 643+0.5= 643.5 , \beta =25 )\\
\text{Posterior 2: }&amp; \pi_2(\lambda \mid \mathcal D)=\text{Ga}(\alpha = 643+105.8=748.8, \beta =25+4.6=29.6 )
\end{align*}</annotation></semantics></math></p>
<p>Next, we plot on the same graph the informative prior distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>0</mn></msub><mo>=</mo><mn>105.8</mn><mo>,</mo><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mn>4.6</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Ga}(\alpha_0=105.8, \beta_0=4.6)</annotation></semantics></math>
from Joan (in blue) and the two posterior distributions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><mn>643.5</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>25</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_1(\lambda \mid \mathcal D) =\text{Ga}(\alpha = 643.5, \beta =25 )</annotation></semantics></math>
in dark green and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>=</mo><mn>748.8</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>29.6</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_2(\lambda \mid \mathcal D)=\text{Ga}(\alpha = 748.8, \beta =29.6)</annotation></semantics></math>
in light green.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected number of u's in a page "</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'prior and posteriors'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"green3"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"dodgerblue"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-7-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Interestingly, the two posterior distributions are quite similar
despite the fact that the informative prior distribution is compatible
with smaller lambda values than indicated by the data. The posterior
mean and standard deviation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
according to each posterior distribution are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Posterior 1: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>643.5</mn><mo>,</mo><mn>25</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>25.74</mn><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1.01</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Posterior 2: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>748.8</mn><mo>,</mo><mn>29.6</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>25.3</mn><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mrow><mi>𝕊</mi><mi>𝔻</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.92</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Posterior 1: }&amp; \pi_1(\lambda \mid \mathcal D) =\text{Ga}(643.5, 25), \,\,\mathbb{E} (\lambda \mid \mathcal D)=25.74, \,\,\mathbb{SD}(\lambda \mid \mathcal D)= 1.01\\
\text{Posterior 2: }&amp; \pi_2(\lambda \mid \mathcal D)=\text{Ga}(748.8, 29.6 ), \,\,\mathbb{E} (\lambda \mid \mathcal D)= 25.3, \,\,\mathbb{SD}(\lambda \mid \mathcal D)=0.92
\end{align*}</annotation></semantics></math></p>
<p>95<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>%</mi><annotation encoding="application/x-tex">\%</annotation></semantics></math>
credible intervals for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
according to posteriors 1 and 2 are</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span>nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.025 0.975 </span></span>
<span><span class="co">#&gt;  23.8  27.8</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span>nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.025 0.975 </span></span>
<span><span class="co">#&gt;  23.5  27.1</span></span></code></pre></div>
<p>and the subsequent posterior probabilities that the mean number of
letters <em>u</em>’s in a page of <em>A Game of Thrones</em> is between
24 and 26 letters are</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.851</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.887</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-posterior-predictive-distribution-for-the-number-of-us-in-a-new-page-of-a-game-of-thrones">The posterior predictive distribution for the number of <em>u</em>’s
in a new page of <em>A Game of Thrones</em><a class="anchor" aria-label="anchor" href="#the-posterior-predictive-distribution-for-the-number-of-us-in-a-new-page-of-a-game-of-thrones"></a>
</h3>
<p>Remember that the posterior predictive distribution for the result of
a new observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">Y_{n+1}</annotation></semantics></math>
is a Gamma-Poisson distribution
GaPo<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\alpha, \beta, 1)</annotation></semantics></math>
with probability distribution
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>r</mi><mo>∣</mo><mi>𝒟</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mfrac><msup><mi>β</mi><mi>α</mi></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>r</mi><mi>!</mi></mrow></mfrac><mspace width="0.167em"></mspace><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mfrac><mo>,</mo><mspace width="0.167em"></mspace><mi>r</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
P(Y_{n+1}&amp;=r \mid \mathcal D) = \frac{\beta^{\alpha}}{\Gamma(\alpha)}\, \frac{\Gamma(r+\alpha)}{r!}\,\frac{1}{(\beta+1)^{(r+\alpha)}}, \,r=0,1,2,\ldots, \nonumber \\
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mi>/</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}(Y_{n+1}\mid \mathcal D) = \alpha/\beta</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>α</mi><mi>β</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi>/</mi><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{V}(Y_{n+1} \mid \mathcal D) = \frac{\alpha}{\beta} (1 + 1/\beta)</annotation></semantics></math>.</p>
<p>Suppose now that we randomly select a new page (page 26th) in the
novel and want to predict the number of letters <em>u</em> we will find
in it. The subsequent posterior predictive distribution is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">GaPo</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>643.5</mn><mo>,</mo><mspace width="0.167em"></mspace><mn>25</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{GaPo}(643.5,\, 25, 1)</annotation></semantics></math>
if we work in the framework of the posterior 1 or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">GaPo</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>748.8</mn><mo>,</mo><mspace width="0.167em"></mspace><mn>29.6</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{GaPo}(748.8,\, 29.6, 1)</annotation></semantics></math>
if we work in the framework of the posterior 2. Now we represent both
predictive distributions</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/GammaPoiss.html" class="external-link">dgpois</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/GammaPoiss.html" class="external-link">dgpois</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, <span class="va">pred1</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"h"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"purple"</span>, </span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"number of letters u in a new page"</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"probability"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-10-1.png" width="55%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>, <span class="va">pred2</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"h"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"number of u's in a new page"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"probability"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-10-2.png" width="55%" style="display: block; margin: auto;">
The graphs of both distributions are visually almost identical. The
means and standard deviations are</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Predictive 1: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">GaPo</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>643.5</mn><mo>,</mo><mn>25</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>26</mn></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>25.74</mn><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>26</mn></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>5.17</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Predictive 2: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">GaPo</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>748.8</mn><mo>,</mo><mn>29.6</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>26</mn></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>25.30</mn><mo>,</mo><mo>,</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>26</mn></msub><mo>∣</mo><mi>𝒟</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>5.11</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Predictive 1: }&amp; \text{GaPo}(643.5, 25, 1 ), \,\, \mathbb{E}(Y_{26} \mid \mathcal D)=25.74, \,\,SD(Y_{26} \mid \mathcal{D})=5.17\\
\text{Predictive 2: }&amp; \text{GaPo}(748.8, 29.6, 1), \,\, \mathbb{E}(Y_{26} \mid \mathcal D)=25.30, , \,\,SD(Y_{26} \mid \mathcal{D})=5.11
\end{align*}</annotation></semantics></math></p>
<p>It is important to note the large variability associated with the
prediction process relative to the estimation process. This
characteristic of the estimation and prediction processes is general to
all inferential processes and statistical methodologies.</p>
</div>
</div>
<div class="section level2">
<h2 id="time-to-individual-work">Time to individual work<a class="anchor" aria-label="anchor" href="#time-to-individual-work"></a>
</h2>
<p>We propose below an individual exercise that pursues to consolidate
the basic concepts that we have learned in the previous theoretical
session and that we have been practising in this session.</p>
<p><strong>Exercice</strong></p>
<p>You just remembered that you have another friend, Tauriel, who is
also very enthusiastic of the novel <em>A Game of Thrones</em> and you
have thought to ask her opinion about the number of <em>u</em>’s in the
novel. Her prior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is very different from that of your other friend Joan. It is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>90</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Ga}(90, 3)</annotation></semantics></math>
and we will call it prior 3.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mtext mathvariant="normal">Tauriel, Prior 3: </mtext><mspace width="0.333em"></mspace></mrow></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>π</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Ga</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>90</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{Tauriel, Prior 3: } &amp; \pi_3(\lambda) = \text{Ga}(90,3) 
\end{align*}</annotation></semantics></math></p>
<ol style="list-style-type: decimal">
<li><p>How different are your two friends’ opinions on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>?
A good idea to answer this question would be to plot both densities and
calculate the mean, standard deviation and some relevant probabilities
from the subsequent prior distributions.</p></li>
<li><p>From the results of the previous experiment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>643</mn></mrow><annotation encoding="application/x-tex">\sum y_i= 643</annotation></semantics></math><em>u</em>’s in a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">n=25</annotation></semantics></math>),
compare the posterior distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
that Joan and Tauriel would obtain.</p></li>
<li><p>Joan and Taurel select
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mi>′</mi></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n^{\prime}=1</annotation></semantics></math>
new page from the novel. Before they start counting the <em>u</em>’s on
the page, they ask you to calculate the predicted distribution of each
of them over the number of <em>u</em>’s they will find on this page. Can
you compute them? And since they are asking you to do some work, you
could also represent them graphically and describe them
numerically.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS7, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
