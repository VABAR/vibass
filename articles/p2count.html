<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 2: Count data • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 2: Count data">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.35</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2count.html">Practical 2: Count data</a>
    </li>
    <li>
      <a href="../articles/p2normal.html">Practical 2: Normal data</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Bayesian linear regression</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Simualtion-based Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Software and GLMs</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Bayesian Hierarchical Modelling</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 2: Count data</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
            <h4 data-toc-skip class="date">July 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/HEAD/vignettes/p2count.Rmd" class="external-link"><code>vignettes/p2count.Rmd</code></a></small>
      <div class="hidden name"><code>p2count.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>According to Wikipedia:</p>
<blockquote>
<p><em>A Game of Thrones</em> is the first novel in <em>A Song of Ice
and Fire</em>, a series of fantasy novels by the American author George
R. R. Martin. In the novel, recounting events from various points of
view, Martin introduces the plot-lines of the noble houses of Westeros,
the Wall, and the Targaryens. The novel has inspired several spin-off
works, including several games. It is also the namesake and basis for
the first season of the television series <em>Game of Thrones</em>.</p>
</blockquote>
<p>If you want to get a bit of atmosphere, you can see a trailer of the
series <a href="https://www.youtube.com/watch?v=KPLWWIOCOOQ" class="external-link">here</a>
and if you want the music of this series to accompany you throughout the
practice you can go <a href="https://www.youtube.com/watch?v=Hf9u3jPvkkI" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="bayesian-inference-for-the-mean-of-the-number-of-us-in-a-page-of-a-game-of-thrones">Bayesian inference for the mean of the number of u’s in a page of
<em>A Game of Thrones</em><a class="anchor" aria-label="anchor" href="#bayesian-inference-for-the-mean-of-the-number-of-us-in-a-page-of-a-game-of-thrones"></a>
</h2>
<div class="section level3">
<h3 id="the-experiment-number-of-us-in-a-page-of-a-game-of-thrones">The experiment: Number of u’s in a page of <em>A Game of
Thrones</em><a class="anchor" aria-label="anchor" href="#the-experiment-number-of-us-in-a-page-of-a-game-of-thrones"></a>
</h3>
<p>In this practice we need to have imagination, possibly not as much as
George R. R. Martin but a little. We have an English edition of the
first novel, <em>A Game of Thrones</em>, and we are interested in
learning about the mean number of letters u we can find on a page of
this book. We select pages of the book at random and count the number of
u’s on each page. The random sampling is ``with replacement’’ in the
sense that the same page could be selected more than once. If we each
had the book we could physically conduct the experiment. But as this is
not the case, we can use the following data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">udata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Us <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">29</span>, <span class="fl">27</span>, <span class="fl">27</span>, <span class="fl">25</span>, <span class="fl">27</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">25</span>, <span class="fl">24</span>, <span class="fl">22</span>, </span>
<span><span class="fl">25</span>, <span class="fl">23</span>, <span class="fl">29</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">21</span>, <span class="fl">29</span>, <span class="fl">28</span>, <span class="fl">23</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>that we have obtained as a consequence of carrying out an experiment
consisting of randomly selecting <span class="math inline">\(n=25\)</span> pages of the book and counting the
number of u’s in each one of them.</p>
<p>We can summarize the results obtained by means of a table of
frequencies and its graphical representation</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table.udata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">udata</span><span class="op">)</span></span>
<span><span class="va">table.udata</span></span>
<span><span class="co">#&gt; Us</span></span>
<span><span class="co">#&gt; 21 22 23 24 25 26 27 28 29 </span></span>
<span><span class="co">#&gt;  1  2  4  1  4  1  4  4  4</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">table.udata</span>, col<span class="op">=</span><span class="st">"gray89"</span>, xlab<span class="op">=</span><span class="st">"Number of letters u in a page"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-sampling-model-is-approximately-poisson">The sampling model is approximately Poisson<a class="anchor" aria-label="anchor" href="#the-sampling-model-is-approximately-poisson"></a>
</h3>
<p>let <span class="math inline">\(Y\)</span> the random variable that
describes the number of u’s in a page of the novel <em>A Game of
Thrones</em>. We consider in this practice that, given <span class="math inline">\(\lambda\)</span>, the distribution of the number
of u’s is Poisson with parameter <span class="math inline">\(\lambda\)</span></p>
<p><span class="math display">\[Y \mid \lambda \sim
\text{Po}(\lambda),\]</span></p>
<p>whose conditional probability function, expectation and variance
is:</p>
<ul>
<li><span class="math inline">\(P(Y=y \mid \lambda)= \frac{\lambda^y\,
e^{-\lambda}}{y!}, \;y=0,1,\ldots\)</span></li>
<li>
<span class="math inline">\(\mathbb{E}(Y\mid \lambda) =
\lambda\)</span>,</li>
<li><span class="math inline">\(\mathbb{V}(Y\mid \lambda) =
\lambda.\)</span></li>
</ul>
<p>We know that this distribution is not exactly Poisson because the
number of u’s on a page is finite and the Poisson distribution has no
limit to the possible values of the variable.</p>
</div>
<div class="section level3">
<h3 id="a-prior-distribution-for-lambda">A prior distribution for <span class="math inline">\(\lambda\)</span><a class="anchor" aria-label="anchor" href="#a-prior-distribution-for-lambda"></a>
</h3>
<p>Recall that the gamma distribution is conjugate with respect to the
Poisson probability model. If we elicit a prior gamma distribution
Ga<span class="math inline">\((\alpha_0, \beta_0)\)</span> for <span class="math inline">\(\lambda\)</span>, its density is</p>
<p><span class="math display">\[\pi(\lambda)=\frac{
\beta_0^{\alpha_0}}{\Gamma(\alpha_0) }\, \lambda^{(\alpha_0-1)}\,
e^{-\lambda\,\beta_0}, \,\, \lambda&gt;0\]</span> with expectation and
variance</p>
<ul>
<li>
<span class="math inline">\(\mathbb{E}(\lambda)=\alpha_0 /
\beta_0\)</span>,</li>
<li><span class="math inline">\(\mathbb{V}(\lambda)= \alpha_0 /
\beta_0^2.\)</span></li>
</ul>
<p>We are going to work with two different prior distributions to learn
a bit more about this Bayesian inferential process. We will work with a
non-informative prior distribution (Prior 1) and with the prior
distribution (Prior 2) provided by a friend of ours, Joan, who has read
all of George R. R. Martin’s books.</p>
<p><span class="math display">\[\begin{align*}
\text{Prior 1: }&amp; \pi_1(\lambda) \propto\lambda^{-1/2}\\
\text{Joan, Prior 2: }&amp; \pi_2(\lambda)=\text{Ga}(\alpha_0=105.8,
\beta_0=4.6).
\end{align*}\]</span></p>
<p>The non-informative prior distribution is intended to be a neutral
distribution that leaves the data in the spotlight. Let’s try to
understand what Joan’s views are that he has expressed through his prior
distribution. To do so, we calculate the mean and standard deviation and
graphically represent this prior.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">prior2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">prior2</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"dodgerblue"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>According to Joan, the prior expectation and variance of <span class="math inline">\(\lambda\)</span> is <span class="math display">\[\mathbb{E}(\lambda)=105.8/4.6= 23,
\,\,\mathbb{SD}{(\lambda)}= \sqrt(105.8/4.6^2)=2.236 \,\,\text{letters
u}\]</span> and the prior probability that <span class="math inline">\(\lambda\)</span> is less than 20, 23, 25, 30 and
35 is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">23</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">35</span><span class="op">)</span>, <span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0850197 0.5129291 0.8164524 0.9980814 0.9999985</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-likelihood-function-of-lambda">The likelihood function of <span class="math inline">\(\lambda\)</span><a class="anchor" aria-label="anchor" href="#the-likelihood-function-of-lambda"></a>
</h3>
<p>The likelihood of <span class="math inline">\(\lambda\)</span> is a
function of <span class="math inline">\(\lambda\)</span> whose
construction needs the data <span class="math inline">\(\mathcal D=\{n,
\sum y_i\}\)</span>, where <span class="math inline">\(\sum y_i\)</span>
is the sum of the data. It is defined as follows</p>
<p><span class="math display">\[\begin{align*}
L(\lambda \mid \mathcal D)=&amp; P(Y_1=y_1, Y_2=y_2, \ldots, Y_n=y_n
\mid \lambda)\\
=&amp; \prod_{i=1}^{n}\, P(Y_i=y_i \mid \lambda) = \frac{\lambda^{\sum
y_i}\, e^{-n \lambda}}{\prod_{i=1}^{n}\, y_i!}
\end{align*}\]</span> where <span class="math inline">\(Y_i\)</span>
represents the random Poisson variable that describes the number of u’s
in the page <span class="math inline">\(i\)</span> and <span class="math inline">\(y_i\)</span> is observed value. In our case, we
have sampled <span class="math inline">\(n=25\)</span> pages and have
registered <span class="math inline">\(\sum y_i= 643\)</span> u’s, and
consequently, the likelihood function is</p>
<p><span class="math display">\[\begin{align*}
L(\lambda \mid \mathcal D)\propto &amp; \lambda^{643}\, e^{-25\,
\lambda}
\end{align*}\]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">like</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">643</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">-</span><span class="fl">25</span><span class="op">*</span><span class="va">lambda</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="va">udata</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">like</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"darkorange"</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"likelihood"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="the-posterior-distribution-of-lambda">The posterior distribution of <span class="math inline">\(\lambda\)</span><a class="anchor" aria-label="anchor" href="#the-posterior-distribution-of-lambda"></a>
</h3>
<p>The posterior distribution of <span class="math inline">\(\lambda\)</span> for both priors 1 and 2 is a
gamma distribution with parameters</p>
<p><span class="math display">\[\begin{align*}
\text{Posterior 1: }&amp; \pi_1(\lambda \mid \mathcal D)
=\text{Ga}(\alpha = 643+0.5= 643.5 , \beta =25 )\\
\text{Posterior 2: }&amp; \pi_2(\lambda \mid \mathcal
D)=\text{Ga}(\alpha = 643+105.8=748.8, \beta =25+4.6=29.6 )
\end{align*}\]</span></p>
<p>Next, we plot on the same graph the informative prior distribution
<span class="math inline">\(\text{Ga}(\alpha_0=105.8,
\beta_0=4.6)\)</span> from Joan (in blue) and the two posterior
distributions, <span class="math inline">\(\pi_1(\lambda \mid \mathcal
D) =\text{Ga}(\alpha = 643.5, \beta =25 )\)</span> in dark green and
<span class="math inline">\(\pi_2(\lambda \mid \mathcal
D)=\text{Ga}(\alpha = 748.8, \beta =29.6)\)</span> in light green.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span>,<span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">posterior1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">posterior1</span>, col<span class="op">=</span><span class="st">"green3"</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"prior and posteriors"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">posterior2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">posterior2</span>, col<span class="op">=</span><span class="st">"darkgreen"</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">prior2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="fl">105.8</span>, <span class="fl">4.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">prior2</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"dodgerblue"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-7-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Interestingly, the two posterior distributions are quite similar
despite the fact that the informative prior distribution is compatible
with smaller lambda values than indicated by the data. The posterior
mean and standard deviation of <span class="math inline">\(\lambda\)</span> according to each posterior
distributions is <span class="math display">\[\begin{align*}
\text{Posterior 1: }&amp; \pi_1(\lambda \mid \mathcal D)
=\text{Ga}(643.5, 25 ), \,\,\mathbb{E} (\lambda \mid \mathcal D)=25.74,
\,\,\mathbb{SD}(\lambda \mid \mathcal D)=1.0147 \text{ letters u} \\
\text{Posterior 2: }&amp; \pi_2(\lambda \mid \mathcal
D)=\text{Ga}(748.8, 29.6 ), \,\,\mathbb{E} (\lambda \mid \mathcal
D)=25.30, \,\,\mathbb{SD}(\lambda \mid \mathcal D)=0.9245 \text{ letters
u}
\end{align*}\]</span></p>
<p>A 95<span class="math inline">\(\%\)</span> credible interval for
<span class="math inline">\(\lambda\)</span> according to posteriors 1
and 2 is</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 23.78939 27.76637</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 23.51758 27.14100</span></span></code></pre></div>
<p>and the subsequent posterior probability that the mean of the number
of letters u’s in a page of <em>A Game of Thrones</em> is between 24 and
26 letters is</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8508419</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">pgamma</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 0.8867553</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-posterior-predictive-distribution-for-the-number-of-us-in-a-new-page-of-a-game-of-thrones">The posterior predictive distribution for the number of u’s in a new
page of <em>A Game of Thrones</em><a class="anchor" aria-label="anchor" href="#the-posterior-predictive-distribution-for-the-number-of-us-in-a-new-page-of-a-game-of-thrones"></a>
</h3>
<p>Remember that the posterior predictive distribution for the result of
a new observation <span class="math inline">\(Y_{n+1}\)</span> is a
Gamma-Poisson distribution GaPo<span class="math inline">\((\alpha,
\beta, 1)\)</span> with probability distribution <span class="math display">\[\begin{align*}
P(Y_{n+1}&amp;=r \mid \mathcal D) =
\frac{\beta^{\alpha}}{\Gamma(\alpha)}\,
\frac{\Gamma(r+\alpha)}{r!}\,\frac{1}{(\beta+1)^{(r+\alpha)}},
\,r=0,1,2,\ldots, \nonumber \\
\end{align*}\]</span> where <span class="math inline">\(\mathbb{E}(Y_{n+1}\mid \mathcal D) =
\alpha/\beta\)</span> and <span class="math inline">\(\mathbb{V}(Y_{n+1}
\mid \mathcal D) = \frac{\alpha}{\beta} (1+(1/\beta))\)</span>.</p>
<p>Suppose now that we randomly select a new page (page 26th) in the
novel and want to predict the number of letters u we will find in it.
The subsequent posterior predictive distribution is <span class="math inline">\(\text{GaPo}(643.5,\, 25, 1)\)</span> if we work in
the framework of the posterior 1 or <span class="math inline">\(\text{GaPo}(748.8,\, 29.6, 1)\)</span> if we work
in the framework of the posterior 2. Now we represent both predictive
distributions</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">pred1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/GammaPoiss.html" class="external-link">dgpois</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">643.5</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">pred1</span>,type<span class="op">=</span><span class="st">"h"</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">40</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"purple"</span>, ylab<span class="op">=</span><span class="st">"probability"</span>, </span>
<span>      xlab<span class="op">=</span><span class="st">"number of letters u in a new page"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-10-1.png" width="55%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/GammaPoiss.html" class="external-link">dgpois</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">748.8</span>, <span class="fl">29.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">pred2</span>,type<span class="op">=</span><span class="st">"h"</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">40</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"purple"</span>, ylab<span class="op">=</span><span class="st">"probability"</span>, </span>
<span>      xlab<span class="op">=</span><span class="st">"number of u's in a new page"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p2count_files/figure-html/unnamed-chunk-10-2.png" width="55%" style="display: block; margin: auto;">
The graphs of both distributions are visually almost identical. The mean
and standard deviation are</p>
<p><span class="math display">\[\begin{align*}
\text{Predictive 1: }&amp; \text{GaPo}(643.5, 25, 1 ), \,\,
\mathbb{E}(Y_{26} \mid \mathcal D)=25.74, \,\,SD(Y_{26} \mid
\mathcal{D})=5.17 \text{ letters u}\\
\text{Predictive 2: }&amp; \text{GaPo}(748.8, 29.6, 1), \,\,
\mathbb{E}(Y_{26} \mid \mathcal D)=25.30, , \,\,SD(Y_{26} \mid
\mathcal{D})=5.11 \text{ letters u}
\end{align*}\]</span></p>
<p>It is important to note the large variability associated with the
prediction process relative to the estimation process. This
characteristic of the estimation and prediction processes is general to
all inferential processes and statistical methodologies.</p>
</div>
</div>
<div class="section level2">
<h2 id="time-to-individual-work">Time to individual work<a class="anchor" aria-label="anchor" href="#time-to-individual-work"></a>
</h2>
<p>We propose below an individual exercise that pursues to consolidate
the basic concepts that we have learned in the previous theoretical
session and that we have been practising in this session.</p>
<p><strong>Exercice</strong></p>
<p>You just remembered that you have another friend, Tauriel, who is
also very enthusiastic of the novel <em>A Game of Thrones</em> and you
have thought to ask her opinion about the number of u’s in the novel.
Her prior distribution for <span class="math inline">\(\lambda\)</span>
is very different from that of your other friend Joan. It is Ga(90, 3)
and we will call it prior 3. <span class="math display">\[\begin{align*}
\text{Tauriel, Prior 3: } &amp; \pi_3(\lambda) = \text{Ga}(90,3)
\end{align*}\]</span></p>
<ol style="list-style-type: decimal">
<li><p>How different are your two friends’ opinions on <span class="math inline">\(\lambda\)</span>? A good idea to answer this
question would be to plot both densities and calculate the mean,
standard deviation and some relevant probabilities from the subsequent
prior distributions.</p></li>
<li><p>From the results of the previous experiment (<span class="math inline">\(\sum y_i= 643\)</span> u’s in a total of <span class="math inline">\(n=25\)</span>), compare the posterior distribution
for <span class="math inline">\(\lambda\)</span> that Joan and Tauriel
would obtain.</p></li>
<li><p>Joan and Taurel select <span class="math inline">\(n^{\prime}=1\)</span> new page from the novel.
Before they start counting the u’s on the page, they ask you to
calculate the predicted distribution of each of them over the number of
u’s they will find on this page. Can you compute them? And since they
are asking you to do some work, you could also represent them
graphically and describe them numerically.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS5, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
