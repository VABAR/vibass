<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 2: Inference with simulated samples • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 2: Inference with simulated samples">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2.html">Practical 2: Inference with simulated samples</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Count data</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Normal data</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Linear models</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/p8.html">Practical 8: Bayesian hierachical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 2: Inference with simulated samples</h1>
                        <h4 class="author">VIBASS4</h4>
            
            <h4 class="date">July 2021</h4>
      
      
      <div class="hidden name"><code>p2.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>We know that probabilities and proportions take values between 0 and 1. But in some studies the relevant information about them is presented on a different scale. Although different scales can be found in the statistical literature, we will only use the two most popular ones, which are the <em>odds</em> and the <em>log-odds</em>, also known as the <em>logit</em> function.</p>
<ul>
<li><p>Any probability <span class="math inline">\(\theta\)</span> can be expressed in terms of odds as <span class="math display">\[\mbox{odds} (\theta)=\frac{\theta}{ 1-\theta}\]</span></p></li>
<li><p>Any probability <span class="math inline">\(\theta\)</span> can be expressed in the log-odds scale as <span class="math display">\[\mbox{log-odds} (\theta)= \mbox{log}\,\frac{\theta}{ 1-\theta}\]</span></p></li>
</ul>
<p>The odds of an event represent the ratio of the probability <span class="math inline">\(\theta\)</span> that the event will occur to the probability <span class="math inline">\(1-\theta\)</span> that the event will not occur. The odds scale extends the probability to the set of positive reals. The logit transformation are odds in logarithmic scale and extends the probability to all reals, positive and negative.</p>
<div class="figure">
<img src="p2_files/figure-html/fig-transformations-1.png" alt="Probability-scale transformations." width="288"><p class="caption">
Probability-scale transformations.
</p>
</div>
</div>
<div id="return-to-study-of-the-proportion-of-red-mms" class="section level1">
<h1 class="hasAnchor">
<a href="#return-to-study-of-the-proportion-of-red-mms" class="anchor"></a>Return to study of the proportion of red M<span class="math inline">\(\&amp;\)</span>M’s</h1>
<p>We return to the M&amp;M problem. We recall that the posterior distribution for the proportion <span class="math inline">\(\theta\)</span> of red candies in the population that we obtained in the first practice was</p>
<p><span class="math display">\[\pi(\theta \mid \mathcal{D})= \mbox{Be}(\alpha=4.5, \beta= 16.5) \]</span></p>
<p>whose graphic was </p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">posterior</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"red"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,
     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"proportion of red candies "</span>, <span class="va">theta</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-1-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Let’s obtain the posterior distribution of <span class="math inline">\(\theta\)</span> on the odds scale, <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span> and we will leave the simulation of <span class="math inline">\(\pi(\mbox{log-odds}(\theta) \mid \mathcal D)\)</span> as individual work at the end of the practice.</p>
<div id="computation-of-pimboxoddstheta-mid-mathcal-d" class="section level2">
<h2 class="hasAnchor">
<a href="#computation-of-pimboxoddstheta-mid-mathcal-d" class="anchor"></a>Computation of <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span>
</h2>
<p>We could try to obtain the distribution a posteriori <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span> from using probabilistic tools but we will not choose that path. We will simulate it from a random sample of <span class="math inline">\(\pi( \theta \mid \mathcal D)\)</span> as follows: </p>
<ul>
<li>If <span class="math inline">\(\{\theta^{(1)}, \theta^{(2)}, \ldots, \theta^{(M)}\}\)</span> is a random sample from <span class="math inline">\(\pi(\theta \mid \mathcal D)\)</span> then <span class="math inline">\(\{\mbox{odds}(\theta^{(1)}), \mbox{odds}(\theta^{(2)}), \ldots, \mbox{odds}(\theta^{(M)})\}\)</span> is a random sample from <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span>. </li>
</ul>
<p>It is clear that the larger the simulated sample the better approximation to the target distribution. We will work with a sample size of <span class="math inline">\(M=10\,000\)</span> but everyone is free to use the size they want, or even to try different sizes to see how the simulated sample gets closer and closer to the real one when the size of the sample increases. Although it is not necessary, and only as an illustration, we also simulate <span class="math inline">\(\pi(\theta \mid \mathcal{D})= \mbox{Be}(\alpha=4.5, \beta= 16.5)\)</span>, and we will superimpose the posterior on the simulated sample. </p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theta.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">theta.r</span>, breaks <span class="op">=</span> <span class="fl">70</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"gray98"</span>, main<span class="op">=</span><span class="st">""</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, 
     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"proportion of red candies "</span>, <span class="va">theta</span> <span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"posterior"</span><span class="op">)</span>
<span class="va">theta</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.001</span><span class="op">)</span>
<span class="va">posterior</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">posterior</span>, col<span class="op">=</span><span class="st">"red"</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2.7</span><span class="op">)</span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We then approximate the posterior distribution for the odds of <span class="math inline">\(\theta\)</span> </p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oddstheta.r</span> <span class="op">&lt;-</span> <span class="va">theta.r</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">theta.r</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">oddstheta.r</span>,
     breaks <span class="op">=</span> <span class="fl">100</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"gray98"</span>, main<span class="op">=</span><span class="st">""</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>, 
     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"odds of the proportion of red candies "</span>, <span class="va">theta</span> <span class="op">)</span><span class="op">)</span>,
     ylab<span class="op">=</span><span class="st">"posterior"</span>
<span class="op">)</span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We can also approximate any characteristic of the posteriori distribution that we are interested in, such as the posterior mean, variance, standard deviation, 5th, 50 th and 95th percentile, 95<span class="math inline">\(\%\)</span> credible interval and any probability posterior probability, e.g. <span class="math inline">\(P(\mbox{odds}(\theta)&gt;1 \mid \mathcal D)\)</span> by means of the corresponding characteristics of the simulated sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span>
  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">oddstheta.r</span><span class="op">)</span>,
  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">oddstheta.r</span><span class="op">)</span>,
  quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">oddstheta.r</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>,
  ic95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">oddstheta.r</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,
  prop1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">oddstheta.r</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="st">"$\\text{odds}(\\theta)$"</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Summary</th>
<th align="left"><span class="math inline">\(\text{odds}(\theta)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">0.29</td>
</tr>
<tr class="even">
<td align="left">Var</td>
<td align="left">0.02</td>
</tr>
<tr class="odd">
<td align="left">S.Dev</td>
<td align="left">0.16</td>
</tr>
<tr class="even">
<td align="left">Q05</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td align="left">Q50</td>
<td align="left">0.26</td>
</tr>
<tr class="even">
<td align="left">Q95</td>
<td align="left">0.58</td>
</tr>
<tr class="odd">
<td align="left">IC95</td>
<td align="left">(0.08, 0.67)</td>
</tr>
<tr class="even">
<td align="left">Prop&gt;1</td>
<td align="left">0.2%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="comparing-the-proportion-of-red-and-blue-mms" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-the-proportion-of-red-and-blue-mms" class="anchor"></a>Comparing the proportion of red and blue M<span class="math inline">\(\&amp;\)</span>M’s</h1>
<p>Suppose now that we want to compare the proportion of red and blue candies in the population. </p>
<center>
<div class="figure">
<img src="red_blue_simulation.jpg" alt=""><p class="caption">A pile of red and blue peanut M&amp;M’s candies. Photos by Victor Roda.</p>
</div>
</center>

<p>In the previous practice we have learned about the proportion of red M&amp;Ms but so far we do not know anything about the blue ones. Let’s imagine that we repeat the previous practice again but with the objective of learning about the proportion of blue candies we will call <span class="math inline">\(\theta_b\)</span> and that the resulting Bayesian learning process has been:</p>
<ul>
<li>Prior distribution: <span class="math inline">\(\pi(\theta_b)=\mbox{Be}(0.5, 0.5)\)</span>
</li>
<li>Data <span class="math inline">\(\mathcal D_b\)</span>: <span class="math inline">\(n=50\)</span> M&amp;M’s observed, <span class="math inline">\(r=14\)</span> blue candies</li>
<li>Posterior distribution: <span class="math inline">\(\pi(\theta_b \mid \mathcal D_b)=\mbox{Be}(14.5, 36.5)\)</span>
</li>
</ul>
<p>We denote <span class="math inline">\(\theta_r\)</span> from now on as the proportion of red candies. We plot the posterior distribution on the proportion on red candies and the one for the blue candies on the same graph. </p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">posterior.blue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">14.5</span>, <span class="fl">36.5</span><span class="op">)</span>
<span class="va">posterior.red</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">posterior.blue</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"dodgerblue1"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>,
     xlab<span class="op">=</span><span class="st">"proportion of blue and red candies"</span>, ylab<span class="op">=</span><span class="st">"posterior"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">posterior.red</span>, col<span class="op">=</span><span class="st">"red"</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2.7</span><span class="op">)</span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;"></p>

<p>Visually, we observe that the proportion of blue candies is slightly higher than that of the red ones. Also, since the sample to obtain their distribution is larger than the one we considered for the red ones, their variability is slightly lower.</p>

<p>We have separate information on each proportion through its posterior distribution. We would like to obtain a distribution that provides joint information from both quantities. Since the inferential processes, prior distribution, experiment, data and likelihood function, for both proportions are independent of each other we will have that the joint posterior distribution of both proportions are independent a posteriori.</p>
<p><span class="math display">\[\pi(\theta_r, \theta_b \mid \mathcal D_r, \mathcal D_b)= \mbox{Be}(\theta_r \mid 4.5, 16.5) \, \mbox{Be}(\theta_b \mid 14.5, 36.5),\]</span></p>
<p>where <span class="math inline">\(\mathcal D_r\)</span> is from now on the data of the inferential process of the red M&amp;M’s.</p>
<p>There are many proposal for comparing both proportions. The two most popular are possibly the risk difference, <span class="math inline">\(\theta_b - \theta_r\)</span> or <span class="math inline">\(\theta_r - \theta_b\)</span>, and the relative risk, <span class="math inline">\(\theta_b /\theta_r\)</span> or <span class="math inline">\(\theta_r / \theta_b\)</span>. We now focus on <span class="math inline">\(\theta_b - \theta_r\)</span>. Since <span class="math inline">\(\theta_b - \theta_r\)</span> is a function of <span class="math inline">\(\theta_b\)</span> and <span class="math inline">\(\theta_r\)</span>, it would make sense to consider the posterior distribution of its difference <span class="math inline">\(\pi(\theta_b - \theta_r \mid \mathcal D_b, \mathcal D_r)\)</span>. Such a distribution should not be analytical but we can simulate it in the following way: </p>
<ol style="list-style-type: decimal">
<li>Simulate a random sample <span class="math inline">\(\{\theta_r^{(1)}, \theta_r^{(2)}, \ldots, \theta_r^{(M)} \}\)</span> from <span class="math inline">\(\pi(\theta_r \mid \mathcal D_r)=\mbox{Be}(\theta_r \mid 4.5, 16.5)\)</span>
</li>
<li>Simulate a random sample <span class="math inline">\(\{\theta_b^{(1)}, \theta_b^{(2)}, \ldots, \theta_b^{(M)} \}\)</span> from <span class="math inline">\(\pi(\theta_b \mid \mathcal D_b)=\mbox{Be}(\theta_b \mid 14.5, 36.5)\)</span>
</li>
<li>A random sample from <span class="math inline">\(\pi(\theta_b - \theta_r \mid \mathcal D_b, \mathcal D_r)\)</span> is <span class="math inline">\(\{\theta_b^{(1)}-\theta_r^{(1)}, \theta_b^{(2)}-\theta_r^{(2)}, \ldots, \theta_b^{(M)}-\theta_r^{(M)} \}\)</span>.</li>
</ol>
<p> We are going to graphically represent this distribution and to calculate approximately its main characteristics. </p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theta.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>
<span class="va">theta.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">14.5</span>, <span class="fl">36.5</span><span class="op">)</span>
<span class="va">theta.dif</span> <span class="op">&lt;-</span> <span class="va">theta.b</span><span class="op">-</span> <span class="va">theta.r</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">theta.dif</span>, breaks <span class="op">=</span> <span class="fl">70</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"gray98"</span>, main<span class="op">=</span><span class="st">""</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">+</span><span class="fl">0.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>, 
     xlab<span class="op">=</span><span class="st">"proportion blue - proportion red"</span>, ylab<span class="op">=</span><span class="st">"posterior"</span><span class="op">)</span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span>
  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">theta.dif</span><span class="op">)</span>,
  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">theta.dif</span><span class="op">)</span>,
  quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta.dif</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>,
  ic95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta.dif</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,
  prop0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">theta.dif</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="st">"$\\theta_b - \\theta_r$"</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Summary</th>
<th align="left"><span class="math inline">\(\theta_b - \theta_r\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td align="left">Var</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">S.Dev</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">Q05</td>
<td align="left">-0.11</td>
</tr>
<tr class="odd">
<td align="left">Q50</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td align="left">Q95</td>
<td align="left">0.24</td>
</tr>
<tr class="odd">
<td align="left">IC95</td>
<td align="left">(-0.15, 0.27)</td>
</tr>
<tr class="even">
<td align="left">Prop&gt;0</td>
<td align="left">75.3%</td>
</tr>
</tbody>
</table>
</div>
<div id="individual-work" class="section level1">
<h1 class="hasAnchor">
<a href="#individual-work" class="anchor"></a>Individual work</h1>
<p>We will now work individually on the simulation procedure of the posterior distribution of a function of the quantity of interest and also the comparison of two groups through the relative risk. </p>
<p></p>
<ol style="list-style-type: decimal">
<li><p>Compute the posterior distribution of the proportion of red M&amp;M’s in the log-odds scale as well as its main characteristics</p></li>
<li><p>Compare the proportion of red and blue M&amp;M’s through the relative risk <span class="math inline">\(\theta_b/\theta_r\)</span>.</p></li>
<li><p>It would be good if we could make a little reflection on the frequentist procedure to compare two proportions and on the differences with the Bayesian procedure.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VIBASS4, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
