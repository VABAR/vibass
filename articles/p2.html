<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 2: Inference with simulated samples • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 2: Inference with simulated samples">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2.html">Practical 2: Inference with simulated samples</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Count data</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Normal data</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p5_solutions.html">Solutions 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Linear models</a>
    </li>
    <li>
      <a href="../articles/p6_solutions.html">Solutions 6: Linear models</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/p7_solutions.html">Solutions 7: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/p8.html">Practical 8: Bayesian hierachical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p2_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 2: Inference with simulated samples</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
            <h4 data-toc-skip class="date">July 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/HEAD/vignettes/p2.Rmd" class="external-link"><code>vignettes/p2.Rmd</code></a></small>
      <div class="hidden name"><code>p2.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We know that probabilities and proportions take values between 0 and 1. But in some studies the relevant information about them is presented on a different scale. Although different scales can be found in the statistical literature, we will only use the two most popular ones, which are the <em>odds</em> and the <em>log-odds</em>, also known as the <em>logit</em> function.</p>
<ul>
<li><p>Any probability <span class="math inline">\(\theta\)</span> can be expressed in terms of odds as <span class="math display">\[\mbox{odds} (\theta)=\frac{\theta}{ 1-\theta}\]</span></p></li>
<li><p>Any probability <span class="math inline">\(\theta\)</span> can be expressed in the log-odds scale as <span class="math display">\[\mbox{log-odds} (\theta)= \mbox{log}\,\frac{\theta}{ 1-\theta}\]</span></p></li>
</ul>
<p>The odds of an event represent the ratio of the probability <span class="math inline">\(\theta\)</span> that the event will occur to the probability <span class="math inline">\(1-\theta\)</span> that the event will not occur. The odds scale extends the probability to the set of positive reals. The logit transformation are odds in logarithmic scale and extends the probability to all reals, positive and negative.</p>
<div class="figure">
<img src="p2_files/figure-html/fig-transformations-1.png" alt="Probability-scale transformations." width="288"><p class="caption">
Probability-scale transformations.
</p>
</div>
</div>
<div class="section level2">
<h2 id="return-to-study-of-the-proportion-of-red-mms">Return to study of the proportion of red M<span class="math inline">\(\&amp;\)</span>M’s<a class="anchor" aria-label="anchor" href="#return-to-study-of-the-proportion-of-red-mms"></a>
</h2>
<p>We return to the M&amp;M problem. We recall that the posterior distribution for the proportion <span class="math inline">\(\theta\)</span> of red candies in the population that we obtained in the first practice was</p>
<p><span class="math display">\[\pi(\theta \mid \mathcal{D})= \mbox{Be}(\alpha=4.5, \beta= 16.5) \]</span></p>
<p>whose graphic was</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'posterior'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-1-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Let’s obtain the posterior distribution of <span class="math inline">\(\theta\)</span> on the odds scale, <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span> and we will leave the simulation of <span class="math inline">\(\pi(\mbox{log-odds}(\theta) \mid \mathcal D)\)</span> as individual work at the end of the practice.</p>
<div class="section level3">
<h3 id="computation-of-pimboxoddstheta-mid-mathcal-d">Computation of <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span><a class="anchor" aria-label="anchor" href="#computation-of-pimboxoddstheta-mid-mathcal-d"></a>
</h3>
<p>We could try to obtain the posterior distribution <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span> using probabilistic tools but we will not choose that path. Instead, let’s simulate it from a random sample of <span class="math inline">\(\pi( \theta \mid \mathcal D)\)</span> noting that:</p>
<ul>
<li>if <span class="math inline">\(\{\theta^{(1)}, \theta^{(2)}, \ldots, \theta^{(M)}\}\)</span> is a random sample from <span class="math inline">\(\pi(\theta \mid \mathcal D)\)</span> then <span class="math inline">\(\{\mbox{odds}(\theta^{(1)}), \mbox{odds}(\theta^{(2)}), \ldots, \mbox{odds}(\theta^{(M)})\}\)</span> is a random sample from <span class="math inline">\(\pi(\mbox{odds}(\theta) \mid \mathcal D)\)</span>.</li>
</ul>
<p>It is clear that the larger the simulated sample the better approximation to the target distribution. We will work with a sample size of <span class="math inline">\(M=10\,000\)</span> but everyone is free to use the size they want, or even to try different sizes to see how the simulated sample gets closer and closer to the real one when the size of the sample increases. We also compute the posterior <span class="math inline">\(\pi(\theta \mid \mathcal{D})= \text{Be}(\alpha=4.5, \beta= 16.5)\)</span> and plot it over the simulated sample, to show the match between the empirical and the theoretical distribution.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>  <span class="co"># random sample of values from the posterior</span></span>
<span><span class="co">## Histogram of simulated values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">theta.r</span>, breaks <span class="op">=</span> <span class="fl">70</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"gray98"</span>, main<span class="op">=</span><span class="st">""</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span> <span class="op">)</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"posterior"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"darkgreen"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'posterior'</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We then approximate the posterior distribution of <span class="math inline">\(\text{odds}(\theta)\)</span> by transforming each sampled value of <span class="math inline">\(\theta\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oddstheta.r</span> <span class="op">&lt;-</span> <span class="va">theta.r</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">theta.r</span><span class="op">)</span>  <span class="co"># random sample of odds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">oddstheta.r</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">100</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="st">"gray98"</span>, main<span class="op">=</span><span class="st">""</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"odds of the proportion of red candies "</span>, <span class="va">theta</span> <span class="op">)</span><span class="op">)</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"posterior"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We can also approximate any characteristic of the posteriori distribution that we are interested in, such as the posterior mean, variance, standard deviation, 5th, 50 th and 95th percentile, 95<span class="math inline">\(\%\)</span> credible interval and any probability posterior probability, e.g. <span class="math inline">\(P(\mbox{odds}(\theta)&gt;1 \mid \mathcal D)\)</span> by means of the corresponding characteristics of the simulated sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">oddstheta.r</span><span class="op">)</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">oddstheta.r</span><span class="op">)</span>,</span>
<span>  quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">oddstheta.r</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ic95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">oddstheta.r</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prop1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">oddstheta.r</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"$\\text{odds}(\\theta)$"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Summary</th>
<th align="left"><span class="math inline">\(\text{odds}(\theta)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">0.29</td>
</tr>
<tr class="even">
<td align="left">Var</td>
<td align="left">0.03</td>
</tr>
<tr class="odd">
<td align="left">S.Dev</td>
<td align="left">0.16</td>
</tr>
<tr class="even">
<td align="left">Q05</td>
<td align="left">0.1</td>
</tr>
<tr class="odd">
<td align="left">Q50</td>
<td align="left">0.26</td>
</tr>
<tr class="even">
<td align="left">Q95</td>
<td align="left">0.59</td>
</tr>
<tr class="odd">
<td align="left">IC95</td>
<td align="left">(0.08, 0.69)</td>
</tr>
<tr class="even">
<td align="left">Prop&gt;1</td>
<td align="left">0.3%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="comparing-the-proportion-of-red-and-blue-mms">Comparing the proportion of red and blue M<span class="math inline">\(\&amp;\)</span>M’s<a class="anchor" aria-label="anchor" href="#comparing-the-proportion-of-red-and-blue-mms"></a>
</h2>
<p>Suppose now that we want to compare the proportion of red and blue candies in the population. </p>
<center>
<div class="figure">
<img src="red_blue_simulation.jpg" alt=""><p class="caption">A pile of red and blue peanut M&amp;M’s candies. Photos by Victor Roda.</p>
</div>
</center>

<p>In the previous practice we have learned about the proportion of red M&amp;Ms but so far we do not know anything about the blue ones. Let’s imagine that we repeat the previous practical again but with the objective of learning about the proportion of blue candies <span class="math inline">\(\theta_b\)</span> and that the resulting Bayesian learning process has been:</p>
<ul>
<li>Prior distribution: <span class="math inline">\(\pi(\theta_b)=\mbox{Be}(0.5, 0.5)\)</span>
</li>
<li>Data <span class="math inline">\(\mathcal D_b\)</span>: <span class="math inline">\(n=50\)</span> M&amp;M’s observed, <span class="math inline">\(r=14\)</span> blue candies</li>
<li>Posterior distribution: <span class="math inline">\(\pi(\theta_b \mid \mathcal D_b)=\mbox{Be}(14.5, 36.5)\)</span>
</li>
</ul>
<p>We denote <span class="math inline">\(\theta_r\)</span> the proportion of red candies from now on. We plot the posterior distributions of the proportion of red and blue candies the same graph.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">14.5</span>, <span class="fl">36.5</span><span class="op">)</span>,   <span class="co"># Posterior proportion of blue candies</span></span>
<span>  col <span class="op">=</span> <span class="st">"dodgerblue1"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Proportion of blue and red candies "</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">'posterior'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span>,   <span class="co"># Posterior proportion of red candies</span></span>
<span>  col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Visually, we observe that the proportion of blue candies is slightly higher than that of the red ones. Also, the posterior distribution of the proportion of blue candies is slightly narrower since the sample size used (<span class="math inline">\(n = 50\)</span>) is larger than for red candies (<span class="math inline">\(n = 20\)</span>). More <strong>information</strong> available implies increased <strong>certainty</strong> on the posterior inference.</p>
<p>We have <strong>separate</strong> information about each proportion through their posterior distributions. We would like to obtain a distribution that provides <strong>joint information</strong> about both quantities. Since the inferential processes, prior distribution, experiment, data and likelihood function, for both proportions are <strong>independent</strong> of each other we will have that the joint posterior distribution of both proportions are independent a posteriori.</p>
<p><span class="math display">\[\pi(\theta_r, \theta_b \mid \mathcal D_r, \mathcal D_b)= \mbox{Be}(\theta_r \mid 4.5, 16.5) \, \mbox{Be}(\theta_b \mid 14.5, 36.5),\]</span></p>
<p>where <span class="math inline">\(\mathcal D_r\)</span> is from now on the data of the inferential process of the red M&amp;M’s.</p>
<p>There are many alternative ways of comparing both proportions. The most popular are possibly the <em>risk difference</em>, <span class="math inline">\(\theta_b - \theta_r\)</span> or <span class="math inline">\(\theta_r - \theta_b\)</span>, and the <em>relative risk</em>, <span class="math inline">\(\theta_b /\theta_r\)</span> or <span class="math inline">\(\theta_r / \theta_b\)</span>. Let’s focus on <span class="math inline">\(\theta_b - \theta_r\)</span>. Since <span class="math inline">\(\theta_b - \theta_r\)</span> is a function of <span class="math inline">\(\theta_b\)</span> and <span class="math inline">\(\theta_r\)</span>, it would make sense to consider the posterior distribution of its difference <span class="math inline">\(\pi(\theta_b - \theta_r \mid \mathcal D_b, \mathcal D_r)\)</span>. Such a distribution is not analytical, but we can simulate it in the following way:</p>
<ol style="list-style-type: decimal">
<li>Simulate a random sample <span class="math inline">\(\{\theta_r^{(1)}, \theta_r^{(2)}, \ldots, \theta_r^{(M)} \}\)</span> from <span class="math inline">\(\pi(\theta_r \mid \mathcal D_r)=\mbox{Be}(\theta_r \mid 4.5, 16.5)\)</span>
</li>
<li>Simulate a random sample <span class="math inline">\(\{\theta_b^{(1)}, \theta_b^{(2)}, \ldots, \theta_b^{(M)} \}\)</span> from <span class="math inline">\(\pi(\theta_b \mid \mathcal D_b)=\mbox{Be}(\theta_b \mid 14.5, 36.5)\)</span>
</li>
<li>A random sample from <span class="math inline">\(\pi(\theta_b - \theta_r \mid \mathcal D_b, \mathcal D_r)\)</span> is <span class="math inline">\(\{\theta_b^{(1)}-\theta_r^{(1)}, \theta_b^{(2)}-\theta_r^{(2)}, \ldots, \theta_b^{(M)}-\theta_r^{(M)} \}\)</span>.</li>
</ol>
<p>We are going to graphically represent this distribution and to calculate approximately its main characteristics. </p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">4.5</span>, <span class="fl">16.5</span><span class="op">)</span></span>
<span><span class="va">theta.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">14.5</span>, <span class="fl">36.5</span><span class="op">)</span></span>
<span><span class="va">theta.dif</span> <span class="op">&lt;-</span> <span class="va">theta.b</span> <span class="op">-</span> <span class="va">theta.r</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">theta.dif</span>, breaks <span class="op">=</span> <span class="fl">70</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"gray98"</span>, main <span class="op">=</span> <span class="st">""</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="op">+</span><span class="fl">0.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Proportion blue - Proportion red"</span>, ylab <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta.dif</span><span class="op">)</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">theta.dif</span><span class="op">)</span>,</span>
<span>  quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">theta.dif</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ic95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">theta.dif</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prop0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta.dif</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"$\\theta_b - \\theta_r$"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Summary</th>
<th align="left"><span class="math inline">\(\theta_b - \theta_r\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td align="left">Var</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">S.Dev</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">Q05</td>
<td align="left">-0.12</td>
</tr>
<tr class="odd">
<td align="left">Q50</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td align="left">Q95</td>
<td align="left">0.24</td>
</tr>
<tr class="odd">
<td align="left">IC95</td>
<td align="left">(-0.16, 0.26)</td>
</tr>
<tr class="even">
<td align="left">Prop&gt;0</td>
<td align="left">74.6%</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="individual-work">Individual work<a class="anchor" aria-label="anchor" href="#individual-work"></a>
</h2>
<p>We will now work individually on the simulation procedure of the posterior distribution of a function of the quantity of interest and also the comparison of two groups through the relative risk.</p>
<ol style="list-style-type: decimal">
<li><p>Compute the posterior distribution of the proportion of red M&amp;M’s in the log-odds scale as well as its main characteristics</p></li>
<li><p>Compare the proportion of red and blue M&amp;M’s through the relative risk <span class="math inline">\(\theta_b/\theta_r\)</span>.</p></li>
<li>
<p>It would be good if we could make a little reflection on the frequentist procedure to compare two proportions and on the differences with the Bayesian procedure.</p>
<p>E.g. what does the result below tells you, and what is the relationship with what we have just done</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">4</span>, b <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">20</span>, b <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  c(r = 4, b = 14) out of c(r = 20, b = 50)</span></span>
<span><span class="co">#&gt; X-squared = 0.15144, df = 1, p-value = 0.6972</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.3299894  0.1699894</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; prop 1 prop 2 </span></span>
<span><span class="co">#&gt;   0.20   0.28</span></span></code></pre></div>
</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS4, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
