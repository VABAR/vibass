<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PRACTICAL 4: Normal data • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PRACTICAL 4: Normal data">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">PRACTICAL 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2.html">PRACTICAL 2: Inference with simulated samples</a>
    </li>
    <li>
      <a href="../articles/p3.html">PRACTICAL 3: Count data</a>
    </li>
    <li>
      <a href="../articles/p4.html">PRACTICAL 4: Normal data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p4_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="p4_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="p4_files/plotly-binding-4.9.4.1/plotly.js"></script><script src="p4_files/typedarray-0.1/typedarray.min.js"></script><script src="p4_files/jquery-3.5.1/jquery.min.js"></script><link href="p4_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="p4_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="p4_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="p4_files/plotly-main-1.57.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PRACTICAL 4: Normal data</h1>
                        <h4 class="author">VIBASS4</h4>
            
            <h4 class="date">July 2021</h4>
      
      
      <div class="hidden name"><code>p4.Rmd</code></div>

    </div>

    
    
<div id="how-tall-the-vibass-students-are" class="section level1">
<h1 class="hasAnchor">
<a href="#how-tall-the-vibass-students-are" class="anchor"></a>How tall the VIBASS’ students are?</h1>
<p>One of the most commonly used examples of Normal data are heights and weights. We want to continue this tradition. We will dedicate this practice to work with the heights of the VIBASS students of the past editions. We start first with the height of the women.</p>
<div class="figure" style="text-align: center">
<img src="vibass_participants.jpg" alt="Some VIBASS students."><p class="caption">
Some VIBASS students.
</p>
</div>
</div>
<div id="bayesian-inference-for-the-mean-height-of-the-women-vibass-students--the-variance-of-the-sampling-normal-model-is-known-" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesian-inference-for-the-mean-height-of-the-women-vibass-students--the-variance-of-the-sampling-normal-model-is-known-" class="anchor"></a>Bayesian inference for the mean height of the women VIBASS students. The variance of the sampling Normal model is known.</h1>
<div id="the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data" class="anchor"></a>The data</h2>
<p>We have the following height data, in metres, for a random sample of <span class="math inline">\(n=15\)</span> women students from previous editions of VIBASS.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hwomen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.73</span>, <span class="fl">1.65</span>, <span class="fl">1.65</span>, <span class="fl">1.76</span>, <span class="fl">1.65</span>, <span class="fl">1.63</span>, <span class="fl">1.70</span>, <span class="fl">1.58</span>, <span class="fl">1.57</span>, <span class="fl">1.65</span>, <span class="fl">1.74</span>, <span class="fl">1.68</span>, <span class="fl">1.67</span>, <span class="fl">1.58</span>, <span class="fl">1.66</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can summarize the data and represent them by means of a histogram.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span>
  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>,
  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>,
  quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
  label <span class="op">=</span> <span class="st">"Women height"</span>,
  digits <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Summary</th>
<th align="right">Women height</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean</td>
<td align="right">1.660</td>
</tr>
<tr class="even">
<td align="left">Var</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">S.Dev</td>
<td align="right">0.057</td>
</tr>
<tr class="even">
<td align="left">Min.</td>
<td align="right">1.570</td>
</tr>
<tr class="odd">
<td align="left">Q25</td>
<td align="right">1.640</td>
</tr>
<tr class="even">
<td align="left">Q50</td>
<td align="right">1.650</td>
</tr>
<tr class="odd">
<td align="left">Q75</td>
<td align="right">1.690</td>
</tr>
<tr class="even">
<td align="left">Max.</td>
<td align="right">1.760</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span>,
     main <span class="op">=</span> <span class="cn">NULL</span>, xlab<span class="op">=</span><span class="st">"Height in metres"</span>,
     col<span class="op">=</span><span class="st">"gray89"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.50</span>, <span class="fl">1.85</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="p4_files/figure-html/unnamed-chunk-3-1.png" width="65%" style="display: block; margin: auto;"></p>
<p>The histogram obtained does not remind us much of the Normal distribution. But we know that when we work with small amounts of data, even if they are Normal, we cannot expect their histogram to look like a symmetrical bell. In fact, if we were to generate small Normal data samples, few of them would resemble the Gaussian ideal.</p>
</div>
<div id="the-sampling-model-is-approximately-normal" class="section level2">
<h2 class="hasAnchor">
<a href="#the-sampling-model-is-approximately-normal" class="anchor"></a>The sampling model is approximately Normal</h2>
<p>Let <span class="math inline">\(Y\)</span> be the random variable that describes the height of the women in VIBASS. We assume that given the mean of the height of the VIBASS women <span class="math inline">\(\mu\)</span>, the distribution of <span class="math inline">\(Y\)</span> is Normal with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma= 0.1\)</span>.</p>
<p><span class="math display">\[Y \mid \mu \sim \mathcal{N}(\mu,\, \sigma = 0.1),\]</span> whose conditional density function, expectation and variance are:</p>
<ul>
<li><span class="math inline">\(f(y \mid \mu )= \frac{1}{0.1 \,\sqrt{2 \pi}}\, \mbox{e}^{\big\{ \frac{-1}{2 \,\cdot \, 0.1^2}\,(y-\mu)^2\big\}}\)</span></li>
<li>
<span class="math inline">\(\text{E}(Y \mid \mu)= \mu\)</span>,</li>
<li><span class="math inline">\(\text{Var}(Y \mid \mu) = \sigma^2 = 0.01.\)</span></li>
</ul>
</div>
<div id="a-prior-distribution-for-mu" class="section level2">
<h2 class="hasAnchor">
<a href="#a-prior-distribution-for-mu" class="anchor"></a>A prior distribution for <span class="math inline">\(\mu\)</span>
</h2>
<p>Recall that the Normal distribution is conjugate with respect to the Normal probability model with <span class="math inline">\(\sigma\)</span> known. If we elicit a Normal prior distribution <span class="math inline">\(\mathcal{N}(\mu_0,\, \sigma_0)\)</span> for <span class="math inline">\(\mu\)</span>, its density is</p>
<p><span class="math display">\[\pi(\mu)=\frac{1}{\sigma_0 \,\sqrt{2 \pi}}\, \mbox{e}^{\, \frac{-1}{2\sigma_{0}^2}\,(\mu-\mu_0)^2 }\]</span></p>
<p>with prior mean and and variance</p>
<ul>
<li>
<span class="math inline">\(\text{E}(\mu)= \mu_0\)</span>,</li>
<li><span class="math inline">\(\text{Var}(\mu)= \sigma_0.\)</span></li>
</ul>
<p>We are going to work with a prior distribution based on the information from two of the VIBASS lecturers. This prior distribution is</p>
<p><span class="math display">\[\pi(\mu) = \mathcal{N}(\mu_0=1.70, \sigma_0=0.07).\]</span></p>
<p>On the basis of this distribution these two teachers think that the mean of the height of women VIBASS students is centred on <span class="math inline">\(1.70\)</span> m with a standard deviation of <span class="math inline">\(0.07\)</span> m. According to it, we can compute the following percentile and probabilities</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.995</span><span class="op">)</span>, <span class="fl">1.70</span>, <span class="fl">0.07</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.519692 1.880308</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.50</span>, <span class="fl">1.60</span>, <span class="fl">1.70</span>, <span class="fl">1.80</span>, <span class="fl">1.90</span><span class="op">)</span>, <span class="fl">1.70</span>, <span class="fl">0.07</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.002137367 0.076563726 0.500000000 0.923436274 0.997862633</span></code></pre></div>
<p>Consequently, a 99<span class="math inline">\(\%\)</span> credible interval for <span class="math inline">\(\mu\)</span> is <span class="math inline">\((1,52, \,1.88)\)</span> which means that the probability that a VIBASS student is neither taller than 1.88 metres nor shorter than 1.52 is 0.99. The probability that she is shorter than 1.50 is 0.0021, the probability that her height is between 1.60 and 1.80 is 0.9234-0.0766= 0.8468 or the probability that is taller than 1.80 is 1-0.9234=0.0766. Next we show the graphic of the density of this prior distribution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cap</span> <span class="op">&lt;-</span> <span class="st">"Prior distribution for the mean height."</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fl">1.7</span>; <span class="va">s0</span> <span class="op">&lt;-</span> <span class="fl">0.07</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m0</span>, <span class="va">s0</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"prior"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.40</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="p4_files/figure-html/unnamed-chunk-5-1.png" alt="Prior distribution for the mean height." width="60%"><p class="caption">
Prior distribution for the mean height.
</p>
</div>
</div>
<div id="the-likelihood-function-of-mu" class="section level2">
<h2 class="hasAnchor">
<a href="#the-likelihood-function-of-mu" class="anchor"></a>The likelihood function of <span class="math inline">\(\mu\)</span>
</h2>
<p>The likelihood is a function of <span class="math inline">\(\mu\)</span> for the data <span class="math inline">\(\mathcal D=\{y_1, y_2,\ldots, y_{15} \}\)</span>. It is defined as follows</p>
<p><span class="math display">\[\begin{align*}
L(\mu \mid \mathcal D)=&amp; f(y_1, y_2, \ldots, y_{15} \mid \mu) =
 \prod_{i=1}^{15}\, f(y_i \mid \mu) =
 \prod_{i=1}^{15}\, \frac{1}{0.1\,\sqrt{2 \pi}}\, \exp\Big\{\, \frac{-1}{2 \cdot 0.1^2}\,(y_i-\mu)^2\Big\} \\
= &amp; \, \frac{1}{(0.1\,\cdot\sqrt{2 \pi})^{15}}\,\,\exp\Big\{\, \frac{-1}{2 \cdot 0.1^2}\,\sum_{i=1}^{15}\,(y_i-\mu)^2\Big \} \\
 = &amp;\,\frac{1}{(0.1\,\cdot\sqrt{2 \pi})^{15}}\,\,\exp\Big\{\, \frac{-1}{2 \cdot 0.1^2}\,\Big(\sum_{i=1}^{15} y_i^{2} - 2 \cdot 15 \, \bar{y} \, \mu + 15 \mu^2\Big)\Big \}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(f(y_1, y_2, \ldots, y_{15} \mid \mu)\)</span> is the joint density of the <span class="math inline">\(Y_i\)</span>’s given <span class="math inline">\(\mu\)</span> evaluated in <span class="math inline">\(\mathcal D\)</span>. Since the <span class="math inline">\(Y_i\)</span>’s are <strong>conditionally independent</strong> given <span class="math inline">\(\mu\)</span>, the joint density is the product of the marginal densities. In our case, the likelihood function of <span class="math inline">\(\mu\)</span> is</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cap</span> <span class="op">&lt;-</span> <span class="st">"Likelihood function."</span>
<span class="va">Lnorm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">y</span>, <span class="va">sigma</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Essentially:</span>
  <span class="co"># prod(dnorm(y, mean = mu, sd = sigma))</span>
  <span class="co"># but we make it numerically more stable working on the log scale</span>
  <span class="co"># and we vectorise over mu</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span>
    <span class="va">mu</span>,
    <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">y</span>, mean <span class="op">=</span> <span class="va">.</span>, sd <span class="op">=</span> <span class="va">sigma</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    <span class="fl">1</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu">Lnorm</span><span class="op">(</span><span class="va">x</span>, <span class="va">hwomen</span><span class="op">$</span><span class="va">height</span>, <span class="fl">0.1</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"likelihood"</span>, 
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.4</span>, <span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkorange"</span>, lwd <span class="op">=</span> <span class="fl">4</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="p4_files/figure-html/unnamed-chunk-6-1.png" alt="Likelihood function." width="60%"><p class="caption">
Likelihood function.
</p>
</div>
</div>
<div id="the-posterior-distribution-of-mu" class="section level2">
<h2 class="hasAnchor">
<a href="#the-posterior-distribution-of-mu" class="anchor"></a>The posterior distribution of <span class="math inline">\(\mu\)</span>
</h2>
<p>The posterior distribution of <span class="math inline">\(\mu\)</span> is a Normal distribution with parameters</p>
<p><span class="math display">\[\begin{align*}
 \pi(\mu \mid \mathcal{D}) &amp; = \mathcal{N}(\mu_n,\, \sigma_n), \, \text{where}\\
 \sigma^2_n &amp; =\frac{\sigma_0^2\,\sigma^2}{\sigma^2 + n \,\sigma_0^2}=
        \frac{0.07^2 \cdot 0.1^2}{0.1^2 + 15 \cdot 0.07^2}= 0.000587,
        \leadsto \sigma_n=0.0242\\
 \mu_n &amp; = \sigma_n^2 \,\Big (\frac{\mu_0}{\sigma_0^2}\, +
       \, \frac{n \bar{y}}{\sigma^2}\Big) = 
      0.000587 \Big(\frac{1.70}{0.07^2} +\frac{15 \cdot 1.66}{0.1^2}\Big) = 1.6648 
\end{align*}\]</span></p>
<p>Next, we plot on the same graph the prior (in blue) and the posterior distribution (in green) of <span class="math inline">\(\mu\)</span> <span class="math display">\[\begin{align*}
 \pi(\mu &amp;)=\mathcal{N}(\mu_0=1.70, \sigma_0=0.07)\\
 \pi(\mu &amp;\mid \mathcal D)=\mathcal{N}(\mu_n=1.6648, \sigma_n=0.0242)
\end{align*}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fl">1.7</span>; <span class="va">s0</span> <span class="op">&lt;-</span> <span class="fl">0.07</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fl">1.6648</span>; <span class="va">s1</span> <span class="op">&lt;-</span> <span class="fl">0.0242</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m1</span>, <span class="va">s1</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"density"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.40</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m0</span>, <span class="va">s0</span><span class="op">)</span>,
  lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="p4_files/figure-html/unnamed-chunk-7-1.png" alt="Prior (blue) and posterior (green) distributions for the mean height." width="60%"><p class="caption">
Prior (blue) and posterior (green) distributions for the mean height.
</p>
</div>
<p>The visual difference between the two distributions is very clear: The posterior distribution has a very low variability compared to the prior (<span class="math inline">\(\sigma_n \approx 0.02\)</span> m vs. <span class="math inline">\(\sigma_0 =0.07\)</span> m) and is slightly shifted to the left because the posterior mean is slightly lower than the prior mean (<span class="math inline">\(\mu_n\approx 1.7\)</span> vs. <span class="math inline">\(\mu_0 = 1.7\)</span>).</p>
<p>On the basis of the posterior distribution, the two teachers now think that the mean of the height of women VIBASS students is centred on <span class="math inline">\(\mu_n\)</span> m with a standard deviation of <span class="math inline">\(\sigma_n\)</span> metres. According to it, we can compute the following percentiles and probabilities</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.995</span><span class="op">)</span>, <span class="va">m1</span>, <span class="va">s1</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.602465 1.727135</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.50</span>, <span class="fl">1.60</span>, <span class="fl">1.70</span>, <span class="fl">1.80</span>, <span class="fl">1.90</span><span class="op">)</span>, <span class="va">m1</span>, <span class="va">s1</span><span class="op">)</span>
<span class="co">#&gt; [1] 4.882741e-12 3.706635e-03 9.271024e-01 1.000000e+00 1.000000e+00</span></code></pre></div>
<p>Consequently, a 99% credible interval for <span class="math inline">\(\mu\)</span> is <span class="math inline">\((1.6, 1.73)\)</span>, which means that the probability that a VIBASS student is between 1.6 m and 1.73 m is 0.99. The probability that she is shorter than 1.50 m is <span class="math inline">\(0.0000\)</span>, the probability that her height is between 1.60 m and 1.80 m is <span class="math inline">\(1.0000-0.0040=0.9960\)</span> or the probability that is taller than 1.80 m is 0.0000.</p>
</div>
<div id="the-posterior-predictive-distribution-for-the-height-of-a-new-vibass-student" class="section level2">
<h2 class="hasAnchor">
<a href="#the-posterior-predictive-distribution-for-the-height-of-a-new-vibass-student" class="anchor"></a>The posterior predictive distribution for the height of a new VIBASS student</h2>
<p>We are interested in predicting the height of Anin`e, a new female VIBASS student who has not participated in the sample of the inferential process. In this case, the posterior predictive distribution for the Anin`e’s height <span class="math inline">\(Y_{16}\)</span> is a Normal distribution</p>
<p><span class="math display">\[\mathcal{N}(\mu_n, \sqrt{\sigma_n^2+\sigma^2}\]</span></p>
<p>with standard deviation <span class="math inline">\(\sqrt{\sigma_n^2+\sigma^2} = \sqrt{0.000587+0.01}=0.1029\)</span>.</p>
<p>It is important to note that the mean of this predictive distribution coincides with the mean of the posterior distribution of <span class="math inline">\(\mu\)</span>. However, the enormous variability of the predictive distribution, which depends on the variability of the sampling model and the variability of the a posteriori distribution, is very striking. The following figure shows the posterior distribution (in green) of <span class="math inline">\(\mu\)</span> and the posterior predictive distribution (in purple) for Anin`e’s height illustrating the previous comments.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mp</span> <span class="op">&lt;-</span> <span class="va">m1</span>; <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m1</span>, <span class="va">s1</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"density"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.40</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mp</span>, <span class="va">sp</span><span class="op">)</span>,
  lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"purple"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="p4_files/figure-html/posterior-predictive-1.png" alt="Predictive (purple) and posterior (green) distributions for the mean height." width="60%"><p class="caption">
Predictive (purple) and posterior (green) distributions for the mean height.
</p>
</div>
<p>We can calculate prediction intervals for the height of Anin`e. A prediction interval at 95 <span class="math inline">\(%\)</span> would be</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="fl">1.6642</span>, <span class="fl">0.1029</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.46252 1.86588</span></code></pre></div>
<p>This indicates that the probability that Anin`e’s height is between 1.46 and 1.87 metres is 0.95.</p>
</div>
</div>
<div id="bayesian-inference-for-the-mean-height-of-the-women-vibass-students--the-variance-of-the-sampling-normal-model-is-unknown-" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesian-inference-for-the-mean-height-of-the-women-vibass-students--the-variance-of-the-sampling-normal-model-is-unknown-" class="anchor"></a>Bayesian inference for the mean height of the women VIBASS students. The variance of the sampling Normal model is unknown.</h1>
<p>If we follow the same scheme as in the previous case where the variance was known, we would have a first section dedicated to the data which would be the same. The sampling model is also approximately Normal but now we will work with a Normal with unknown mean and variance.</p>
<div id="the-sampling-model-is-approximately-normal-1" class="section level2">
<h2 class="hasAnchor">
<a href="#the-sampling-model-is-approximately-normal-1" class="anchor"></a>The sampling model is approximately Normal</h2>
<p>Let <span class="math inline">\(Y\)</span> the random variable that describes the height of the women in VIBASS. We assume that the distribution of <span class="math inline">\(Y\)</span> is Normal with unknown mean <span class="math inline">\(\mu\)</span> and unknown standard deviation <span class="math inline">\(\sigma\)</span></p>
<p><span class="math display">\[Y \mid \mu \sim \mathcal{N}(\mu,\, \sigma),\]</span> whose conditional density function, expectation and variance are:</p>
<ul>
<li><span class="math inline">\(f(y \mid \mu )= \frac{1}{\sigma \,\sqrt{2 \pi}}\, \mbox{e}^{\big\{ -\frac12 \big(\frac{y-\mu}{\sigma}\big)^2\big\}}\)</span></li>
<li>
<span class="math inline">\(\text{E}(Y\mid \mu)= \mu\)</span>,</li>
<li><span class="math inline">\(\text{Var}(Y\mid \mu)=\sigma^2.\)</span></li>
</ul>
</div>
<div id="a-prior-distribution-for-mu-sigma2" class="section level2">
<h2 class="hasAnchor">
<a href="#a-prior-distribution-for-mu-sigma2" class="anchor"></a>A prior distribution for <span class="math inline">\((\mu,\, \sigma^2)\)</span>
</h2>
<p>Our basic quantity of interest is bi-dimensional <span class="math inline">\((\mu,\, \sigma^2)\)</span>. We work in a non-informative prior scenario and use the improper reference prior distribution</p>
<p><span class="math display">\[\pi(\mu,\, \sigma^2) \propto 1/\sigma^2\]</span></p>
</div>
<div id="the-likelihood-function-of-mu-sigma2" class="section level2">
<h2 class="hasAnchor">
<a href="#the-likelihood-function-of-mu-sigma2" class="anchor"></a>The likelihood function of <span class="math inline">\((\mu,\, \sigma^2)\)</span>
</h2>
<p>The likelihood is a function of <span class="math inline">\((\mu,\, \sigma^2)\)</span> for the data <span class="math inline">\(\mathcal D=\{y_1, y_2,\ldots, y_{15} \}\)</span>. It is defined as follows</p>
<p><span class="math display">\[\begin{align*}
L(\mu,\, \sigma^2 \mid \mathcal D)=&amp; f(y_1, y_2, \ldots, y_{15} \mid \mu,\, \sigma^2) =
 \prod_{i=1}^{15}\, f(y_i \mid \mu,\, \sigma^2) =
 \prod_{i=1}^{15}\, \frac{1}{\sigma \,\sqrt{2 \pi}}\, \exp\Big\{\, \frac{-1}{2\sigma^2}\,(y_i-\mu)^2\Big\} \\
= &amp; \, \frac{1}{(\sigma\,\sqrt{2 \pi})^{15}}\,\,\exp\Big\{\, \frac{-1}{2\sigma^2}\,\sum_{i=1}^{15}\,(y_i-\mu)^2\Big \} \\
 = &amp;\,\frac{1}{(\sigma\,\sqrt{2 \pi})^{15}}\,\,\exp\Big\{\, \frac{-1}{2  \sigma^2}\,\big(
 \sum_{i=1}^{15} y_i^{2} - 2 \cdot 15 \, \bar{y} \, \mu + 15 \mu^2
 \big) \Big\},
\end{align*}\]</span></p>
<p>where <span class="math inline">\(f(y_1, y_2, \ldots, y_{15})\)</span> is the joint density of the <span class="math inline">\(Y_i\)</span>’s given <span class="math inline">\(\mu\)</span> evaluated in <span class="math inline">\(\mathcal D\)</span>. Since <span class="math inline">\(Y_i\)</span>’s are independent given <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>, the joint density is the product of the marginal densities. In our case, the graphic of the likelihood function of <span class="math inline">\((\mu,\, \sigma^2)\)</span> will be</p>
<div class="figure">
<div id="htmlwidget-8da51ccb202e6278adb3" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8da51ccb202e6278adb3">{"x":{"visdat":{"89951b9a888":["function () ","plotlyVisDat"]},"cur_data":"89951b9a888","attrs":{"89951b9a888":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"type":"surface","x":{},"y":{},"showscale":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":{"text":"μ"}},"yaxis":{"title":{"text":"σ²"}},"zaxis":{"visible":false,"title":"t(matrix(surf_lik$z, length(mu_vals), length(s_vals)))"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"t(matrix(surf_lik$z, length(mu_vals), length(s_vals)))","ticklen":2},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"z":[[0.064896286641074,0.463801691617997,3.10092915230851,19.3953845208311,113.488532109421,621.230254331311,3181.26796192166,15240.3499737407,68302.5099054409,286368.615830443,1123210.64897432,4121393.09131592,14147310.9689845,45430842.979533,136481794.918357,383570934.000332,1008471639.13448,2480439981.1287,5707432595.38379,12285699653.2964,24740360939.9946,46607864338.4304,82140891031.4854,135427434237.871,208881956197.34,301399297737.101,406846496647.645,513766709327.516,606943651847.776,670776472932.791,693512517625.077,670776472932.781,606943651847.763,513766709327.5,406846496647.625,301399297737.081,208881956197.324,135427434237.86,82140891031.4778,46607864338.4254,24740360939.9916,12285699653.2948,5707432595.38297,2480439981.12833,1008471639.13431,383570934.000264,136481794.918331,45430842.9795237,14147310.9689815,4121393.09131501,1123210.64897405,286368.615830372,68302.5099054234,15240.3499737366,3181.26796192076,621.23025433113,113.488532109386,19.3953845208247,3.10092915230747,0.463801691617839,0.0648962866410509,0.0084948242996582,0.00104024584237254,0.000119169361170425,1.27714517895611e-05,1.28045098908324e-06,1.2009714577654e-07,1.05377877488225e-08,8.64994292860798e-10,6.64238542283869e-11,4.77179674015685e-12,3.20691046612203e-13,2.01622394603547e-14,1.18587178546819e-15,6.52504842105013e-17,3.35874301183104e-18],[20.0349478819839,112.842581989563,599.391900874235,3002.62975218439,14185.5361392045,63203.7407671055,265578.472970367,1052436.77106478,3933256.01250265,13863135.7085621,46081201.2468075,144457191.313089,427078392.244083,1190773303.31388,3131148298.45998,7764817324.22776,18159835337.0653,40053975451.1747,83316766363.3116,163445226940.615,302388406655.128,527607655503.389,868180641894.694,1347293347086.74,1971820103882.89,2721607373227.69,3542719054514.33,4349116198969.9,5035219030471.78,5497798018541.25,5661248929567.17,5497798018541.19,5035219030471.68,4349116198969.78,3542719054514.17,2721607373227.54,1971820103882.76,1347293347086.64,868180641894.623,527607655503.338,302388406655.096,163445226940.596,83316766363.3012,40053975451.1694,18159835337.0627,7764817324.22655,3131148298.45947,1190773303.31367,427078392.244003,144457191.31306,46081201.246798,13863135.7085591,3933256.01250178,1052436.77106452,265578.472970301,63203.7407670893,14185.5361392006,3002.62975218354,599.39190087406,112.842581989529,20.0349478819776,3.3547215375402,0.529758330156281,0.0788954885375506,0.0110810165302479,0.0014677770519916,0.000183355373367361,2.16013178780245e-05,2.4000479125093e-06,2.51485316637051e-07,2.48518321869607e-08,2.31609969430035e-09,2.03567828446003e-10,1.68738465809605e-11,1.31908294783007e-12,9.72485587800974e-14],[2082.52533660351,9628.45840011136,42265.108362425,176143.239423975,696961.414860825,2618244.83540192,9338358.43816618,31622018.4423321,101664048.312462,310315861.969223,899289070.182205,2474306059.7632,6463478169.74715,16030162239.1427,37745772083.0527,84383487904.4404,179104045585.46,360920942588.781,690522022631.465,1254300943490.7,2163140496266.93,3541819874858.11,5505882986949.65,8126176445120.04,11386867904345.4,15148899381370.5,19134479079394.3,22946210308852.5,26125466855282,28240729698245.6,28983213238980,28240729698245.4,26125466855281.4,22946210308851.8,19134479079393.5,15148899381369.8,11386867904344.8,8126176445119.52,5505882986949.24,3541819874857.82,2163140496266.72,1254300943490.58,690522022631.389,360920942588.739,179104045585.437,84383487904.4287,37745772083.0472,16030162239.1402,6463478169.74607,2474306059.76277,899289070.182039,310315861.969164,101664048.312442,31622018.4423253,9338358.43816412,2618244.83540132,696961.414860661,176143.23942393,42265.1083624142,9628.45840010883,2082.52533660293,427.64420695437,83.3745795061174,15.4327557874703,2.71213981915816,0.452521720920397,0.0716845476468752,0.0107812826493079,0.00153948009774837,0.000208706747227076,2.68631949687437e-05,3.2827484329633e-06,3.80869595926249e-07,4.19540384178003e-08,4.38763004641207e-09,4.35657300488068e-10],[92745.937777612,363436.519087215,1359740.41361212,4857101.96878277,16565029.376954,53938761.9309775,167688589.270424,497736881.483307,1410554620.11401,3816574700.1763,9859420746.7255,24317717426.3789,57264831727.1477,128749912964.104,276375584049.515,566429908204.126,1108374316813.66,2070715836708.81,3693586975744.26,6290279299379.04,10227872428235.8,15877950715818.6,23534087872497.9,33303821165239.5,44997101025336.6,58045529597774.8,71490246585174.8,84065652086753.6,94380907985123.8,101168075866405,103537244619365,101168075866404,94380907985122.5,84065652086751.2,71490246585172.2,58045529597772.3,44997101025334.4,33303821165237.6,23534087872496.4,15877950715817.5,10227872428235,6290279299378.46,3693586975743.89,2070715836708.6,1108374316813.53,566429908204.056,276375584049.478,128749912964.086,57264831727.1392,24317717426.3751,9859420746.72385,3816574700.17565,1410554620.11376,497736881.483213,167688589.27039,53938761.9309663,16565029.3769505,4857101.9687817,1359740.41361181,363436.51908713,92745.9377775889,22597.2194595386,5256.64784943683,1167.4990571524,247.569971711461,50.122551362814,9.68862498380404,1.78807156386434,0.315065914196737,0.0530043751924853,0.00851364999526437,0.00130561051275336,0.000191163625616722,2.67233348284877e-05,3.56672660731309e-06,4.5450928945075e-07],[2115924.01757584,7208445.88178861,23557963.2134032,73856438.1398394,222122985.456852,640845247.185271,1773647684.9223,4709079993.76546,11993869036.8283,29304685156.2488,68686176269.751,154438702135.455,333117515998.253,689276256184.249,1368181426216.98,2605245084809.16,4758915604135.27,8339153031914.34,14018140460034.6,22605462332093.4,34969619205075.6,51894691615679.8,73877040734511.8,100890568427033,132174041589673,166110197251885,200263102876187,231611495422425,256964898954156,273490357535410,279231723894432,273490357535408,256964898954153,231611495422421,200263102876180,166110197251878,132174041589666,100890568427028,73877040734507.6,51894691615676.3,34969619205073,22605462332091.6,14018140460033.3,8339153031913.57,4758915604134.78,2605245084808.87,1368181426216.82,689276256184.163,333117515998.208,154438702135.434,68686176269.7407,29304685156.2443,11993869036.8264,4709079993.76467,1773647684.92198,640845247.185155,222122985.45681,73856438.1398244,23557963.2133983,7208445.88178708,2115924.01757538,595817.173673448,160946.111615976,41706.3788041813,10367.6183341808,2472.35050968694,565.582033328595,124.11826359791,26.1294519314289,5.27690690669129,1.02231112669995,0.189994603462168,0.033873023736777,0.0057932355926066,0.000950479899477732,0.000149595733160082],[28293350.5758957,85530823.099018,249043309.495987,698459234.188348,1886779742.76112,4909251744.88751,12303349422.4482,29699242370.6235,69052807369.1534,154643355906.361,333576270405.52,693063437965.936,1386962712062.89,2673440600002.41,4963525413417.74,8876135377998.9,15288734608442,25364898187018.4,40532991891316.5,62387582494969.4,92491454558043.3,132074513178274,181656266747412,240655453514556,307082443486674,377422880251540,446802318853087,509467599088240,559540693546918,591916902181280,603120045349211,591916902181276,559540693546910,509467599088229,446802318853074,377422880251527,307082443486661,240655453514544,181656266747403,132074513178266,92491454558036.7,62387582494965,40532991891313.2,25364898187016.2,15288734608440.6,8876135377998.02,4963525413417.21,2673440600002.11,1386962712062.72,693063437965.848,333576270405.475,154643355906.34,69052807369.1434,29699242370.6189,12303349422.4462,4909251744.88671,1886779742.76079,698459234.188221,249043309.495941,85530823.0990016,28293350.5758901,9014882.43077382,2766621.26306274,817811.683264486,232847.118408815,63856.0987044982,16867.3886836599,4291.48185499586,1051.67285754751,248.237853448925,56.437699893267,12.3590349811534,2.60683638478675,0.529610934966575,0.103636817918547,0.0195337287718993],[245791062.47595,670405796.898019,1767410837.85883,4503657398.24188,11092291039.0269,26406159697.9158,60759936835.97,135131768593.31,290486321318.825,603562142558.825,1212122115688.82,2352874904827.85,4414478225681.11,8005491471515.59,14032165498556.4,23773300287331.5,38929814365467.3,61617385734117.6,94265393069894.4,139389280405486,199220739645457,275212274209801,367476125668815,474262228398604,591610706713933,713315385486696,831295130634056,936390417324010,1.01949890467724e+15,1.07286393202787e+15,1.09126595350627e+15,1.07286393202787e+15,1.01949890467722e+15,936390417323990,831295130634038,713315385486671,591610706713912,474262228398584,367476125668800,275212274209785,199220739645444,139389280405477,94265393069887.7,61617385734112.7,38929814365464.1,23773300287329.4,14032165498555.1,8005491471514.76,4414478225680.62,2352874904827.58,1212122115688.67,603562142558.748,290486321318.787,135131768593.292,60759936835.9612,26406159697.9119,11092291039.0252,4503657398.24113,1767410837.85854,670405796.897902,245791062.475905,87100869.7558166,29833690.1863672,9876874.55597035,3160531.90851052,977527.310049539,292230.605936743,84440.4572710269,23583.2433952817,6366.26289472498,1661.09198723111,418.919789450735,102.116553516417,24.0596607711946,5.47912148102692,1.20603646268914],[1502421805.49929,3748420463.40956,9066615165.12891,21260943086.0278,48334844718.8773,106531634596.561,227634096559.558,471559499141.697,947057050602.108,1843980167541.07,3480781886085.96,6369976570230.91,11301584067663.1,19439328782235.9,32416316999908.9,52406666575794.2,82139085353551.1,124811225899135,183864504401620,262592671994183,363586516774689,488060203777879,635154653912159,801356995653074,980196259321349,1.16235960663513e+15,1.33631375302027e+15,1.48941878547901e+15,1.60940622374041e+15,1.68598996759976e+15,1.71231931639819e+15,1.68598996759976e+15,1.60940622374039e+15,1.48941878547899e+15,1.33631375302024e+15,1.16235960663509e+15,980196259321314,801356995653040,635154653912128,488060203777855,363586516774668,262592671994166,183864504401608,124811225899126,82139085353544.7,52406666575789.7,32416316999906,19439328782234,11301584067661.9,6369976570230.25,3480781886085.56,1843980167540.86,947057050601.997,471559499141.639,227634096559.528,106531634596.546,48334844718.8703,21260943086.0246,9066615165.12749,3748420463.40898,1502421805.49904,583815896.98639,219938072.660459,80327707.7097926,28442698.1861506,9763750.48223482,3249398.77123577,1048406.75820517,327942.02345201,99450.0011447403,29238.3575829889,8333.77199183987,2302.87685774479,616.936232512801,160.232385651161,40.3460275647505],[6878982550.01418,15878320492.423,35626268045.2261,77700087935.7447,164724463274.676,339453353642.781,679966501641.475,1323976704389.35,2505870255949.83,4610226156100.08,8244632295632.15,14331965818652.1,24217295879824.1,39776900936410.5,63507007838021.2,98559336328209.4,148682310466968,218024974191984,310769649466700,430582488878066,579908589208409,759185894563400,966100109370544,1.19503752812233e+15,1.43689941493383e+15,1.67940949315958e+15,1.9079731170239e+15,2.10704257200136e+15,2.26182906884811e+15,2.36010684128553e+15,2.39380603728759e+15,2.36010684128551e+15,2.26182906884808e+15,2.10704257200133e+15,1.90797311702387e+15,1.67940949315953e+15,1.43689941493377e+15,1.1950375281223e+15,966100109370503,759185894563362,579908589208380,430582488878042,310769649466683,218024974191970,148682310466957,98559336328202.4,63507007838016.1,39776900936407.1,24217295879821.8,14331965818650.7,8244632295631.3,4610226156099.6,2505870255949.55,1323976704389.2,679966501641.393,339453353642.739,164724463274.655,77700087935.7339,35626268045.2211,15878320492.4207,6878982550.01316,2896871716.66625,1185822621.81782,471840928.944847,182497492.243057,68612556.8353993,25074698.3819641,8907446.9295395,3075786.46148963,1032391.76134624,336835.836807547,106826.122127058,32932.298831486,9868.52040439606,2874.53400691513,813.89479301698],[24790607481.1103,53447187536.5792,112267174539.83,229758176855.692,458120164451.892,889975574084.472,1684484482436.23,3106319977318.8,5581046136711.62,9769566278265.73,16661926036976.4,27686328586401.8,44822469805978.6,70699516810701.3,108649405883441,162677883679196,237312120425245,337288530797887,467060860688854,630137934151406,828300688246590,1.06079305435013e+15,1.32362073100902e+15,1.60911358577457e+15,1.90589991406532e+15,2.19939750069488e+15,2.47284907988107e+15,2.70882996077482e+15,2.89105347388222e+15,3.00621995167256e+15,3.04561939073763e+15,3.00621995167254e+15,2.8910534738822e+15,2.70882996077478e+15,2.47284907988101e+15,2.19939750069483e+15,1.90589991406526e+15,1.60911358577451e+15,1.32362073100897e+15,1.06079305435008e+15,828300688246549,630137934151370,467060860688828,337288530797868,237312120425231,162677883679185,108649405883432,70699516810695.8,44822469805975,27686328586399.2,16661926036974.8,9769566278264.76,5581046136711.06,3106319977318.46,1684484482436.04,889975574084.371,458120164451.837,229758176855.663,112267174539.815,53447187536.5721,24790607481.1069,11203139118.8667,4932675395.84329,2115999654.74901,884379966.355342,360124316.871633,142875001.10028,55226852.6739015,20798623.2888905,7631486.35063974,2728185.66445362,950230.489282944,322458.810531898,106612.906175172,34342.7892079152,10778.3329298762],[73165080614.6401,148519797575.491,294334909324.093,569476926307.17,1075690722047.42,1983698412305.55,3571418969900.33,6277444603389.54,10772138016401.8,18046702613195.7,29516900198162.6,47132509571798.9,73476306035344,111828113034663,166161961997874,241040022310496,341368653074179,471992448908016,637123164267850,839631401152700,1.08026643350298e+15,1.35690681468024e+15,1.66397232125451e+15,1.99213655476e+15,2.32846140533666e+15,2.65702668072234e+15,2.9600545830904e+15,3.21944089182035e+15,3.41851999837742e+15,3.5438287426641e+15,3.58661086693745e+15,3.5438287426641e+15,3.41851999837742e+15,3.21944089182033e+15,2.96005458309036e+15,2.65702668072228e+15,2.3284614053366e+15,1.99213655475995e+15,1.66397232125445e+15,1.35690681468018e+15,1.08026643350294e+15,839631401152664,637123164267818,471992448907989,341368653074159,241040022310480,166161961997863,111828113034654,73476306035338.2,47132509571795.1,29516900198160,18046702613194.2,10772138016400.8,6277444603388.92,3571418969899.96,1983698412305.34,1075690722047.3,569476926307.105,294334909324.057,148519797575.473,73165080614.6308,35188462759.4818,16522420328.712,7573976799.99384,3389621510.58223,1481001082.72661,631737238.195917,263084045.389228,106961990.817068,42456225.0097538,16452435.9011412,6224378.17220262,2298998.38969919,829007.186791674,291846.746672185,100306.332074659],[182590840573.629,351367823358.572,661314852694.161,1217356708568.85,2191748500566.66,3859462903896.76,6647009690815.27,11196674192704.2,18446545960605.9,29723802269924,46844321945637.3,72205925456607.5,108855908915723,160507180616780,231472931695763,326489520659559,450403304829781,607711113852261,801966223197316,1.03509035981571e+15,1.30666343609743e+15,1.61329022122927e+15,1.94815968714391e+15,2.30091137655274e+15,2.65789927450896e+15,3.00289698526804e+15,3.31822352031967e+15,3.58619688465519e+15,3.7907566772388e+15,3.91905155323357e+15,3.96277425084485e+15,3.91905155323357e+15,3.79075667723877e+15,3.58619688465514e+15,3.31822352031959e+15,3.00289698526797e+15,2.6578992745089e+15,2.30091137655268e+15,1.94815968714384e+15,1.61329022122922e+15,1.30666343609737e+15,1.03509035981567e+15,801966223197276,607711113852231,450403304829756,326489520659540,231472931695749,160507180616770,108855908915715,72205925456602.4,46844321945633.6,29723802269921.6,18446545960604.3,11196674192703.2,6647009690814.61,3859462903896.37,2191748500566.44,1217356708568.72,661314852694.088,351367823358.532,182590840573.607,92802414504.5454,46132060359.9066,22428989912.2381,10665466789.9273,4960361271.00927,2256368542.85896,1003852842.07328,436810789.84547,185900239.92215,77380197.0183336,31502353.4686254,12543520.8855074,4884939.64811199,1860639.49750347,693152.12242221],[395485193430.445,725680063407.761,1304439840708.44,2297030792594.44,3962538355979.88,6696440904175.65,11086092593581.3,17979469038086.2,28565321892171.6,44459572457537.6,67788393416085.5,101253326487029,148158699895180,212377701509686,298232228480682,410264680813650,552888538774637,729919461698149,944009139437043,1.19602801973589e+15,1.48446652582458e+15,1.80494246669868e+15,2.14990968915519e+15,2.50865517791386e+15,2.86764656113483e+15,3.21125043246715e+15,3.52278896927758e+15,3.78584630978808e+15,3.9856873705098e+15,4.11062047538781e+15,4.15312910032223e+15,4.11062047538781e+15,3.98568737050977e+15,3.78584630978803e+15,3.52278896927753e+15,3.21125043246708e+15,2.86764656113477e+15,2.50865517791381e+15,2.14990968915513e+15,1.80494246669861e+15,1.48446652582452e+15,1.19602801973584e+15,944009139437003,729919461698118,552888538774609,410264680813626,298232228480663,212377701509673,148158699895170,101253326487022,67788393416080.4,44459572457534.3,28565321892169.3,17979469038084.6,11086092593580.3,6696440904175.03,3962538355979.5,2297030792594.21,1304439840708.31,725680063407.686,395485193430.401,211144204237.795,110431253193.458,56580754702.5767,28399413482.8862,13964130710.4978,6726394568.94141,3174056644.17713,1467272932.59767,664463361.044921,294778001.972737,128109991.564659,54542474.0769983,22748384.7367852,9294589.1024795,3720263.70352905],[759519461606.17,1335550988624.81,2303948855632.29,3899204288365.41,6473958918153.16,10545196654986.2,16851176273502.6,26417794305377.3,40630641702896.6,61305805481058.9,90748680424836.6,131786167642609,187754404281466,262422598885791,359834769570469,484056228774734,638821162625616,827091525692321,1.05055463143108e+15,1.30910507554875e+15,1.60037281658334e+15,1.91936963408048e+15,2.2583272120659e+15,2.60678918193997e+15,2.95199587809155e+15,3.2795660186782e+15,3.57443828612636e+15,3.8219941941389e+15,4.0092490698525e+15,4.12597740752648e+15,4.16563725172054e+15,4.12597740752648e+15,4.00924906985247e+15,3.82199419413888e+15,3.57443828612631e+15,3.27956601867813e+15,2.95199587809149e+15,2.60678918193989e+15,2.25832721206585e+15,1.91936963408043e+15,1.60037281658328e+15,1.30910507554869e+15,1.05055463143103e+15,827091525692286,638821162625584,484056228774710,359834769570449,262422598885776,187754404281454,131786167642601,90748680424830.8,61305805481054.5,40630641702893.7,26417794305375.2,16851176273501.3,10545196654985.3,6473958918152.59,3899204288365.05,2303948855632.08,1335550988624.68,759519461606.092,423748461315.724,231935996429.506,124542899600.444,65608571734.9543,33907282810.896,17191595657.1559,8551261390.20299,4172871105.02932,1997701301.76031,938246449.181229,432308824.561864,195416876.032827,86660427.3268369,37702520.1315275,16092026.1317861],[1316343630938.91,2227806013396.47,3703730945246.42,6048608163986.58,9703433532207.06,15291475111638.8,23671582470792,35996407909124.3,53770614544086.1,78901416197094.7,113730921922317,161037227056941,223989660071207,306043824476906,410764812299465,541572755794603,701413866181117,892371822261317,1.1152476392525e+15,1.36914908221077e+15,1.651140877897e+15,1.95601185342031e+15,2.27621246820706e+15,2.60200469827183e+15,2.9218459708383e+15,3.22300160657161e+15,3.49234941536486e+15,3.71731033428217e+15,3.88681537407542e+15,3.99220622578523e+15,4.02796776340098e+15,3.9922062257852e+15,3.8868153740754e+15,3.71731033428214e+15,3.49234941536482e+15,3.22300160657156e+15,2.92184597083826e+15,2.60200469827176e+15,2.27621246820701e+15,1.95601185342026e+15,1.65114087789694e+15,1.36914908221072e+15,1.11524763925246e+15,892371822261286,701413866181082,541572755794576,410764812299445,306043824476891,223989660071194,161037227056931,113730921922310,78901416197089.3,53770614544082.3,35996407909121.6,23671582470790.3,15291475111637.6,9703433532206.27,6048608163986.06,3703730945246.1,2227806013396.27,1316343630938.78,764038325195.818,435627185481.023,243988168745.148,134238324694.934,72550137925.1819,38517130428.1066,20087392650.8747,10290753522.6161,5178747620.76995,2560096170.9102,1243202217.67826,593036242.158936,277891112.253509,127915166.881048,57839348.0895385],[2089252407317.32,3416009198887.18,5492991290552.63,8686814507261.18,13510578467801.3,20665651388459.1,31087515326426.3,45992252978972.7,66918333223353.7,95756288499455.8,134756974707941,186507782755442,253865932315146,339839337377840,447408912184609,579291787922325,737652590219571,923779095389738,1.13774817418798e+15,1.37811646966712e+15,1.64167603054213e+15,1.9233164682832e+15,2.2160308490137e+15,2.51109192850824e+15,2.79840894894586e+15,3.0670546074737e+15,3.30592955129359e+15,3.50451109595948e+15,3.65361719729653e+15,3.74610895699621e+15,3.77745696693404e+15,3.74610895699621e+15,3.6536171972965e+15,3.50451109595945e+15,3.30592955129354e+15,3.06705460747365e+15,2.7984089489458e+15,2.51109192850819e+15,2.21603084901366e+15,1.92331646828315e+15,1.64167603054209e+15,1.37811646966707e+15,1.13774817418793e+15,923779095389706,737652590219539,579291787922297,447408912184590,339839337377821,253865932315134,186507782755431,134756974707932,95756288499449.6,66918333223349.5,45992252978969.8,31087515326424.1,20665651388457.6,13510578467800.2,8686814507260.47,5492991290552.16,3416009198886.89,2089252407317.14,1256679555123.08,743395532123.118,432491027771.951,247454876394.132,139244063757.01,77058246282.5202,41939506046.7449,22448599917.96,11817264803.785,6117957186.74477,3114997182.63343,1559806197.41974,768148847.92406,372033359.664379,177206702.173085],[3074177391034.56,4871954575394.81,7601490315883.14,11676574985716.3,17658483696481,26291329904513.9,38538331729960.5,55615324643464.9,79016402421043.9,110525181927253,152204129037589,206353975440476,275435843382979,361950583830293,468273215096168,596445220462736,747933556158898,923371963575564,1.12230670981364e+15,1.34297412386243e+15,1.58214010811133e+15,1.83503117018496e+15,2.09538176907048e+15,2.35561378046335e+15,2.60715121826645e+15,2.8408582661145e+15,3.04757303284143e+15,3.21869545753828e+15,3.34677766638768e+15,3.4260606535268e+15,3.45290350959295e+15,3.42606065352678e+15,3.34677766638765e+15,3.21869545753826e+15,3.04757303284141e+15,2.84085826611446e+15,2.60715121826641e+15,2.35561378046332e+15,2.09538176907044e+15,1.83503117018492e+15,1.58214010811128e+15,1.34297412386239e+15,1.1223067098136e+15,923371963575531,747933556158871,596445220462711,468273215096148,361950583830277,275435843382965,206353975440466,152204129037580,110525181927246,79016402421039.4,55615324643461.4,38538331729958,26291329904512.1,17658483696479.7,11676574985715.4,7601490315882.54,4871954575394.43,3074177391034.29,1909746962784.46,1168002955591.79,703288094258.021,416911427346.907,243318730959.912,139806864677.221,79086555306.5615,44045143911.3874,24149859963.6346,13036241887.1864,6928056384.60462,3624863247.4148,1867209508.10642,946925219.857588,472780468.49156],[4237013650636.21,6527262260163.87,9909244094690.19,14824779921168,21856179438935.4,31754004699692,45463307334578.2,64144852720500.7,89186857689224.8,122201961682687,165003728135916,219557158028651,287898703240954,372023249009803,473738541079182,594491459193517,735175093586086,895930281980958,1.07595946535443e+15,1.27337368173694e+15,1.48509451163232e+15,1.70683123190031e+15,1.93314901916763e+15,2.15763684744695e+15,2.37317427233511e+15,2.57228554463146e+15,2.74755874803206e+15,2.89209837704353e+15,2.9999733773927e+15,3.06662028457163e+15,3.08916333670635e+15,3.06662028457161e+15,2.99997337739267e+15,2.89209837704351e+15,2.74755874803204e+15,2.57228554463142e+15,2.37317427233506e+15,2.1576368474469e+15,1.93314901916759e+15,1.70683123190027e+15,1.48509451163228e+15,1.2733736817369e+15,1.07595946535439e+15,895930281980932,735175093586060,594491459193492,473738541079161,372023249009787,287898703240941,219557158028640,165003728135908,122201961682680,89186857689219.8,64144852720496.6,45463307334575.3,31754004699689.9,21856179438933.9,14824779921167,9909244094689.48,6527262260163.38,4237013650635.88,2710359680885.04,1708567958365.93,1061392101352.51,649767087914.769,391992567299.707,233043084244.061,136531502922.853,78825691058.6022,44847781779.9456,25145044701.9801,13893194676.663,7564671876.37726,4058974593.92095,2146252605.89465,1118365090.96732],[5517804531400.75,8283918783861.21,12266575482412.4,17915495374713,25807877528165.1,36668550214606.5,51386989098174.3,71028163690678.7,96833579080729.1,130208508375852,172691406143915,225901996965292,291465661668284,370913555743472,465560361865967,576364562753895,703779361333952,847605498118178,1.00685976375202e+15,1.17967449234428e+15,1.36324330758615e+15,1.55382656493516e+15,1.74682618004528e+15,1.93693400878841e+15,2.11835108406629e+15,2.28506751572006e+15,2.4311856066692e+15,2.55126268891422e+15,2.64064622775515e+15,2.69577255998784e+15,2.71440256598538e+15,2.69577255998784e+15,2.64064622775513e+15,2.55126268891418e+15,2.43118560666918e+15,2.28506751572004e+15,2.11835108406626e+15,1.93693400878838e+15,1.74682618004524e+15,1.55382656493512e+15,1.36324330758612e+15,1.17967449234425e+15,1.00685976375199e+15,847605498118154,703779361333927,576364562753874,465560361865950,370913555743456,291465661668271,225901996965283,172691406143906,130208508375846,96833579080724.2,71028163690674.7,51386989098171.2,36668550214604.4,25807877528163.5,17915495374711.8,12266575482411.6,8283918783860.62,5517804531400.35,3625056442453.15,2348990264166.47,1501293633535.69,946385442798.828,588421377307.69,360850087883.534,218264533185.62,130213948647.785,76621355184.7288,44469283447.1352,25455897665.9048,14372578311.3817,8003849857.88698,4396237688.91501,2381668865.72167],[6840058590020.95,10030011660328,14518031855967.7,20743342734654.6,29255965295823.7,40730037712046.5,55973167378999.7,75929343556126.4,101672639470780,134388851414153,175342452656953,225826863672199,287097109410379,360285453417879,446302507229663,545728476849852,658701416329406,784811338843018,923010479381416,1.07155060430534e+15,1.22795776657457e+15,1.38905315737326e+15,1.55102569522613e+15,1.70955788454268e+15,1.86000160492582e+15,1.9975953508143e+15,2.11770961854708e+15,2.21610325046271e+15,2.28917114660753e+15,2.33416324868248e+15,2.34935627342407e+15,2.33416324868248e+15,2.28917114660752e+15,2.21610325046269e+15,2.11770961854705e+15,1.99759535081427e+15,1.8600016049258e+15,1.70955788454265e+15,1.55102569522609e+15,1.38905315737323e+15,1.22795776657454e+15,1.07155060430531e+15,923010479381389,784811338842995,658701416329387,545728476849833,446302507229647,360285453417863,287097109410366,225826863672189,175342452656945,134388851414147,101672639470775,75929343556122.3,55973167378996.5,40730037712044.1,29255965295821.9,20743342734653.3,14518031855966.8,10030011660327.4,6840058590020.48,4604504445813.85,3059642342184.48,2006887922037.35,1299392234739.54,830466476280.299,523924413108.567,326272038452.68,200565286393.334,121701623199.74,72895658643.2761,43099442150.4558,25153957604.6656,14491244739.021,8240807108.4169,4625924041.87576],[8122306226912.05,11656204597741.9,16524071781053.6,23139772897873.9,32009819124404.8,43741075408351.7,59044275892809.6,78731450705957.1,103705267286506,134938377811548,173441197344629,220217155933276,276205386839243,342212010408685,418832582149007,506369780132284,604751853007157,713458546215984,831461969622223,957189979133796,1.08851897809714e+15,1.22280153609421e+15,1.35693190615202e+15,1.48744953913432e+15,1.61067729607331e+15,1.72288758232083e+15,1.82048645968906e+15,1.90020332532317e+15,1.95927231935843e+15,1.99559147602604e+15,2.00784686122532e+15,1.99559147602604e+15,1.95927231935843e+15,1.90020332532317e+15,1.82048645968905e+15,1.72288758232082e+15,1.61067729607328e+15,1.4874495391343e+15,1.35693190615201e+15,1.22280153609418e+15,1.08851897809712e+15,957189979133776,831461969622205,713458546215963,604751853007140,506369780132270,418832582148992,342212010408671,276205386839231,220217155933266,173441197344620,134938377811541,103705267286501,78731450705953.2,59044275892806.5,43741075408349.3,32009819124402.9,23139772897872.6,16524071781052.6,11656204597741.2,8122306226911.51,5590924981253.98,3801632038974.78,2553516106742.97,1694295793029.84,1110508716594.11,719013127106.557,459868619770.378,290544621243.982,181331816741.74,111793690687.735,68083626963.0569,40959078894.6741,24341076867.5481,14289318042.0833,8286389163.00758],[9289036205581.43,13069352523405.9,18176528126598.1,24988560381754.8,33958225192669.9,45616522538655.9,60572124898793.6,79505447618989.2,103155979775868,132301684316770,167729627118689,210197542061970,260386778546528,318847978162478,385941828188546,461778252115374,546158308569818,638523753077711,737919545766524,842974454057077,951904230684760,1.0625406250561e+15,1.17238775576153e+15,1.27870524879628e+15,1.37861520828852e+15,1.46922776159421e+15,1.54777786040483e+15,1.61176447017992e+15,1.65908244949772e+15,1.68813744799371e+15,1.69793508422734e+15,1.6881374479937e+15,1.65908244949771e+15,1.61176447017991e+15,1.54777786040482e+15,1.46922776159419e+15,1.37861520828851e+15,1.27870524879626e+15,1.17238775576151e+15,1.06254062505608e+15,951904230684739,842974454057059,737919545766504,638523753077692,546158308569803,461778252115361,385941828188532,318847978162467,260386778546519,210197542061962,167729627118682,132301684316764,103155979775863,79505447618985.8,60572124898790.6,45616522538653.5,33958225192668.2,24988560381753.4,18176528126597,13069352523405.2,9289036205580.83,6526204558397.07,4532357436269.6,3111437388083.67,2111404404440.34,1416299897751.56,939101356611.739,615521398271.587,398792779722.551,255402333719.196,161687289028.85,101181320030.575,62589033625.7883,38270981005.7599,23132064084.9118,13820782179.6436],[10278993084399.8,14201263510774.9,19406395398723.1,26230359509126.2,35067522783175.4,46371101279583.8,60650056547420.3,78461478507216.5,100397579539093,127066619261635,159067401060772,196957431964691,241215403967957,292199306677880,350102169083700,414908086633629,486351740991010,563884981661084,646654134191842,733491468171162,822923666242846,913199185578605,1.00233514025843e+15,1.08818284395674e+15,1.16850956180656e+15,1.2410924795197e+15,1.30381956877437e+15,1.35479106435906e+15,1.39241479650646e+15,1.41548872165604e+15,1.42326468853923e+15,1.41548872165604e+15,1.39241479650646e+15,1.35479106435905e+15,1.30381956877436e+15,1.24109247951969e+15,1.16850956180655e+15,1.08818284395672e+15,1.00233514025841e+15,913199185578585,822923666242828,733491468171146,646654134191828,563884981661068,486351740991000,414908086633617,350102169083690,292199306677870,241215403967947,196957431964684,159067401060765,127066619261630,100397579539089,78461478507213.1,60650056547417.5,46371101279581.5,35067522783173.7,26230359509124.8,19406395398722,14201263510774.2,10278993084399.2,7358946392887.37,5211013307290.07,3649809545909.82,2528481036466.92,1732569546077.26,1174256923697.8,787185453814.372,521954286530.381,342317699125.808,222058661541.634,142477917497.293,90420910776.098,56758599814.9632,35240003822.8287,21641217907.4626],[11049932374594.9,15012223229189.9,20184548436045.2,26858496194765.3,35369830501302.7,46097024696875.2,59456787771774,75895953254152.7,95879205961301.5,119872308222517,148320758624416,181624168443734,220107058755176,263987238323048,313343381362278,368083838632271,427919033358365,492339963379964,560605307254533,631739382462502,704542715411525,777616266876737,849399450674156,918221051444748,982361074786989,1.04012054911282e+15,1.08989544693685e+15,1.13025029943336e+15,1.15998681793559e+15,1.17820295557868e+15,1.18433835030194e+15,1.17820295557868e+15,1.15998681793559e+15,1.13025029943336e+15,1.08989544693684e+15,1.04012054911282e+15,982361074786982,918221051444735,849399450674144,777616266876720,704542715411515,631739382462489,560605307254521,492339963379953,427919033358353,368083838632263,313343381362269,263987238323040,220107058755168,181624168443728,148320758624410,119872308222511,95879205961298.1,75895953254149.7,59456787771771.2,46097024696873,35369830501300.9,26858496194763.9,20184548436044.2,15012223229189,11049932374594.2,8049387915123.14,5803028791427.87,4140332541117.54,2923508449419.96,2042970584243.07,1412890497725.7,967037968330.215,655039030518.643,439116201748.734,291326757423.203,191280156967.803,124293407604.312,79930936373.0008,50871007315.0002,32041615512.2492],[11579905705188.6,15490057258528.8,20517197556656.1,26909155866521.4,34946132985305.4,44938150377081.6,57220055942983.6,72143694664744.6,90066958810372,111339594269011,136285856231473,165184372017037,198245867538618,235589725767456,277220643355064,323006903504451,372661955682776,425731054043421,481584630512028,539419849307778,598271404549307,657032094699145,714483066751456,769332914610316,820264097719945,865984482628147,905281267456523,937074186380191,960464753762215,974778421553164,979596891358290,974778421553157,960464753762209,937074186380184,905281267456516,865984482628141,820264097719934,769332914610305,714483066751446,657032094699131,598271404549298,539419849307770,481584630512018,425731054043412,372661955682765,323006903504444,277220643355056,235589725767449,198245867538611,165184372017031,136285856231468,111339594269007,90066958810368.8,72143694664741.7,57220055942981.1,44938150377079.6,34946132985303.8,26909155866520.2,20517197556655.2,15490057258528.1,11579905705188,8571839679063.5,6282898929831.17,4559981955937.62,3277050935851.72,2331955594844.4,1643139280155.14,1146424599159.77,792015410100.227,541799729655.673,366995680999.511,246150169686.954,163476880816.537,107505222599.019,70003507354.8797,45136414161.9426],[11865779067327.9,15646090049754.7,20438258246088.6,26449071367143.9,33908256818440.1,43065449878898.4,54185240111624.8,67540069818692.4,83400853964543.9,102025323154847,123644257175466,148445969263950,176559609228451,208038061032636,242841398381911,280822008995938,321712583364760,365118167840317,410513390647452,457245775680783,504545764716472,551543686046121,597293458977851,640802340808960,681065544327698,717104121764073,748004166910772,772955167383534,791285270942296,802491327983977,806261836308780,802491327983977,791285270942296,772955167383534,748004166910766,717104121764068,681065544327693,640802340808951,597293458977842,551543686046113,504545764716465,457245775680773,410513390647444,365118167840309,321712583364753,280822008995930,242841398381905,208038061032630,176559609228446,148445969263945,123644257175462,102025323154843,83400853964541,67540069818689.7,54185240111622.4,43065449878896.7,33908256818438.6,26449071367142.6,20438258246087.6,15646090049753.9,11865779067327.3,8914873384543.44,6635330968099.43,4892586247742.38,3573903974907.94,2586281290239.22,1854116956885.5,1316821724422.48,926499797978.518,645791261967.439,445930819909.058,305050192205.829,206730048300.433,138791988640.346,92311047694.4776,60823506095.9972],[11919951459805.6,15509453766396.3,20000607886053.3,25563161632785.1,32382517876604.1,40656626431634.6,50591405175929.9,62394573773977.8,76267863391825,92397669020022.8,110944334057222,132030393496800,155728243481108,182047839796463,210925142990345,242212109406463,275669062370764,310960254948490,347653347686745,385223369112810,423061507039170,460488804991169,496774526699519,531158624379939,562877429049420,591191400594595,615413557904081,634937077583796,649260519838566,658009220023504,660951572651535,658009220023499,649260519838566,634937077583792,615413557904076,591191400594590,562877429049416,531158624379932,496774526699515,460488804991162,423061507039161,385223369112801,347653347686740,310960254948483,275669062370758,242212109406456,210925142990340,182047839796458,155728243481103,132030393496796,110944334057219,92397669020019.5,76267863391822.2,62394573773975.5,50591405175927.9,40656626431633,32382517876602.7,25563161632783.9,20000607886052.4,15509453766395.7,11919951459805.1,9079818110720.42,6854953102799.4,5129281150921.06,3803935976747.96,2795983282468.18,2036857372802.03,1470656835457.3,1052414322197.9,746426124454.657,524700635016.948,365561984258.194,252426612742.428,172756314600.489,117181053783.318,78778107804.4586],[11766222855561.1,15120981717325.4,19267702254777.2,24343716652922.6,30496560576868.9,37881037004159.8,46655180770946.6,56975076013322,68988542486936.2,82827784702911.3,98601186700497.5,116384530102884,136212007243433,158067486653090,181876556324054,207499912106138,234728666355454,263282119292984,292808458850858,322888733915197,353044284575397,382747619113776,411436512708146,438530882012033,463451779806844,485641672286943,504585024731520,519828143158601,530997209700019,537813512196814,540105002185322,537813512196814,530997209700019,519828143158598,504585024731516,485641672286940,463451779806838,438530882012027,411436512708140,382747619113770,353044284575392,322888733915193,292808458850854,263282119292978,234728666355449,207499912106132,181876556324050,158067486653086,136212007243429,116384530102880,98601186700494.7,82827784702908.3,68988542486933.8,56975076013320.2,46655180770944.8,37881037004158.3,30496560576867.6,24343716652921.5,19267702254776.4,15120981717324.8,11766222855560.6,9078229779536.01,6945000669095.36,5268056602064.75,3962192694479.87,2954797840459.26,2184876898310.23,1601891851362.35,1164518604773.29,839395603684.031,599920867905.242,425136377034.74,298723634947.348,208121967551.617,143771657776.546,98477192247.3904],[11435576437639.5,14527563655908.3,18306457089605.2,22881927529346.7,28369893049706.6,34889888400566.3,42561629905653.4,51500768613166.2,61813873525704.6,73592744052209.5,86908213634580.6,101803670983846,118288586748845,136332386291915,155859047834576,176742824047361,198805479451788,221815402392323,245488887318922,269493791495695,293455653360871,316966223508416,339594211857024,360897906042051,380439177501140,397798274364194,412588714472918,424471546136051,433168244290471,438471557850189,440253718622890,438471557850189,433168244290467,424471546136051,412588714472915,397798274364191,380439177501138,360897906042048,339594211857022,316966223508412,293455653360867,269493791495689,245488887318919,221815402392319,198805479451784,176742824047357,155859047834573,136332386291912,118288586748842,101803670983843,86908213634578.2,73592744052207.4,61813873525702.7,51500768613164.5,42561629905651.9,34889888400565.1,28369893049705.6,22881927529345.8,18306457089604.4,14527563655907.7,11435576437639,8928944513576.22,6915426600689.38,5312691735571.21,4048433845340.45,3060104558144.63,2294363756292.45,1706338030280.13,1258764991705.08,921087801251.251,668550463443.927,481331347490.886,343740645535.105,243497450669.781,171093983565.734,119248203880.394],[10962394431251.7,13777471762698.4,17181803589159.7,21261949670875.3,26107935824835.3,31810983930115.1,38460664469893,46141486214332.6,54928974369954.5,64885329741254.2,76054804993264.7,88458977146603.5,102092134638487,116917028992202,132861261667162,149814582620853,167627365764367,186110496098893,205036853454085,224144509512080,243141670925783,261713306146911,279529292772855,296253822533295,311555709732521,325119173251316,336654608612388,345908840339764,352674349268742,356797005728895,358181906331717,356797005728895,352674349268742,345908840339764,336654608612386,325119173251314,311555709732516,296253822533293,279529292772853,261713306146908,243141670925779,224144509512076,205036853454081,186110496098890,167627365764365,149814582620851,132861261667159,116917028992200,102092134638484,88458977146601,76054804993262.5,64885329741252.4,54928974369953,46141486214331.1,38460664469891.8,31810983930114.1,26107935824834.4,21261949670874.5,17181803589159.1,13777471762697.9,10962394431251.2,8655186565419.12,6780825344949.73,5271373609724.87,4066306894017.77,3112516215153.49,2364058436506.04,1781721856404.6,1332467799296.22,988800443840.58,728107824015.896,532007626533.099,385722642571.702,277502898602.523,198104814061.827,140332302127.65],[10381390888241.9,12916859347165.8,15952961649228.3,19557291800913.5,23799022188842.7,28746999144698,34467431569594.7,41021197273595.9,48460818547378.4,56827187575191.9,66146151967466.7,76425098910888.4,87649700909565.5,99781004413631.7,112753052466122,126471231799708,140811522048803,155620799098306,170718306149821,185898355937262,200934267792073,215583477049143,229593685524836,242709854990059,254681785453787,265271971288384,274263394867175,281466902647105,286727814497617,289931444086221,291007255262642,289931444086221,286727814497617,281466902647105,274263394867173,265271971288382,254681785453785,242709854990058,229593685524833,215583477049140,200934267792071,185898355937260,170718306149819,155620799098302,140811522048800,126471231799705,112753052466119,99781004413629.5,87649700909563.7,76425098910886.5,66146151967464.9,56827187575190.3,48460818547377,41021197273594.7,34467431569593.6,28746999144697.1,23799022188841.9,19557291800912.8,15952961649227.7,12916859347165.3,10381390888241.4,8282036893510.76,6558458603987.29,5155246148014.87,4022351643558.68,3115255470872.4,2394916100241.08,1827552844795.24,1384307550235.03,1040826246689.56,776795832567.565,575464506515.695,423168372965.645,308880765378.631,223795593817.201,160951564485.388],[9725356062208.12,11987416623535.4,14671247426299.6,17829117050973.9,21513644302654.4,25776235119561.3,30665237886004.6,36223844807384.9,42487786286892.9,49482885439016.2,57222559766470.2,65705375191321.3,74912772519571.4,84807096465571,95330061112410.4,106401781929076,117920492382257,129763042456016,141786247314760,153829117858326,165715962624179,177260304592520,188269509632116,198549978589086,207912715470256,216179052771294,223186294326790,228793028079078,232883867033365,235373396608678,236209139831863,235373396608678,232883867033363,228793028079076,223186294326788,216179052771292,207912715470255,198549978589085,188269509632115,177260304592517,165715962624177,153829117858324,141786247314758,129763042456014,117920492382254,106401781929074,95330061112408.4,84807096465569.2,74912772519569.6,65705375191319.7,57222559766468.7,49482885439014.8,42487786286891.7,36223844807383.9,30665237886003.7,25776235119560.5,21513644302653.8,17829117050973.3,14671247426299,11987416623534.9,9725356062207.77,7834418635103.53,6266562729414.36,4977065556443.6,3924991168462.57,3073444389830.89,2389645000356.12,1844857259439.27,1414208697526.37,1076429499708.56,813540225250.572,610511465512.454,454914699770.99,336579351620.129,247267092015.032,180370922361.223],[9023677265025.94,11025037420909.9,13379120205420.5,16125975835150.9,19305249515261.9,22954920821789.4,27109851868315.4,31800171011226.6,37049532466368.2,42873306019731.3,49276764141440,56253345273847.6,63783080831342.2,71831278518225.4,80347555048788.8,89265306545332.2,98501694381567.5,107958207969164,117521844295318,127066917675415,136457483366970,145550326945402,154198439498026,162254868747130,169576810192323,176029782168191,181491715970032,185856788113445,189038827034951,190974141173367,191623638817882,190974141173367,189038827034950,185856788113444,181491715970032,176029782168189,169576810192322,162254868747129,154198439498025,145550326945401,136457483366968,127066917675414,117521844295317,107958207969162,98501694381566.1,89265306545330.3,80347555048787.6,71831278518224.1,63783080831340.9,56253345273846.4,49276764141438.8,42873306019730.2,37049532466367.3,31800171011225.7,27109851868314.6,22954920821788.6,19305249515261.3,16125975835150.4,13379120205420,11025037420909.5,9023677265025.62,7335639860578.5,5923022940544.8,4750067631978.22,3783616730518.35,2993404771876.3,2352202577912.33,1835840565827.31,1423135223995.34,1095742077905.24,837956504329.86,636481197850.312,480176218027.644,359804574084.237,267783416998.703,197948239396.729],[8301526084075.69,10059290698910.6,12110144988500.6,14484512692693,17211986491045.9,20320325781163,23834327261753.3,27774592254705.6,32156224181274.3,36987498917239.5,42268559274454.8,47990191924350.5,54132750016959.9,60665286922800.9,67544965396547.4,74716801643888.8,82113795080410.3,89657482059064.4,97258935833294.3,104820216112364,112236250609675,119397109061798,126190608546998,132505168885143,138232819779264,143272248384414,147531768185651,150932088173451,153408765708393,154914237156426,155419336928645,154914237156426,153408765708393,150932088173450,147531768185651,143272248384413,138232819779263,132505168885142,126190608546997,119397109061797,112236250609673,104820216112362,97258935833293.6,89657482059063.1,82113795080409.1,74716801643887.5,67544965396546.1,60665286922799.9,54132750016958.8,47990191924349.5,42268559274453.9,36987498917238.6,32156224181273.6,27774592254704.8,23834327261752.6,20320325781162.4,17211986491045.3,14484512692692.6,12110144988500.2,10059290698910.2,8301526084075.42,6806456555262.69,5544428391626.7,4487092708923.31,3607828364013.94,2882035038248.93,2287310935153.24,1803531442056.34,1412845887432.01,1099609358893.41,850265632171.987,653195801900.436,498545392003.38,378040727340.049,284803312118.975,213168997674.812],[7579569825918.09,9113480180368.42,10889570192618.6,12930758891039.3,15258929942225.6,17894144260910.3,20853770006388.7,24151550359664.9,27796635988856.9,31792615298974.9,36136580998597.1,40818275752747.1,45819362290393.8,51112863901285.7,56662819473081.2,62424192880449.9,68343069578984.3,74357163778052.3,80396647843840.3,86385302068212.6,92241968244138.7,97882275361774.5,103220591021720,108172138735842,112655210016507,116593391827790,119917725233391,122568710379144,124498076512635,125670243528284,126063413226426,125670243528284,124498076512635,122568710379144,119917725233390,116593391827790,112655210016506,108172138735841,103220591021719,97882275361773.1,92241968244138,86385302068212,80396647843839.2,74357163778051.3,68343069578983.3,62424192880449.1,56662819473080.2,51112863901284.6,45819362290392.8,40818275752746.3,36136580998596.2,31792615298974.1,27796635988856.2,24151550359664.3,20853770006388.2,17894144260909.8,15258929942225.1,12930758891038.9,10889570192618.2,9113480180368.13,7579569825917.85,6264575576290.64,5145475773184.13,4199970233907.64,3406855214670.33,2746299715709.45,2200031893030.91,1751446240162.92,1385643267888.13,1089413745977.46,851179304138.749,660900453966.839,509962022506.969,391044704910.918,297990057641.384,225664855752.265],[6874062557496.34,8205094804728.69,9735269080656.69,11481709362530.3,13460443578453.5,15685791129621.2,18169698318255.3,20921038490086.1,23944898118733.2,27241874113837.4,30807411032751.4,34631209320378.4,38696736912801.5,42980876275191.8,47453737020949.2,52078660575966.1,56812437906496.6,61605754228811.1,66403866086529.3,71147506552545.3,75774004022845.8,80218589635717.6,84415858340556.5,88301339642329.9,91813126626861.7,94893506534623.3,97490533304998.9,99559482436967.8,101064131328145,101977813914388,102284206715537,101977813914387,101064131328145,99559482436967.1,97490533304998.2,94893506534622.6,91813126626861,88301339642329.3,84415858340555.9,80218589635717,75774004022845,71147506552544.5,66403866086528.5,61605754228810.2,56812437906495.8,52078660575965.4,47453737020948.3,42980876275191,38696736912800.7,34631209320377.7,30807411032750.7,27241874113836.7,23944898118732.6,20921038490085.6,18169698318254.8,15685791129620.8,13460443578453.1,11481709362529.9,9735269080656.41,8205094804728.42,6874062557496.12,5724500398427.56,4738664187386.86,3899137126270.85,3189152727910.03,2592843834602.39,2095422657777.8,1683298529704.14,1344141176982.54,1066897900094.13,841773148378.526,660178701331.093,514662094412.825,398820147835.712,307203550235.914,235217485874.2]],"type":"surface","x":[1.6,1.602,1.604,1.606,1.608,1.61,1.612,1.614,1.616,1.618,1.62,1.622,1.624,1.626,1.628,1.63,1.632,1.634,1.636,1.638,1.64,1.642,1.644,1.646,1.648,1.65,1.652,1.654,1.656,1.658,1.66,1.662,1.664,1.666,1.668,1.67,1.672,1.674,1.676,1.678,1.68,1.682,1.684,1.686,1.688,1.69,1.692,1.694,1.696,1.698,1.7,1.702,1.704,1.706,1.708,1.71,1.712,1.714,1.716,1.718,1.72,1.722,1.724,1.726,1.728,1.73,1.732,1.734,1.736,1.738,1.74,1.742,1.744,1.746,1.748,1.75],"y":[0.03,0.032,0.034,0.036,0.038,0.04,0.042,0.044,0.046,0.048,0.05,0.052,0.054,0.056,0.058,0.06,0.062,0.064,0.066,0.068,0.07,0.072,0.074,0.076,0.078,0.08,0.082,0.084,0.086,0.088,0.09,0.092,0.094,0.096,0.098,0.1],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
Bi-variate likelihood function
</p>
</div>
</div>
<div id="the-posterior-distribution-of-mu-sigma2" class="section level2">
<h2 class="hasAnchor">
<a href="#the-posterior-distribution-of-mu-sigma2" class="anchor"></a>The posterior distribution of <span class="math inline">\((\mu,\, \sigma^2)\)</span>
</h2>
<p>The posterior distribution of <span class="math inline">\((\mu,\, \sigma^2)\)</span> is a bivariant probability distribution whose joint posterior density function can be expressed in terms of the <em>conditional</em> posterior distribution of <span class="math inline">\(\mu\)</span> given <span class="math inline">\(\sigma^2\)</span> and the <em>marginal</em> posterior distribution of <span class="math inline">\(\sigma^2\)</span> as follows</p>
<p><span class="math display">\[
 \pi(\mu, \sigma^2 \mid \mathcal{D}) = 
 \pi(\mu \mid \sigma^2, \mathcal{D}) \, 
 \pi(\sigma^2 \mid \mathcal{D}),
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\pi(\mu \mid \sigma^2, \mathcal D) =\mathcal{N}(\mu_n, \sigma^2_n = \sigma^2/15)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\sigma^2 \mid \mathcal D)\)</span> is such that <span class="math inline">\(\pi((n-1)s^2/\sigma^2 \mid \mathcal D) = \chi^2(n-1)\)</span></p></li>
<li><p>The posterior marginal of <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\pi(\mu \mid \mathcal D)= \text{St}(\bar{y}, s^2/n, n-1)\)</span></p></li>
</ul>
<p>In our case, the more relevant posterior distributions are the marginal ones:</p>
<ul>
<li><p>The posterior marginal <span class="math inline">\(\pi(\sigma^2 \mid \mathcal D)\)</span> is such that <span class="math inline">\(\pi(0.045598/\sigma^2 \mid \mathcal D) = \chi^2(14)\)</span></p></li>
<li><p>The posterior marginal of <span class="math inline">\(\pi(\mu \mid \mathcal D)= \text{St}(1.66, 0.003257/15=0.000217, 14)\)</span></p></li>
</ul>
<p>We start working with the posterior <span class="math inline">\(\pi(\mu \mid \mathcal D)\)</span>. The posterior mean and scale of <span class="math inline">\(\mu\)</span> are <span class="math inline">\(\bar{y} = 1.66\)</span> and <span class="math inline">\(\sqrt{s^2/n} = 0.014735\)</span> m. A 99<span class="math inline">\(\%\)</span> credible interval for <span class="math inline">\(\mu\)</span> is <span class="math inline">\((1.62, 1.70)\)</span> and the posterior probabilities that the mean of the height of the women VIBASS is less than <span class="math inline">\(1.50, 1.60. 1.70, 1.80, \text{and } 1.90\)</span> are <span class="math inline">\(0.0000, 0.0006, 0.9916, 1.0000, \text{and } 1.0000\)</span>, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ny</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="va">ybar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">hwomen</span><span class="op">$</span><span class="va">height</span> <span class="op">-</span> <span class="va">ybar</span><span class="op">)</span> <span class="op">**</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">ny</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">post_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  mean <span class="op">=</span> <span class="va">ybar</span>,
  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s2</span> <span class="op">/</span> <span class="va">ny</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">post_mu</span><span class="op">$</span><span class="va">scale</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.995</span><span class="op">)</span>, <span class="va">ny</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">mean</span>
<span class="co">#&gt; [1] 1.616134 1.703866</span>
<span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.50</span>, <span class="fl">1.60</span>, <span class="fl">1.70</span>, <span class="fl">1.80</span>, <span class="fl">1.90</span><span class="op">)</span> <span class="op">-</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">scale</span>, <span class="va">ny</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.669533e-08 5.718022e-04 9.916131e-01 9.999999e-01 1.000000e+00</span></code></pre></div>
<p>The graphics of that posterior density is</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">dt</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">scale</span>, <span class="va">ny</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">post_mu</span><span class="op">$</span><span class="va">scale</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"density"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.40</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="p4_files/figure-html/posterior-bivariate-1.png" alt="Posterior (green) distribution for the mean height." width="60%"><p class="caption">
Posterior (green) distribution for the mean height.
</p>
</div>
<p>We focus now on the variance of the sampling model. Its posterior distribution is such that <span class="math inline">\(\pi(0.045598/\sigma^2 \mid \mathcal D) = \chi^2(14)\)</span>. This is not the posterior distribution of <span class="math inline">\(\sigma^2\)</span> but a function, <span class="math inline">\(0.045598/\sigma^2\)</span> of it. Consequently, we can approximate the posterior distribution for <span class="math inline">\(\sigma^2\)</span> by simulation as follows:</p>
<ul>
<li>If <span class="math display">\[\{a^{(1)}, a^{(2)}, \ldots, a^{(M)}\}\]</span> is a random sample from <span class="math inline">\(\pi(0.045598/\sigma^2 \mid \mathcal D) = \chi^2(14)\)</span> then <span class="math display">\[\{0.045598/a^{(1)}, 0.045598/a^{(2)}, \ldots, 0.045598/a^{(M)}\}\]</span> is a random sample from <span class="math inline">\(\pi(\sigma^2 \mid \mathcal D)\)</span>.</li>
</ul>
<p>Next we show the approximate graph and some posterior characteristics of the posterior <span class="math inline">\(\pi(\sigma^2 \mid \mathcal D)\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">simuchi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">ny</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">simu.sigma</span> <span class="op">&lt;-</span> <span class="fl">0.045598</span> <span class="op">/</span> <span class="va">simuchi</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span>
  <span class="va">simu.sigma</span>,
  breaks <span class="op">=</span> <span class="fl">300</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"gray99"</span>,
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.02</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400</span><span class="op">)</span>,
  ylab <span class="op">=</span> <span class="st">"density"</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">sigma2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="p4_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">simu.sigma</span><span class="op">)</span>
<span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="co">#&gt; 0.0009406 0.0026586 0.0034166 0.0037955 0.0044708 0.0308207</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">simu.sigma</span><span class="op">)</span>
<span class="co">#&gt; [1] 2.89995e-06</span>
<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">simu.sigma</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.001702924</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">simu.sigma</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">0.995</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        0.5%       99.5% </span>
<span class="co">#&gt; 0.001450118 0.011310551</span></code></pre></div>
<p>We observe that <span class="math inline">\(\text{E}(\sigma^2 \mid \mathcal D)=0.0038\)</span> and a <span class="math inline">\(99\)</span>% credible interval for <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\((0.00147, 0.01118)\)</span>.</p>
</div>
</div>
<div id="time-to-individual-work" class="section level1">
<h1 class="hasAnchor">
<a href="#time-to-individual-work" class="anchor"></a>Time to individual work</h1>
<p>We propose below an individual exercise that pursues to consolidate the basic concepts that we have learned in the previous theoretical session and that we have been practising in this session.</p>
<p><strong>Exercice</strong></p>
<p>We focus now on the height of the VIBASS men participants.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hmen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.92</span>, <span class="fl">1.82</span>, <span class="fl">1.69</span>, <span class="fl">1.75</span>, <span class="fl">1.72</span>, <span class="fl">1.71</span>, <span class="fl">1.73</span>, <span class="fl">1.69</span>, <span class="fl">1.70</span>, <span class="fl">1.78</span>, <span class="fl">1.88</span>, <span class="fl">1.82</span>, <span class="fl">1.86</span>, <span class="fl">1.65</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Construct a Bayesian inferential process for the mean of the height of the VIBASS men participants. Assume a non-informative prior scenario and a sampling model approximately Normal with</p></li>
<li><p>Known variance <span class="math inline">\(\sigma^2=0.1\)</span>.</p></li>
<li><p>Unknown variance.</p></li>
<li><p>Compare the mean of the height between men and women. It is possible to compute the posterior probability associated to ? and to <span class="math inline">\(\mu_\text{m}-\mu_\text{w}\)</span>? <span class="math inline">\(\mu_\text{m}/\mu_\text{w}\)</span>?</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VIBASS4, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
