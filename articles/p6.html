<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 6: Software and GLMs • vibass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 6: Software and GLMs">
<meta property="og:description" content="vibass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vibass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.36</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1.html">Practical 1: Binary data</a>
    </li>
    <li>
      <a href="../articles/p2count.html">Practical 2: Count data</a>
    </li>
    <li>
      <a href="../articles/p2normal.html">Practical 2: Normal data</a>
    </li>
    <li>
      <a href="../articles/p3.html">Practical 3: Bayesian linear regression</a>
    </li>
    <li>
      <a href="../articles/p4.html">Practical 4: Simualtion-based Bayesian inference</a>
    </li>
    <li>
      <a href="../articles/p5.html">Practical 5: Numerical approaches</a>
    </li>
    <li>
      <a href="../articles/p6.html">Practical 6: Software and GLMs</a>
    </li>
    <li>
      <a href="../articles/p7.html">Practical 7: Bayesian Hierarchical Modelling</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/VABAR/vibass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 6: Software and GLMs</h1>
                        <h4 data-toc-skip class="author">VIBASS</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/VABAR/vibass/blob/HEAD/vignettes/p6.Rmd" class="external-link"><code>vignettes/p6.Rmd</code></a></small>
      <div class="hidden name"><code>p6.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="software-for-bayesian-statistical-analysis">Software for Bayesian Statistical Analysis<a class="anchor" aria-label="anchor" href="#software-for-bayesian-statistical-analysis"></a>
</h2>
<p>So far, simple Bayesian models with conjugate priors have been
considered. As explained in previous practicals, when the posterior
distribution is not available in closed form, MCMC algorithms such as
the Metropolis-Hastings or Gibbs Sampling can be used to obtain samples
from it.</p>
<p>In general, posterior distributions are seldom available in closed
form and implementing MCMC algorithms for complex models can be
technically difficult and very time-consuming.</p>
<p>For this reason, in this Practical we start by looking at a number of
<code>R</code> packages to fit Bayesian statistical models. These
packages will equip us with tools which can be used to deal with more
complex models efficiently, without us having to do a lot of extra
coding ourselves. Fitting Bayesian models in <code>R</code> will then be
much like fitting non-Bayesian models, using model-fitting functions at
the command line, and using standard syntax for model specification.</p>
<div class="section level3">
<h3 id="bayesx-and-inla">BayesX and INLA<a class="anchor" aria-label="anchor" href="#bayesx-and-inla"></a>
</h3>
<p>In particular, the following two software packages will be
considered:</p>
<ul>
<li><p><code>BayesX</code></p></li>
<li><p><code>INLA</code></p></li>
</ul>
<p><code>BayesX</code> (<a href="http://www.bayesx.org/" class="external-link uri">http://www.bayesx.org/</a>) implements MCMC methods to
obtain samples from the joint posterior and is conveniently accessed
from R via the package <code>R2BayesX</code>.</p>
<p><code>INLA</code> (<a href="https://www.r-inla.org/" class="external-link uri">https://www.r-inla.org/</a>) is based on producing
(accurate) approximations to the marginal posterior distributions of the
model parameters. Although this can be enough most of the time, making
multivariate inference with <code>INLA</code> can be difficult or
impossible. However, in many cases this is not needed and
<code>INLA</code> can fit some classes of models in a fraction of the
time it takes with MCMC.</p>
<p>Both <code>R2BayesX</code> and <code>INLA</code> have a very simple
interface to define models using a <code>formula</code> (in the same way
as with <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam()</a></code> functions).</p>
<p>While <code>R2BayesX</code> can be installed from CRAN,
<code>INLA</code> is not on CRAN and needs to be installed from a
specific repository.</p>
</div>
<div class="section level3">
<h3 id="other-bayesian-software">Other Bayesian Software<a class="anchor" aria-label="anchor" href="#other-bayesian-software"></a>
</h3>
<ul>
<li>Package <code>MCMCpack</code> in R contains functions such as
<code>MCMClogit()</code>, <code>MCMCPoisson()</code> and
<code>MCMCprobit()</code> for fitting specific kinds of models.</li>
<li>A classic MCMC program is <code>BUGS</code>, (Bayesian Analysis
using Gibbs Sampling) described in Lunn et al. (2000): <a href="http://www.mrc-bsu.cam.ac.uk/bugs/winbugs/contents.shtml" class="external-link">http://www.mrc-bsu.cam.ac.uk/bugs/winbugs/contents.shtml</a>.
BUGS can be used through graphical interfaces <code>WinBUGS</code> and
<code>OpenBUGS</code>. Both of these packages can be called from within
R using packages <code>R2WinBUGS</code> and
<code>R2OpenBUGS</code>.</li>
<li>
<code>JAGS</code>, which stands for “just another Gibbs sampler”.
Can also be called from R using package <code>r2jags</code>.</li>
<li>The <code>NIMBLE</code> package extends <code>BUGS</code> and
implements MCMC and other methods for Bayesian inference. You can get it
from <a href="https://r-nimble.org" class="external-link uri">https://r-nimble.org</a>, and is best run directly from
R.</li>
<li>The <code>Stan</code> software implements Hamiltonian Monte Carlo
and other methods for fit hierarchical Bayesian models. It is available
from <a href="https://mc-stan.org" class="external-link uri">https://mc-stan.org</a>.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-logistic-regression">Bayesian Logistic Regression<a class="anchor" aria-label="anchor" href="#bayesian-logistic-regression"></a>
</h2>
<div class="section level3">
<h3 id="model-formulation">Model Formulation<a class="anchor" aria-label="anchor" href="#model-formulation"></a>
</h3>
<p>To summarise the model formulation presented in the lecture, given a
response variable <span class="math inline">\(Y_i\)</span> representing
the count of a number of successes from a given number of trials <span class="math inline">\(n\)</span> with success probabliity <span class="math inline">\(\theta_i\)</span>, we have</p>
<ul>
<li>
<span class="math inline">\((Y_i \mid \boldsymbol \theta_i)
\sim\mbox{Bi}(n, \theta_i),\,\, i.i.d.\,\,, i=1, \ldots, n\)</span>
<span class="math display">\[\begin{align*}
\mbox{logit}(\theta_i) &amp; =\eta_i \nonumber\\
\eta_{i} &amp; =\beta_0+\beta_1 x_{i1}+\ldots+\beta_p x_{ip}=\boldsymbol
x_i\boldsymbol \beta\nonumber
\end{align*}\]</span> assuming the logit link function and with linear
predictor <span class="math inline">\(\eta_{i}\)</span>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-fake-news">Example: Fake News<a class="anchor" aria-label="anchor" href="#example-fake-news"></a>
</h3>
<p>The <code>fake_news</code> data set in the <code>bayesrules</code>
package in <code>R</code> contains information about 150 news articles,
some real news and some fake news.</p>
<p>In this example, we will look at trying to predict whether an article
of news is fake or not given three explanatory variables.</p>
<p>We can use the following code to extract the variables we want from
the data set:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayes-rules.github.io/bayesrules/docs/" class="external-link">bayesrules</a></span><span class="op">)</span></span>
<span><span class="va">fakenews</span> <span class="op">&lt;-</span> <span class="va">fake_news</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"type"</span>,<span class="st">"title_has_excl"</span>,<span class="st">"title_words"</span>,<span class="st">"negative"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The response variable <code>type</code> takes values
<code>fake</code> or <code>real</code>, which should be
self-explanatory. The three explanatory variables are:</p>
<ul>
<li><p><code>title_has_excl</code>, whether or not the article contains
an excalamation mark (values <code>TRUE</code> or
<code>FALSE</code>);</p></li>
<li><p><code>title_words</code>, the number of words in the title (a
positive integer); and</p></li>
<li><p><code>negative</code>, a sentiment rating, recorded on a
continuous scale.</p></li>
</ul>
<p>In the exercise to follow, we will examine whether the chance of an
article being fake news is related to the three covariates here.</p>
</div>
<div class="section level3">
<h3 id="fitting-bayesian-logistic-regression-models-in-bayesx">Fitting Bayesian Logistic Regression Models in BayesX<a class="anchor" aria-label="anchor" href="#fitting-bayesian-logistic-regression-models-in-bayesx"></a>
</h3>
<p><code>BayesX</code> makes inference via MCMC, via the
<code>R2BayesX</code> package which as noted maked the syntax for model
fitting very similar to that for fitting non-Bayesian models using
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> in R.</p>
<p>The package must be loaded into R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">R2BayesX</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: BayesXsrc</span></span>
<span><span class="co">#&gt; Loading required package: colorspace</span></span>
<span><span class="co">#&gt; Loading required package: mgcv</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; This is mgcv 1.8-42. For overview type 'help("mgcv-package")'.</span></span></code></pre></div>
<p>The syntax for fitting a Bayesian Logistic Regression Model with one
response variable and three explanatory variables will be like so:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/bayesx.html" class="external-link">bayesx</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">data.set</span>,</span>
<span>                 family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></code></pre></div>
<p>Note that the variable <code>title_has_excl</code> will need to be
either replaced by or converted to a factor, for example</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fakenews</span><span class="op">$</span><span class="va">titlehasexcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">fakenews</span><span class="op">$</span><span class="va">title_has_excl</span><span class="op">)</span></span></code></pre></div>
<p>Functions <code>summary</code> and <code>confint</code> produce a
summary (including parameter estimates etc) and confidence intervals for
the parameters, respectively.</p>
<p>In order to be able to obtain output plots from BayesX, it seems that
we need to create a new version of the response variable of type
logical:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fakenews</span><span class="op">$</span><span class="va">typeFAKE</span> <span class="op">&lt;-</span> <span class="va">fakenews</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"fake"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h3>
<ul>
<li>
<p>Perform an exploratory assessment of the fake news data set, in
particular looking at the possible relationships between the explanatory
variables and the fake/real response variable <code>typeFAKE</code>.</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Is there a link between the fakeness and whether the title has an exclamation mark?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">fakenews</span><span class="op">$</span><span class="va">title_has_excl</span>, <span class="va">fakenews</span><span class="op">$</span><span class="va">typeFAKE</span><span class="op">)</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt;         FALSE TRUE</span></span>
<span><span class="co">#&gt;   FALSE    88   44</span></span>
<span><span class="co">#&gt;   TRUE      2   16</span></span>
<span><span class="co"># For the quantitative variables, look at boxplots on fake vs real</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">fakenews</span><span class="op">$</span><span class="va">title_words</span> <span class="op">~</span> <span class="va">fakenews</span><span class="op">$</span><span class="va">typeFAKE</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">fakenews</span><span class="op">$</span><span class="va">negative</span> <span class="op">~</span> <span class="va">fakenews</span><span class="op">$</span><span class="va">typeFAKE</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</details>
</li>
<li>
<p>Fit a Bayesian model in BayesX using the fake news
<code>typeFAKE</code> variable as response and the others as covariates.
Examine the output; does the model fit well, and is there any evidence
that any of the explanatory variables are associated with changes in
probability of an article being fake or not?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce the BayesX output</span></span>
<span><span class="va">bayesx.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/bayesx.html" class="external-link">bayesx</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">typeFAKE</span> <span class="op">~</span> <span class="va">titlehasexcl</span> <span class="op">+</span> <span class="va">title_words</span> <span class="op">+</span> <span class="va">negative</span>,</span>
<span>data <span class="op">=</span> <span class="va">fakenews</span>,</span>
<span>family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>method <span class="op">=</span> <span class="st">"MCMC"</span>,</span>
<span>iter <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>burnin <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bayesx(formula = typeFAKE ~ titlehasexcl + title_words + negative, </span></span>
<span><span class="co">#&gt;     data = fakenews, family = "binomial", method = "MCMC", iter = 15000, </span></span>
<span><span class="co">#&gt;     burnin = 5000)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects estimation results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                     Mean      Sd    2.5%     50%   97.5%</span></span>
<span><span class="co">#&gt; (Intercept)      -3.0041  0.7741 -4.5222 -2.9957 -1.5304</span></span>
<span><span class="co">#&gt; titlehasexclTRUE  2.6798  0.8283  1.2422  2.6023  4.5465</span></span>
<span><span class="co">#&gt; title_words       0.1152  0.0581  0.0031  0.1136  0.2325</span></span>
<span><span class="co">#&gt; negative          0.3294  0.1541  0.0253  0.3248  0.6354</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; N = 150  burnin = 5000  method = MCMC  family = binomial  </span></span>
<span><span class="co">#&gt; iterations = 15000  step = 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          2.5%      97.5%</span></span>
<span><span class="co">#&gt; (Intercept)      -4.520060000 -1.5423965</span></span>
<span><span class="co">#&gt; titlehasexclTRUE  1.245669000  4.5090407</span></span>
<span><span class="co">#&gt; title_words       0.003732297  0.2308962</span></span>
<span><span class="co">#&gt; negative          0.028069778  0.6347291</span></span></code></pre></div>
</details>
</li>
<li>
<p>Produce plots of the MCMC sample traces and the estimated
posterior distributions for the model parameters. Does it seem like
convergence has been achieved?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># An overall plot of sample traces and density estimates</span></span>
<span>   <span class="co"># plot(samples(bayesx.output))</span></span>
<span><span class="co"># Traces can be obtained separately</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bayesx.output</span>,which <span class="op">=</span> <span class="st">"coef-samples"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># And the density plots one-by-one</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>,<span class="st">"titlehasexclTRUE"</span><span class="op">]</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Title Has Excl"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>,<span class="st">"title_words"</span><span class="op">]</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Title Words"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>,<span class="st">"negative"</span><span class="op">]</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Negative"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</details>
</li>
<li>
<p>Fit a non-Bayesian model using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> for comparison.
How do the model fits compare?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model - note similarity with bayesx syntax</span></span>
<span><span class="va">glm.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">typeFAKE</span> <span class="op">~</span> <span class="va">titlehasexcl</span> <span class="op">+</span> <span class="va">title_words</span> <span class="op">+</span> <span class="va">negative</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fakenews</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># Summarise output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm.output</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = typeFAKE ~ titlehasexcl + title_words + negative, </span></span>
<span><span class="co">#&gt;     family = "binomial", data = fakenews)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -2.6169  -0.8659  -0.6566   1.1050   2.2124  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)      -2.91516    0.76096  -3.831 0.000128 ***</span></span>
<span><span class="co">#&gt; titlehasexclTRUE  2.44156    0.79103   3.087 0.002025 ** </span></span>
<span><span class="co">#&gt; title_words       0.11164    0.05801   1.925 0.054278 .  </span></span>
<span><span class="co">#&gt; negative          0.31527    0.15371   2.051 0.040266 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 201.90  on 149  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 169.36  on 146  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 177.36</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span><span class="co"># Perform ANOVA on each variable in turn</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">glm.output</span>,test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Single term deletions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; typeFAKE ~ titlehasexcl + title_words + negative</span></span>
<span><span class="co">#&gt;              Df Deviance    AIC     LRT  Pr(&gt;Chi)    </span></span>
<span><span class="co">#&gt; &lt;none&gt;            169.36 177.36                      </span></span>
<span><span class="co">#&gt; titlehasexcl  1   183.51 189.51 14.1519 0.0001686 ***</span></span>
<span><span class="co">#&gt; title_words   1   173.17 179.17  3.8099 0.0509518 .  </span></span>
<span><span class="co">#&gt; negative      1   173.79 179.79  4.4298 0.0353162 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</details>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-poisson-regression">Bayesian Poisson Regression<a class="anchor" aria-label="anchor" href="#bayesian-poisson-regression"></a>
</h2>
<div class="section level3">
<h3 id="model-formulation-1">Model Formulation<a class="anchor" aria-label="anchor" href="#model-formulation-1"></a>
</h3>
<p>To summarise the model formulation presented in the lecture, given a
response variable <span class="math inline">\(Y_i\)</span> representing
the counts occurring from a process with mean parameter <span class="math inline">\(\lambda_i\)</span>:</p>
<ul>
<li>
<span class="math inline">\((Y_i \mid \boldsymbol \lambda_i)
\sim\mbox{Po}(\lambda_i),\,\, i.i.d.\,\,, i=1, \ldots, n\)</span> <span class="math display">\[\begin{align*}
\mbox{log}(\lambda_i) &amp; =\eta_i \nonumber\\
\eta_{i} &amp; =\beta_0+\beta_1 x_{i1}+\ldots+\beta_p x_{ip}=\boldsymbol
x_i\boldsymbol \beta\nonumber
\end{align*}\]</span> assuming the log link function and with linear
predictor <span class="math inline">\(\eta_{i}\)</span>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-emergency-room-complaints">Example: Emergency Room Complaints<a class="anchor" aria-label="anchor" href="#example-emergency-room-complaints"></a>
</h3>
<p>For this example we will use the <code>esdcomp</code> dataset, which
is available in the <code>faraway</code> package. This dataset records
complaints about emergency room doctors. In particular, data was
recorded on 44 doctors working in an emergency service at a hospital to
study the factors affecting the number of complaints received.</p>
<p>The response variable that we will use is <code>complaints</code>, an
integer count of the number of complaints received. It is expected that
the number of complaints will scale by the number of visits (contained
in the <code>visits</code> column), so we are modelling the rate of
complaints per visit - thus we will need to include a new variable
<code>log.visits</code> as an offset.</p>
<p>The three explanatory variables we will use in the analysis are:</p>
<ul>
<li><p><code>residency</code>, whether or not the doctor is still in
residency training (values <code>N</code> or <code>Y</code>);</p></li>
<li><p><code>gender</code>, the gender of the doctor (values
<code>F</code> or <code>M</code>); and</p></li>
<li><p><code>revenue</code>, dollars per hour earned by the doctor,
recorded as an integer.</p></li>
</ul>
<p>Our simple aim here is to assess whether the seniority, gender or
income of the doctor is linked with the rate of complaints against that
doctor.</p>
<p>We can use the following code to extract the data we want without
having to load the whole package:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esdcomp</span> <span class="op">&lt;-</span> <span class="fu">faraway</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/faraway/man/esdcomp.html" class="external-link">esdcomp</a></span>    </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-bayesian-poisson-regression-models-in-bayesx">Fitting Bayesian Poisson Regression Models in BayesX<a class="anchor" aria-label="anchor" href="#fitting-bayesian-poisson-regression-models-in-bayesx"></a>
</h3>
<p>Again we use <code>BayesX</code> to fit this form of Bayesian
generalised linear model.</p>
<p>If not loaded already, the package must be loaded into R:</p>
<p>The syntax for fitting a Bayesian Poisson Regression Model with one
response variable, three explanatory variables and an offset will be
like so:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/bayesx.html" class="external-link">bayesx</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">data.set</span>,</span>
<span>                 family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></code></pre></div>
<p>However, as noted above we need to include an offset in this
analysis; since for a Poisson GLM we will be using a log() link function
by default, we must compute the log of the number of visits and include
that in the data set <code>esdcomp</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esdcomp</span><span class="op">$</span><span class="va">log.visits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">visits</span><span class="op">)</span>    </span></code></pre></div>
<p>The offset term in the model is then written</p>
<p><code>offset(log.visits)</code></p>
<p>in the call to <code>bayesx</code>.</p>
</div>
<div class="section level3">
<h3 id="exercises-1">Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"></a>
</h3>
<ul>
<li>
<p>Perform an exploratory assessment of the emergency room
complaints data set, particularly how the response variable
<code>complaints</code> varies with the proposed explanatory variables
relative to the number of visits. To do this, create another variable
which is the ratio of <code>complaints</code> to
<code>visits</code>.</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the ratio</span></span>
<span><span class="va">esdcomp</span><span class="op">$</span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="va">esdcomp</span><span class="op">$</span><span class="va">complaints</span> <span class="op">/</span> <span class="va">esdcomp</span><span class="op">$</span><span class="va">visits</span></span>
<span><span class="co"># Plot the link with revenue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">revenue</span>,<span class="va">esdcomp</span><span class="op">$</span><span class="va">ratio</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use boxplots against residency and gender</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">ratio</span> <span class="op">~</span> <span class="va">esdcomp</span><span class="op">$</span><span class="va">residency</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">ratio</span> <span class="op">~</span> <span class="va">esdcomp</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-15-3.png" width="700"></p>
</details>
</li>
<li>
<p>Fit a Bayesian model in BayesX using the <code>complaints</code>
variable as Poisson response and the others as covariates. Examine the
output; does the model fit well, and is there any evidence that any of
the explanatory variables are associated with the rate of
complaints?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model - note similarity with bayesx syntax</span></span>
<span><span class="va">esdcomp</span><span class="op">$</span><span class="va">log.visits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">visits</span><span class="op">)</span></span>
<span><span class="va">bayesx.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/bayesx.html" class="external-link">bayesx</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">complaints</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">log.visits</span><span class="op">)</span> <span class="op">+</span> <span class="va">residency</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">revenue</span>,</span>
<span>  data <span class="op">=</span> <span class="va">esdcomp</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="co"># Summarise output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bayesx(formula = complaints ~ offset(log.visits) + residency + </span></span>
<span><span class="co">#&gt;     gender + revenue, data = esdcomp, family = "poisson")</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Fixed effects estimation results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                Mean      Sd    2.5%     50%   97.5%</span></span>
<span><span class="co">#&gt; (Intercept) -0.3636  0.6875 -1.6632 -0.3545  0.9731</span></span>
<span><span class="co">#&gt; residencyY  -0.5461  0.1898 -0.9140 -0.5497 -0.1680</span></span>
<span><span class="co">#&gt; genderM      0.1617  0.2212 -0.2708  0.1631  0.6006</span></span>
<span><span class="co">#&gt; revenue      0.0063  0.0028  0.0011  0.0063  0.0114</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; N = 44  burnin = 2000  method = MCMC  family = poisson  </span></span>
<span><span class="co">#&gt; iterations = 12000  step = 10</span></span></code></pre></div>
</details>
</li>
<li>
<p>Produce plots of the MCMC sample traces and the estimated
posterior distributions for the model parameters. Does it seem like
convergence has been achieved?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># An overall plot of sample traces and density estimates</span></span>
<span>  <span class="co">#  plot(samples(bayesx.output))</span></span>
<span><span class="co"># Traces can be obtained separately</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bayesx.output</span>,which <span class="op">=</span> <span class="st">"coef-samples"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># And the density plots one-by-one</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>, <span class="st">"residencyY"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Residency"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>, <span class="st">"genderM"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Gender"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/R2BayesX/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">bayesx.output</span><span class="op">)</span><span class="op">[</span>, <span class="st">"revenue"</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Revenue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</details>
</li>
<li>
<p>Fit a non-Bayesian model using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> for comparison.
How do the model fits compare?</p>
<details><summary><p>Solution</p>
</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model - note similarity with bayesx syntax</span></span>
<span><span class="va">esdcomp</span><span class="op">$</span><span class="va">log.visits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">esdcomp</span><span class="op">$</span><span class="va">visits</span><span class="op">)</span></span>
<span><span class="va">glm.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">complaints</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">log.visits</span><span class="op">)</span> <span class="op">+</span> <span class="va">residency</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">revenue</span>,</span>
<span>  data <span class="op">=</span> <span class="va">esdcomp</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="co"># Summarise output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glm.output</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = complaints ~ offset(log.visits) + residency + gender + </span></span>
<span><span class="co">#&gt;     revenue, family = "poisson", data = esdcomp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -2.3356  -0.9403  -0.4460   0.8726   2.0306  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) -7.157087   0.688148 -10.401   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; residencyY  -0.350610   0.191077  -1.835   0.0665 .  </span></span>
<span><span class="co">#&gt; genderM      0.128995   0.214323   0.602   0.5473    </span></span>
<span><span class="co">#&gt; revenue      0.002362   0.002798   0.844   0.3986    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 63.435  on 43  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 58.698  on 40  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 189.48</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span>
<span><span class="co"># Perform ANOVA on each variable in turn</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/add1.html" class="external-link">drop1</a></span><span class="op">(</span><span class="va">glm.output</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Single term deletions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; complaints ~ offset(log.visits) + residency + gender + revenue</span></span>
<span><span class="co">#&gt;           Df Deviance    AIC    LRT Pr(&gt;Chi)  </span></span>
<span><span class="co">#&gt; &lt;none&gt;         58.698 189.48                  </span></span>
<span><span class="co">#&gt; residency  1   62.128 190.91 3.4303  0.06401 .</span></span>
<span><span class="co">#&gt; gender     1   59.067 187.85 0.3689  0.54361  </span></span>
<span><span class="co">#&gt; revenue    1   59.407 188.19 0.7093  0.39969  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</details>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by VIBASS5, Facundo Muñoz.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
